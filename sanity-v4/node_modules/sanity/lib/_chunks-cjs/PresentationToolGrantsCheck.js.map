{"version":3,"file":"PresentationToolGrantsCheck.js","sources":["../../src/presentation/features/PostMessageFeatures.tsx","../../src/presentation/machines/presentation-machine.ts","../../src/presentation/overlays/SharedStateProvider.tsx","../../src/presentation/panels/Panel.tsx","../../src/presentation/util/debounce.ts","../../src/presentation/panels/usePanelsStorage.ts","../../src/presentation/panels/util.ts","../../src/presentation/panels/Panels.tsx","../../src/presentation/components/ErrorCard.tsx","../../src/presentation/paneRouter/ChildLink.tsx","../../src/presentation/paneRouter/ReferenceChildLink.tsx","../../src/presentation/paneRouter/PresentationPaneRouterProvider.tsx","../../src/presentation/editor/DocumentListPane.tsx","../../src/presentation/editor/DocumentPane.tsx","../../src/presentation/editor/DocumentPanel.tsx","../../src/presentation/editor/usePreviewState.ts","../../src/presentation/editor/ContentEditor.tsx","../../src/presentation/panels/usePanelId.ts","../../src/presentation/panels/PanelResizer.tsx","../../src/presentation/PresentationContent.tsx","../../src/presentation/PresentationNavigateProvider.tsx","../../src/presentation/useLocalState.ts","../../src/presentation/PresentationNavigator.tsx","../../src/presentation/PresentationParamsProvider.tsx","../../src/presentation/PresentationProvider.tsx","../../src/presentation/useAllowPatterns.ts","../../src/presentation/util/encodeStudioPerspective.ts","../../src/presentation/useId.ts","../../src/presentation/preview/IFrame.tsx","../../src/presentation/preview/OpenPreviewButton.tsx","../../src/presentation/useTargetOrigin.ts","../../src/presentation/preview/PreviewLocationInput.tsx","../../src/presentation/preview/SharePreviewMenu.tsx","../../src/presentation/preview/PreviewHeader.tsx","../../src/presentation/preview/Preview.tsx","../../src/presentation/util/warnOnce.ts","../../src/presentation/useDocumentsOnPage.ts","../../src/presentation/useMainDocument.ts","../../src/presentation/util/parse.ts","../../src/presentation/useParams.ts","../../src/presentation/usePopups.ts","../../src/presentation/usePresentationPerspective.ts","../../src/presentation/useStatus.ts","../../src/presentation/PresentationTool.tsx","../../src/presentation/actors/create-preview-secret.ts","../../src/presentation/actors/read-shared-secret.ts","../../src/presentation/actors/resolve-allow-patterns.ts","../../src/presentation/actors/resolve-initial-url.ts","../../src/presentation/actors/resolve-preview-mode.ts","../../src/presentation/actors/resolve-preview-mode-url.ts","../../src/presentation/actors/resolve-url-from-preview-search-param.ts","../../src/presentation/machines/preview-url.ts","../../src/presentation/usePreviewUrlActorRef.ts","../../src/presentation/useReportInvalidPreviewSearchParam.tsx","../../src/presentation/useVercelBypassSecret.ts","../../src/presentation/PresentationToolGrantsCheck.tsx"],"sourcesContent":["import {type FC, memo, useEffect} from 'react'\n\nimport {type VisualEditingConnection} from '../types'\n\nexport interface PostMessagePreviewsProps {\n  comlink: VisualEditingConnection\n}\n\nconst PostMessageFeatures: FC<PostMessagePreviewsProps> = (props) => {\n  const {comlink} = props\n\n  useEffect(() => {\n    return comlink.on('visual-editing/features', () => ({\n      features: {\n        optimistic: true,\n      },\n    }))\n  }, [comlink])\n\n  return null\n}\n\nexport default memo(PostMessageFeatures)\n","import {type ActorRefFrom, assign, setup} from 'xstate'\n\ninterface Context {\n  url: URL | null\n  error: Error | null\n  visualEditingOverlaysEnabled: boolean\n}\n\ntype Event =\n  | {type: 'toggle visual editing overlays'; enabled: boolean}\n  | {type: 'iframe loaded'}\n  | {type: 'iframe refresh'}\n  | {type: 'iframe reload'}\n\nexport const presentationMachine = setup({\n  types: {} as {\n    context: Context\n    events: Event\n    tags: 'busy' | 'error'\n  },\n  actions: {\n    //\n  },\n  actors: {\n    //\n  },\n  guards: {\n    //\n  },\n}).createMachine({\n  // eslint-disable-next-line tsdoc/syntax\n  /** @xstate-layout N4IgpgJg5mDOIC5QAUBOcwDsAuBDbAlgPaYAEAKkUQDYDEBAZqrgLZinrVG4QDaADAF1EoAA5FYBQiREgAHogAsAJgA0IAJ6IAHAEYAdIoCcJowFY9R-vzPLlAX3vq0GHPmJlKNfVx4FMUPRMrOy+EJACwkgg4pLSmLIKCLoAbIr6Zoop2tqKAMxpJnnF6loIZkbK+uZ5umapKXmK-Cm6js7osFh48RRU1D7c4RC02ERQUNTsAG4EsACuuNSkkFL+UKRE02Co1LgasJGysWsy0UnaZinVyrpGAOx1Rim2efeliPe3hma1Zvy6XT8W4OJwgFxdNy9LwDMKQILMNgcMBMOAACyO0RO8USiAK930LWU-3uiiB9yaKXemkQjW01V+txS-GKqUe7XBnW67hIfW8cJGjER7E4Q0xYgkpwS5zxVMJKWJ-FJ5Mp1LKFn4Pz+DSaLTaYIh3Oh-UGPEg+nQqNgaPWCJCpAF4pikpxMoQKWZ+gp+TSZLy1hSH3deXpNSZLNqVP1HVcPQ8fNhQ3Nor8ATtSMdQmOLo8uPdnu9BUUfoDQY1WrqOuarUcYMwRHC8Gihqh8Zh2biubdAFpAzSEL2OS247yYfodqgiKgO1K8yog7ptATFL9dFljMDrHkh1zW6OTWF1jPXaAkmY1YgKnktfxtC9dPd+Io9DvYzzPAekxBj13T3i7vKirKkqqpBsYVQ1HUFjFs0t6KK+kIjh+-JfvoBAQFMP5nH+CDaMo16KjYyjMvUNh5GWOT6MoLL8A8ygrk0dQIUabafmaEAWiinQ2gEWHSjhjJUYuj73Pcd63noQaNEYFb-Dk2S0cxe7IYm7GcYevFYjm2HyJeeQQb8tFkikVjGNoFGajUt73o+z61vYQA */\n  id: 'Presentation Tool',\n  context: {\n    url: null,\n    error: null,\n    visualEditingOverlaysEnabled: false,\n  },\n\n  on: {\n    'iframe reload': {\n      actions: assign({url: null}),\n      target: '.loading',\n    },\n  },\n\n  states: {\n    error: {\n      description:\n        'Failed to load, either because of a misconfiguration, a network error, or an unexpected error',\n      tags: ['error'],\n    },\n    loading: {\n      on: {\n        'iframe loaded': {\n          target: 'loaded',\n        },\n      },\n      tags: ['busy'],\n    },\n    loaded: {\n      on: {\n        'toggle visual editing overlays': {\n          actions: assign({\n            visualEditingOverlaysEnabled: ({event}) => event.enabled,\n          }),\n        },\n        'iframe refresh': {\n          target: '.refreshing',\n        },\n        'iframe reload': {\n          target: '.reloading',\n        },\n      },\n\n      states: {\n        idle: {},\n        refreshing: {\n          on: {\n            'iframe loaded': {\n              target: 'idle',\n            },\n          },\n          tags: ['busy'],\n        },\n        reloading: {\n          on: {\n            'iframe loaded': {\n              target: 'idle',\n            },\n          },\n          tags: ['busy'],\n        },\n      },\n      initial: 'idle',\n    },\n  },\n  initial: 'loading',\n})\n\nexport type PresentationMachineRef = ActorRefFrom<typeof presentationMachine>\n","import {type Serializable, type SerializableObject} from '@sanity/presentation-comlink'\nimport {\n  type FunctionComponent,\n  type PropsWithChildren,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n} from 'react'\nimport {PresentationSharedStateContext} from 'sanity/_singletons'\n\nimport {type VisualEditingConnection} from '../types'\nimport {type PresentationSharedStateContextValue} from './types'\n\nexport const SharedStateProvider: FunctionComponent<\n  PropsWithChildren<{\n    comlink: VisualEditingConnection | null\n  }>\n> = function (props) {\n  const {comlink, children} = props\n\n  const sharedState = useRef<SerializableObject>({})\n\n  useEffect(() => {\n    return comlink?.on('visual-editing/shared-state', () => {\n      return {state: sharedState.current}\n    })\n  }, [comlink])\n\n  const setValue = useCallback(\n    (key: string, value: Serializable) => {\n      sharedState.current[key] = value\n      comlink?.post('presentation/shared-state', {key, value})\n    },\n    [comlink],\n  )\n\n  const removeValue = useCallback(\n    (key: string) => {\n      comlink?.post('presentation/shared-state', {key})\n      delete sharedState.current[key]\n    },\n    [comlink],\n  )\n\n  const context = useMemo<PresentationSharedStateContextValue>(\n    () => ({removeValue, setValue}),\n    [removeValue, setValue],\n  )\n\n  return (\n    <PresentationSharedStateContext.Provider value={context}>\n      {children}\n    </PresentationSharedStateContext.Provider>\n  )\n}\n","import {type FunctionComponent, type PropsWithChildren, useContext, useLayoutEffect} from 'react'\nimport {PresentationPanelsContext} from 'sanity/_singletons'\nimport {styled} from 'styled-components'\n\ninterface PanelProps extends PropsWithChildren {\n  defaultSize?: number | null\n  id: string\n  minWidth?: number\n  maxWidth?: number\n  order?: number\n}\n\nconst Root = styled.div`\n  overflow: hidden;\n  flex-basis: 0;\n  flex-shrink: 1;\n`\n\nexport const Panel: FunctionComponent<PanelProps> = function ({\n  children,\n  defaultSize = null,\n  id,\n  minWidth,\n  maxWidth,\n  order = 0,\n}) {\n  const context = useContext(PresentationPanelsContext)\n\n  if (context === null) {\n    throw Error(`Panel components must be rendered within a PanelGroup container`)\n  }\n\n  const {getPanelStyle, registerElement, unregisterElement} = context\n\n  const style = getPanelStyle(id)\n\n  useLayoutEffect(() => {\n    registerElement(id, {\n      id,\n      type: 'panel',\n      defaultSize,\n      maxWidth: maxWidth ?? null,\n      minWidth: minWidth ?? 0,\n      order,\n    })\n\n    return () => {\n      unregisterElement(id)\n    }\n  }, [id, defaultSize, order, maxWidth, minWidth, registerElement, unregisterElement])\n\n  return <Root style={style}>{children}</Root>\n}\n","export function debounce<F extends (...args: Parameters<F>) => ReturnType<F>>(\n  fn: F,\n  timeout: number,\n): F {\n  let timer: ReturnType<typeof setTimeout>\n  return ((...args: Parameters<F>) => {\n    clearTimeout(timer)\n    timer = setTimeout(() => {\n      fn.apply(fn, args)\n    }, timeout)\n  }) as F\n}\n","import {useMemo} from 'react'\n\nimport {debounce} from '../util/debounce'\nimport {type PanelElement} from './types'\n\nconst itemKey = 'presentation/panels'\n\ntype StoredPanelsState = Record<string, number[]>\n\nconst getStoredItem = () => {\n  // @todo Validate\n  return JSON.parse(localStorage.getItem(itemKey) || '{}') as StoredPanelsState\n}\nconst setStoredItem = (data: StoredPanelsState) => {\n  localStorage.setItem(itemKey, JSON.stringify(data))\n}\n\nconst getKeyForPanels = (panels: PanelElement[]) => {\n  return panels.map((panel) => [panel.id, panel.order].join(':')).join(',')\n}\n\nexport function usePanelsStorage(): {\n  get: (panels: PanelElement[]) => number[] | undefined\n  set: (panels: PanelElement[], widths: number[]) => void\n  setDebounced: (panels: PanelElement[], widths: number[]) => void\n} {\n  return useMemo(() => {\n    const get = (panels: PanelElement[]) => {\n      const stored = getStoredItem()\n      const key = getKeyForPanels(panels)\n      return Array.isArray(stored[key]) && stored[key].some((val) => val === null)\n        ? undefined\n        : stored[key]\n    }\n\n    const set = (panels: PanelElement[], widths: number[]) => {\n      const stored = getStoredItem()\n      const key = getKeyForPanels(panels)\n      const data = {\n        ...stored,\n        [key]: widths,\n      }\n      setStoredItem(data)\n    }\n\n    const setDebounced = debounce(set, 100)\n    return {\n      get,\n      set,\n      setDebounced,\n    }\n  }, [])\n}\n","/* eslint-disable @typescript-eslint/no-shadow,no-eq-null */\nimport {\n  type ElementMap,\n  type InitialDragState,\n  type PanelElement,\n  type PanelsState,\n  type ResizerElement,\n} from './types'\n\nfunction getNextWidth(panel: PanelElement, nextWidth: number, containerWidth: number) {\n  const {maxWidth: maxWidthPx, minWidth: minWidthPx} = panel\n  const maxWidth = maxWidthPx == null ? 100 : (maxWidthPx / containerWidth) * 100\n  const minWidth = (minWidthPx / containerWidth) * 100\n  return Math.min(maxWidth, Math.max(minWidth, nextWidth))\n}\n\n// eslint-disable-next-line max-params\nexport function getNextWidths(\n  delta: number,\n  containerWidth: number,\n  panelBefore: PanelElement,\n  panelAfter: PanelElement,\n  panelsState: PanelsState,\n  initialDragState: InitialDragState,\n): number[] {\n  const {panels, widths: prevWidths} = panelsState\n  const {widths: initialWidths} = initialDragState\n\n  const widths = initialWidths || prevWidths\n  const nextWidths = [...widths]\n\n  {\n    const pivotPanel = delta < 0 ? panelAfter : panelBefore\n    const index = panels.findIndex((panel) => panel.id === pivotPanel.id)\n    const width = widths[index]\n    const nextWidth = getNextWidth(pivotPanel, width + Math.abs(delta), containerWidth)\n    if (width === nextWidth) {\n      return widths\n    }\n    delta = delta < 0 ? width - nextWidth : nextWidth - width\n  }\n\n  let deltaApplied = 0\n  let pivotPanel = delta < 0 ? panelBefore : panelAfter\n  let index = panels.findIndex((panel) => panel.id === pivotPanel.id)\n\n  while (true) {\n    const panel = panels[index]\n    const width = widths[index]\n\n    const deltaRemaining = Math.abs(delta) - Math.abs(deltaApplied)\n\n    const nextWidth = getNextWidth(panel, width - deltaRemaining, containerWidth)\n\n    if (width !== nextWidth) {\n      deltaApplied += width - nextWidth\n      nextWidths[index] = nextWidth\n\n      if (\n        deltaApplied.toPrecision(10).localeCompare(Math.abs(delta).toPrecision(10), undefined, {\n          numeric: true,\n        }) >= 0\n      ) {\n        break\n      }\n    }\n\n    if (delta < 0) {\n      if (--index < 0) {\n        break\n      }\n    } else if (++index >= panels.length) {\n      break\n    }\n  }\n\n  if (deltaApplied === 0) {\n    return widths\n  }\n\n  pivotPanel = delta < 0 ? panelAfter : panelBefore\n  index = panels.findIndex((panel) => panel.id === pivotPanel.id)\n  nextWidths[index] = widths[index] + deltaApplied\n\n  return nextWidths\n}\n\nexport function getPanelWidth(panels: PanelElement[], id: string, widths: number[]): string {\n  if (panels.length === 1) return '100'\n\n  const index = panels.findIndex((panel) => panel.id === id)\n  const width = widths[index]\n\n  if (width == null) return '0'\n\n  return width.toPrecision(10)\n}\n\nexport function getOffset(\n  event: MouseEvent,\n  handleElement: HTMLDivElement,\n  initialOffset: number = 0,\n  initialHandleElementRect: DOMRect | null = null,\n): number {\n  const pointerOffset = event.clientX\n\n  const rect = initialHandleElementRect || handleElement.getBoundingClientRect()\n  const elementOffset = rect.left\n\n  return pointerOffset - elementOffset - initialOffset\n}\n\nexport function isPanel(element: PanelElement | ResizerElement): element is PanelElement {\n  return element.type === 'panel'\n}\n\nexport function isResizer(element: PanelElement | ResizerElement): element is ResizerElement {\n  return element.type === 'resizer'\n}\n\nexport function getSortedElements(elements: ElementMap): Array<PanelElement | ResizerElement> {\n  return Array.from(elements.values()).sort(({order: a}, {order: b}) => {\n    if (a == null && b == null) return 0\n    if (a == null) return -1\n    if (b == null) return 1\n    return a - b\n  })\n}\n\nexport function validateWidths(\n  panels: PanelElement[],\n  widthsToValidate: number[],\n  containerWidth: number,\n): number[] {\n  // Clamp widths proportionally to total 100\n  const total = widthsToValidate.reduce((total, width) => total + width, 0)\n  const widths = [...widthsToValidate].map((width) => (width / total) * 100)\n\n  let remainingWidth = 0\n\n  for (let index = 0; index < panels.length; index++) {\n    const panel = panels[index]\n    const width = widths[index]\n    const nextWidth = getNextWidth(panel, width, containerWidth)\n    if (width != nextWidth) {\n      remainingWidth += width - nextWidth\n      widths[index] = nextWidth\n    }\n  }\n\n  if (remainingWidth.toFixed(3) !== '0.000') {\n    for (let index = 0; index < panels.length; index++) {\n      const panel = panels[index]\n\n      let {maxWidth, minWidth} = panel\n\n      minWidth = (minWidth / containerWidth) * 100\n      if (maxWidth != null) {\n        maxWidth = (maxWidth / containerWidth) * 100\n      }\n\n      const width = Math.min(\n        // eslint-disable-next-line no-negated-condition\n        maxWidth != null ? maxWidth : 100,\n        Math.max(minWidth, widths[index] + remainingWidth),\n      )\n\n      if (width !== widths[index]) {\n        remainingWidth -= width - widths[index]\n        widths[index] = width\n\n        if (Math.abs(remainingWidth).toFixed(3) === '0.000') {\n          break\n        }\n      }\n    }\n  }\n\n  return widths\n}\n\nexport function getDefaultWidths(panels: PanelElement[]): number[] {\n  let panelsWithoutWidth = panels.length\n  let remainingWidthTotal = 100\n\n  const widthsWithNulls = panels.map((panel) => {\n    if (panel.defaultSize) {\n      remainingWidthTotal -= panel.defaultSize\n      panelsWithoutWidth -= 1\n      return panel.defaultSize\n    }\n    return null\n  })\n\n  const defaultWidth = remainingWidthTotal / panelsWithoutWidth\n  const widths = widthsWithNulls.map((width) => {\n    if (width === null) return defaultWidth\n    return width\n  })\n\n  return widths\n}\n","// Slightly modified version of react-resizable-panels\n// https://github.com/bvaughn/react-resizable-panels/tree/main/packages/react-resizable-panels\n\nimport {\n  type CSSProperties,\n  type FunctionComponent,\n  type PropsWithChildren,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport {PresentationPanelsContext} from 'sanity/_singletons'\nimport {styled} from 'styled-components'\n\nimport {\n  type ElementMap,\n  type InitialDragState,\n  type PanelElement,\n  type PanelsState,\n  type ResizerElement,\n} from './types'\nimport {usePanelsStorage} from './usePanelsStorage'\nimport {\n  getDefaultWidths,\n  getNextWidths,\n  getOffset,\n  getPanelWidth,\n  getSortedElements,\n  isPanel,\n  isResizer,\n  validateWidths,\n} from './util'\n\nconst PanelsWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  height: 100%;\n  overflow: hidden;\n  width: 100%;\n`\n\nexport const Panels: FunctionComponent<PropsWithChildren> = function ({children}) {\n  const panelsEl = useRef<HTMLDivElement | null>(null)\n\n  const [elements, setElements] = useState<ElementMap>(new Map())\n\n  const panels = useMemo(() => getSortedElements(elements).filter(isPanel), [elements])\n\n  const [widths, setWidths] = useState<number[]>([])\n  const [activeResizer, setActiveResizer] = useState<string | null>(null)\n\n  const panelsRef = useRef<PanelsState>({\n    elements,\n    panels,\n    widths,\n  })\n\n  const getPanelStyle = useCallback(\n    (id: string): CSSProperties => {\n      return {\n        flexGrow: getPanelWidth(panels, id, widths),\n        pointerEvents: activeResizer === null ? undefined : 'none',\n      }\n    },\n    [activeResizer, panels, widths],\n  )\n\n  const registerElement = useCallback((id: string, data: PanelElement | ResizerElement) => {\n    setElements((prev) => {\n      if (prev.has(id)) return prev\n      const next = new Map(prev)\n      next.set(id, data)\n      return next\n    })\n  }, [])\n  const unregisterElement = useCallback((id: string) => {\n    setElements((prev) => {\n      if (!prev.has(id)) return prev\n      const next = new Map(prev)\n      next.delete(id)\n      return next\n    })\n  }, [])\n\n  const dragRef = useRef<InitialDragState>({\n    containerWidth: window.innerWidth,\n    dragOffset: 0,\n    panelAfter: null,\n    panelBefore: null,\n    resizerIndex: -1,\n    resizerRect: null,\n    startX: 0,\n    widths: [],\n  })\n\n  const startDragging = useCallback(\n    (id: string, event: MouseEvent) => {\n      const elementsArr = getSortedElements(elements)\n      const index = elementsArr.findIndex((el) => el.id === id)\n\n      const resizer = elements.get(id)\n      if (!resizer || !isResizer(resizer)) return\n      const resizeElement = resizer.el.current\n      if (!resizeElement) return\n\n      dragRef.current = {\n        resizerIndex: index,\n        panelBefore: elementsArr.reduce(\n          (acc, el, i) => (isPanel(el) && i < index ? el : acc),\n          null as PanelElement | null,\n        ),\n        panelAfter: elementsArr.reduce(\n          (acc, el, i) => (acc === null && isPanel(el) && i > index ? el : acc),\n          null as PanelElement | null,\n        ),\n        containerWidth: window.innerWidth,\n        startX: event.pageX,\n        dragOffset: getOffset(event, resizeElement),\n        resizerRect: resizeElement.getBoundingClientRect(),\n        widths: panelsRef.current.widths,\n      }\n\n      setActiveResizer(id)\n    },\n    [elements],\n  )\n\n  const stopDragging = useCallback(() => {\n    setActiveResizer(null)\n  }, [])\n\n  const drag = useCallback(\n    (id: string, event: MouseEvent) => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      const {containerWidth, dragOffset, panelBefore, panelAfter, resizerRect} = dragRef.current\n\n      // eslint-disable-next-line no-eq-null\n      if (panelBefore == null || panelAfter == null) {\n        return\n      }\n\n      const resizer = elements.get(id)\n      if (!resizer || !isResizer(resizer)) return\n      const resizeElement = resizer.el.current\n      if (!resizeElement) return\n\n      const offset = getOffset(event, resizeElement, dragOffset, resizerRect)\n\n      if (offset === 0) {\n        return\n      }\n\n      const {widths: prevWidths} = panelsRef.current\n      const rect = panelsEl.current!.getBoundingClientRect()\n      const delta = (offset / rect.width) * 100\n\n      const nextWidths = getNextWidths(\n        delta,\n        containerWidth,\n        panelBefore,\n        panelAfter,\n        panelsRef.current,\n        dragRef.current,\n      )\n\n      const widthsChanged = prevWidths.some((prevWidth, i) => prevWidth !== nextWidths[i])\n\n      if (widthsChanged) {\n        setWidths(nextWidths)\n      }\n    },\n    [elements],\n  )\n\n  // For setting the panels state\n  useLayoutEffect(() => {\n    panelsRef.current.elements = elements\n    panelsRef.current.panels = panels\n    panelsRef.current.widths = widths\n  }, [elements, panels, widths])\n\n  const storage = usePanelsStorage()\n\n  // For setting default sizing when panels are updated\n  useLayoutEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    const {widths} = panelsRef.current\n\n    if (widths.length === panels.length) {\n      return\n    }\n\n    const storedWidths = storage.get(panels)\n\n    if (storedWidths) {\n      const validatedStoredWidths = validateWidths(panels, storedWidths, window.innerWidth)\n      setWidths(validatedStoredWidths)\n      return\n    }\n\n    const defaultWidths = getDefaultWidths(panels)\n    setWidths(defaultWidths)\n  }, [storage, panels])\n\n  // For storing current widths in localStorage\n  useEffect(() => {\n    if (!widths.length) return\n    storage.setDebounced(panels, widths)\n  }, [storage, panels, widths])\n\n  useLayoutEffect(() => {\n    const resizeObserver = new ResizeObserver(() => {\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      const {panels, widths: prevWidths} = panelsRef.current\n\n      const nextWidths = validateWidths(panels, prevWidths, window.innerWidth)\n\n      const widthsChanged = prevWidths.some((prevWidth, i) => prevWidth !== nextWidths[i])\n      if (widthsChanged) {\n        setWidths(nextWidths)\n      }\n    })\n\n    resizeObserver.observe(panelsEl.current!)\n\n    return () => {\n      resizeObserver.disconnect()\n    }\n  }, [])\n\n  const context = useMemo(\n    () => ({\n      activeResizer,\n      drag,\n      getPanelStyle,\n      registerElement,\n      startDragging,\n      stopDragging,\n      unregisterElement,\n    }),\n    [\n      activeResizer,\n      drag,\n      getPanelStyle,\n      registerElement,\n      startDragging,\n      stopDragging,\n      unregisterElement,\n    ],\n  )\n\n  return (\n    <PresentationPanelsContext.Provider value={context}>\n      <PanelsWrapper ref={panelsEl}>{children}</PanelsWrapper>\n    </PresentationPanelsContext.Provider>\n  )\n}\n","import {Box, Card, type CardProps, Container, Flex, Inline, Stack, Text} from '@sanity/ui'\nimport {type ReactNode} from 'react'\nimport {useTranslation} from 'sanity'\n\nimport {Button} from '../../ui-components'\nimport {presentationLocaleNamespace} from '../i18n'\n\nexport function ErrorCard(\n  props: {\n    children?: ReactNode\n    message: string\n    onRetry?: () => void\n    onContinueAnyway?: () => void\n  } & CardProps,\n): React.JSX.Element {\n  const {children, message, onRetry, onContinueAnyway, ...restProps} = props\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n\n  const retryButton = (\n    <Button mode=\"ghost\" onClick={onRetry} text={t('error-card.retry-button.text')} />\n  )\n  const continueAnywayButton = (\n    <Button\n      mode=\"ghost\"\n      tone=\"critical\"\n      onClick={onContinueAnyway}\n      text={t('error-card.continue-button.text')}\n    />\n  )\n\n  return (\n    <Card height=\"fill\" {...restProps}>\n      <Flex align=\"center\" height=\"fill\" justify=\"center\">\n        <Container padding={4} sizing=\"border\" width={0}>\n          <Stack space={4}>\n            <Stack space={3}>\n              <Text size={1} weight=\"semibold\">\n                {t('error-card.title')}\n              </Text>\n              <Text muted size={1}>\n                {message}\n              </Text>\n            </Stack>\n\n            {children}\n\n            {onRetry && onContinueAnyway ? (\n              <Inline space={2}>\n                {retryButton}\n                {continueAnywayButton}\n              </Inline>\n            ) : onRetry ? (\n              <Box>{retryButton}</Box>\n            ) : onContinueAnyway ? (\n              <Box>{continueAnywayButton}</Box>\n            ) : null}\n          </Stack>\n        </Container>\n      </Flex>\n    </Card>\n  )\n}\n","import {forwardRef} from 'react'\nimport {StateLink} from 'sanity/router'\nimport {type ChildLinkProps} from 'sanity/structure'\n\nimport {type PresentationSearchParams} from '../types'\n\nexport const ChildLink = forwardRef(function ChildLink(\n  props: ChildLinkProps & {\n    childType: string\n    searchParams: PresentationSearchParams\n  },\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {childId, childType, childPayload, childParameters, searchParams, ...rest} = props\n\n  return (\n    <StateLink\n      {...rest}\n      ref={ref}\n      state={{\n        id: childId,\n        type: childType,\n        _searchParams: Object.entries({...searchParams, ...childParameters}),\n      }}\n    />\n  )\n})\n","import {forwardRef} from 'react'\nimport {getPublishedId, pathToString} from 'sanity'\nimport {type ReferenceChildLinkProps} from 'sanity/structure'\n\nimport {type PresentationSearchParams} from '../types'\nimport {ChildLink} from './ChildLink'\n\nexport const ReferenceChildLink = forwardRef(function ReferenceChildLink(\n  props: ReferenceChildLinkProps & {searchParams: PresentationSearchParams},\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {documentId, documentType, parentRefPath, template, searchParams, ...rest} = props\n\n  return (\n    <ChildLink\n      {...rest}\n      ref={ref}\n      childId={getPublishedId(documentId)}\n      childType={documentType}\n      childPayload={template?.params}\n      childParameters={{\n        parentRefPath: pathToString(parentRefPath),\n        ...(template && {template: template?.id}),\n      }}\n      searchParams={searchParams}\n    />\n  )\n})\n","import {toString as pathToString} from '@sanity/util/paths'\nimport {forwardRef, type PropsWithChildren, useCallback, useMemo} from 'react'\nimport {getPublishedId, useUnique} from 'sanity'\nimport {StateLink, useRouter} from 'sanity/router'\nimport {\n  type BackLinkProps,\n  type ChildLinkProps,\n  PaneRouterContext,\n  type PaneRouterContextValue,\n  type ReferenceChildLinkProps,\n} from 'sanity/structure'\n\nimport {\n  type PresentationNavigate,\n  type PresentationParamsContextValue,\n  type PresentationSearchParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {ChildLink} from './ChildLink'\nimport {ReferenceChildLink} from './ReferenceChildLink'\n\nfunction encodeQueryString(params: Record<string, unknown> = {}): string {\n  const parts = Object.entries(params)\n    .map(([key, value]) => `${key}=${value}`)\n    .join('&')\n\n  return parts.length ? `?${parts}` : ''\n}\n\nfunction resolveQueryStringFromParams(nextParams: Record<string, string | undefined>) {\n  const allowed = [\n    'comment',\n    'inspect',\n    'instruction',\n    'pathKey',\n    'rev',\n    'since',\n    'template',\n    'view',\n  ] satisfies Array<keyof PresentationParamsContextValue> as string[]\n\n  const safeNextParams = Object.entries(nextParams)\n    .filter(([key]) => allowed.includes(key))\n    .reduce((obj, [key, value]) => {\n      if (value == undefined) return obj\n      return {...obj, [key]: value}\n    }, {})\n\n  return encodeQueryString(safeNextParams)\n}\n\nconst BackLink = forwardRef(function BackLink(\n  props: BackLinkProps & {searchParams: PresentationSearchParams},\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {searchParams, ...restProps} = props\n  return (\n    <StateLink\n      {...restProps}\n      ref={ref}\n      state={{\n        type: undefined,\n        _searchParams: Object.entries(searchParams),\n      }}\n      title={undefined}\n    />\n  )\n})\n\nexport type PresentationPaneRouterProviderProps = PropsWithChildren<{\n  onEditReference: PresentationNavigate\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  refs?: {_id: string; _type: string}[]\n  searchParams: PresentationSearchParams\n  structureParams: StructureDocumentPaneParams\n}>\n\nexport function PresentationPaneRouterProvider(\n  props: PresentationPaneRouterProviderProps,\n): React.JSX.Element {\n  const {children, onEditReference, onStructureParams, structureParams, searchParams, refs} = props\n\n  const {state: routerState, resolvePathFromState} = useRouter()\n\n  const routerSearchParams = useUnique(Object.fromEntries(routerState._searchParams || []))\n\n  const createPathWithParams: PaneRouterContextValue['createPathWithParams'] = useCallback(\n    (nextParams) => {\n      const path = resolvePathFromState(routerState)\n      const qs = resolveQueryStringFromParams({\n        ...routerSearchParams,\n        ...nextParams,\n      })\n      return `${path}${qs}`\n    },\n    [resolvePathFromState, routerSearchParams, routerState],\n  )\n\n  const context: PaneRouterContextValue = useMemo(() => {\n    return {\n      index: 0,\n      groupIndex: 0,\n      siblingIndex: 0,\n      payload: {},\n      // oxlint-disable-next-line no-explicit-any\n      params: structureParams as any,\n      hasGroupSiblings: false,\n      groupLength: 1,\n      routerPanesState: [],\n      ChildLink: forwardRef<HTMLAnchorElement, ChildLinkProps>(\n        function ContextChildLink(childLinkProps, ref) {\n          const {childId, ...rest} = childLinkProps\n          const doc = refs?.find((r) => r._id === childId || getPublishedId(r._id) === childId)\n\n          if (!doc) {\n            console.warn(`ChildLink: No document found for childId \"${childId}\"`)\n            return null\n          }\n\n          return (\n            <ChildLink\n              {...rest}\n              ref={ref}\n              childId={childId}\n              childType={doc._type}\n              searchParams={searchParams}\n            />\n          )\n        },\n      ),\n      BackLink: forwardRef<HTMLAnchorElement, BackLinkProps>(\n        function ContextBackLink(backLinkProps, ref) {\n          return <BackLink {...backLinkProps} ref={ref} searchParams={searchParams} />\n        },\n      ),\n      ReferenceChildLink: forwardRef<HTMLAnchorElement, ReferenceChildLinkProps>(\n        function ContextReferenceChildLink(childLinkProps, ref) {\n          return <ReferenceChildLink {...childLinkProps} ref={ref} searchParams={searchParams} />\n        },\n      ),\n      ParameterizedLink: () => {\n        throw new Error('ParameterizedLink not implemented')\n      },\n      closeCurrentAndAfter: () => {\n        console.warn('closeCurrentAndAfter')\n      },\n      handleEditReference: (options) => {\n        const {id, template, type, parentRefPath, version} = options\n        onEditReference({\n          state: {id, type},\n          params: {\n            template: template.id,\n            parentRefPath: pathToString(parentRefPath),\n            version,\n          },\n        })\n      },\n      replaceCurrent: (pane) => {\n        console.warn('replaceCurrent', pane)\n      },\n      closeCurrent: () => {\n        console.warn('closeCurrent')\n      },\n      duplicateCurrent: (pane) => {\n        console.warn('duplicateCurrent', pane)\n      },\n      setView: (viewId) => {\n        console.warn('setView', viewId)\n      },\n      setParams: onStructureParams,\n      setPayload: (payload) => {\n        console.warn('setPayload', payload)\n      },\n      navigateIntent: (intentName, intentParams, options) => {\n        console.warn('navigateIntent', intentName, intentParams, options)\n      },\n      createPathWithParams,\n    }\n  }, [\n    createPathWithParams,\n    onEditReference,\n    onStructureParams,\n    refs,\n    searchParams,\n    structureParams,\n  ])\n\n  return <PaneRouterContext.Provider value={context}>{children}</PaneRouterContext.Provider>\n}\n","import {Card, Code, Flex, Label, Stack} from '@sanity/ui'\nimport {type ErrorInfo, useCallback, useEffect, useMemo, useState} from 'react'\nimport {getPublishedId, useTranslation} from 'sanity'\nimport {\n  DocumentListPane as StructureDocumentListPane,\n  PaneLayout,\n  type PaneNode,\n  StructureToolProvider,\n} from 'sanity/structure'\nimport {styled} from 'styled-components'\n\nimport {ErrorBoundary} from '../../ui-components'\nimport {ErrorCard} from '../components/ErrorCard'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {PresentationPaneRouterProvider} from '../paneRouter/PresentationPaneRouterProvider'\nimport {\n  type MainDocumentState,\n  type PresentationNavigate,\n  type PresentationSearchParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {usePresentationTool} from '../usePresentationTool'\n\nconst RootLayout = styled(PaneLayout)`\n  height: 100%;\n`\n\nconst Root = styled(Flex)`\n  & > div {\n    min-width: none !important;\n    max-width: none !important;\n  }\n`\n\nconst WrappedCode = styled(Code)`\n  white-space: pre-wrap;\n`\n\nexport function DocumentListPane(props: {\n  mainDocumentState?: MainDocumentState\n  onEditReference: PresentationNavigate\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  searchParams: PresentationSearchParams\n  refs: {_id: string; _type: string}[]\n}): React.JSX.Element {\n  const {mainDocumentState, onEditReference, onStructureParams, searchParams, refs} = props\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {devMode} = usePresentationTool()\n\n  const ids = useMemo(\n    () =>\n      refs\n        .filter((r) => getPublishedId(r._id) !== mainDocumentState?.document?._id)\n        .map((r) => getPublishedId(r._id)),\n    [mainDocumentState, refs],\n  )\n\n  const pane: Extract<PaneNode, {type: 'documentList'}> = useMemo(\n    () => ({\n      id: '$root',\n      options: {\n        filter: '_id in $ids',\n        params: {ids},\n        // defaultOrdering: [{field: '_updatedAt', direction: 'desc'}],\n      },\n      schemaTypeName: '',\n      title: t('document-list-pane.document-list.title'),\n      type: 'documentList',\n    }),\n    [ids, t],\n  )\n\n  const [errorParams, setErrorParams] = useState<{\n    info: ErrorInfo\n    error: Error\n  } | null>(null)\n\n  const handleRetry = useCallback(() => setErrorParams(null), [])\n\n  const [structureParams] = useState(() => ({}))\n\n  // Reset error state when `refs` value schanges\n  useEffect(() => setErrorParams(null), [refs])\n\n  if (errorParams) {\n    return (\n      <ErrorCard flex={1} message={t('document-list-pane.error.text')} onRetry={handleRetry}>\n        {devMode && (\n          // show runtime error message in dev mode\n          <Card overflow=\"auto\" padding={3} radius={2} tone=\"critical\">\n            <Stack space={3}>\n              <Label muted size={0}>\n                {t('presentation-error.label')}\n              </Label>\n              <WrappedCode size={1}>{errorParams.error.message}</WrappedCode>\n            </Stack>\n          </Card>\n        )}\n      </ErrorCard>\n    )\n  }\n\n  return (\n    <ErrorBoundary onCatch={setErrorParams}>\n      <RootLayout>\n        <StructureToolProvider>\n          <PresentationPaneRouterProvider\n            onEditReference={onEditReference}\n            onStructureParams={onStructureParams}\n            structureParams={structureParams}\n            searchParams={searchParams}\n            refs={refs}\n          >\n            <Root direction=\"column\" flex={1}>\n              <StructureDocumentListPane\n                index={0}\n                itemId=\"$root\"\n                pane={pane}\n                // eslint-disable-next-line @sanity/i18n/no-attribute-string-literals\n                paneKey=\"$root\"\n              />\n            </Root>\n          </PresentationPaneRouterProvider>\n        </StructureToolProvider>\n      </RootLayout>\n    </ErrorBoundary>\n  )\n}\n","import {studioPath} from '@sanity/client/csm'\nimport {Card, Code, Label, Stack} from '@sanity/ui'\nimport {type ErrorInfo, Suspense, useCallback, useEffect, useMemo, useState} from 'react'\nimport {type Path, useTranslation} from 'sanity'\nimport {decodeJsonParams} from 'sanity/router'\nimport {\n  DocumentPane as StructureDocumentPane,\n  type DocumentPaneNode,\n  PaneLayout,\n} from 'sanity/structure'\nimport {styled} from 'styled-components'\n\nimport {ErrorBoundary} from '../../ui-components'\nimport {ErrorCard} from '../components/ErrorCard'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {PresentationPaneRouterProvider} from '../paneRouter/PresentationPaneRouterProvider'\nimport {PresentationSpinner} from '../PresentationSpinner'\nimport {\n  type PresentationNavigate,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {usePresentationTool} from '../usePresentationTool'\n\nconst WrappedCode = styled(Code)`\n  white-space: pre-wrap;\n`\n\nexport function DocumentPane(props: {\n  documentId: string\n  documentType: string\n  onFocusPath: (state: Required<PresentationStateParams>) => void\n  onEditReference: PresentationNavigate\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  structureParams: StructureDocumentPaneParams\n  searchParams: PresentationSearchParams\n}): React.JSX.Element {\n  const {\n    documentId,\n    documentType,\n    onFocusPath,\n    onEditReference,\n    onStructureParams,\n    searchParams,\n    structureParams,\n  } = props\n  const {template, templateParams} = structureParams\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {devMode} = usePresentationTool()\n\n  const paneDocumentNode: DocumentPaneNode = useMemo(\n    () => ({\n      id: documentId,\n      options: {\n        id: documentId,\n        type: documentType,\n        template,\n        templateParameters: decodeJsonParams(templateParams),\n      },\n      title: '',\n      type: 'document',\n    }),\n    [documentId, documentType, template, templateParams],\n  )\n\n  const handleFocusPath = useCallback(\n    (path: Path) => {\n      return onFocusPath({\n        id: documentId,\n        type: documentType,\n        path: studioPath.toString(path),\n      })\n    },\n    [documentId, documentType, onFocusPath],\n  )\n\n  const [errorParams, setErrorParams] = useState<{\n    info: ErrorInfo\n    error: Error\n  } | null>(null)\n\n  const handleRetry = useCallback(() => setErrorParams(null), [])\n\n  // Reset error state when parameters change\n  useEffect(() => {\n    setErrorParams(null)\n  }, [documentId, documentType, structureParams])\n\n  if (errorParams) {\n    return (\n      <ErrorCard flex={1} message={t('document-pane.error.text')} onRetry={handleRetry}>\n        {devMode && (\n          // show runtime error message in dev mode\n          <Card overflow=\"auto\" padding={3} radius={2} tone=\"critical\">\n            <Stack space={3}>\n              <Label muted size={0}>\n                {t('presentation-error.label')}\n              </Label>\n              <WrappedCode size={1}>{errorParams.error.message}</WrappedCode>\n            </Stack>\n          </Card>\n        )}\n      </ErrorCard>\n    )\n  }\n\n  return (\n    <ErrorBoundary onCatch={setErrorParams}>\n      <PaneLayout style={{height: '100%'}}>\n        <PresentationPaneRouterProvider\n          searchParams={searchParams}\n          onEditReference={onEditReference}\n          onStructureParams={onStructureParams}\n          structureParams={structureParams}\n        >\n          <Suspense fallback={<PresentationSpinner />}>\n            <StructureDocumentPane\n              // eslint-disable-next-line @sanity/i18n/no-attribute-string-literals\n              paneKey=\"document\"\n              index={1}\n              itemId=\"document\"\n              pane={paneDocumentNode}\n              onFocusPath={handleFocusPath}\n            />\n          </Suspense>\n        </PresentationPaneRouterProvider>\n      </PaneLayout>\n    </ErrorBoundary>\n  )\n}\n","import {StructureToolProvider} from '../../structure/StructureToolProvider'\nimport {\n  type PresentationNavigate,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {DocumentPane} from './DocumentPane'\n\nexport function DocumentPanel(props: {\n  documentId: string\n  documentType: string\n  onEditReference: PresentationNavigate\n  onFocusPath: (state: Required<PresentationStateParams>) => void\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  searchParams: PresentationSearchParams\n  structureParams: StructureDocumentPaneParams\n}): React.JSX.Element {\n  const {\n    documentId,\n    documentType,\n    onFocusPath,\n    onEditReference,\n    onStructureParams,\n    searchParams,\n    structureParams,\n  } = props\n  return (\n    <StructureToolProvider>\n      <DocumentPane\n        documentId={documentId}\n        documentType={documentType}\n        onEditReference={onEditReference}\n        onFocusPath={onFocusPath}\n        onStructureParams={onStructureParams}\n        searchParams={searchParams}\n        structureParams={structureParams}\n      />\n    </StructureToolProvider>\n  )\n}\n","import {type SchemaType} from '@sanity/types'\nimport {useEffect, useState} from 'react'\nimport {\n  getPreviewStateObservable,\n  type PreviewValue,\n  type SanityDocument,\n  useDocumentPreviewStore,\n  usePerspective,\n} from 'sanity'\n\ninterface PreviewState {\n  isLoading?: boolean\n  snapshot?: PreviewValue | Partial<SanityDocument> | null\n}\n\nexport default function usePreviewState(documentId: string, schemaType?: SchemaType): PreviewState {\n  const documentPreviewStore = useDocumentPreviewStore()\n  const [preview, setPreview] = useState<PreviewState>({})\n  const {perspectiveStack} = usePerspective()\n  useEffect(() => {\n    if (!schemaType) {\n      return undefined\n    }\n    const subscription = getPreviewStateObservable(\n      documentPreviewStore,\n      schemaType,\n      documentId,\n      perspectiveStack,\n    ).subscribe((state) => {\n      setPreview(state)\n    })\n\n    return () => {\n      subscription?.unsubscribe()\n    }\n  }, [documentPreviewStore, schemaType, documentId, perspectiveStack])\n\n  return preview\n}\n","import {WarningOutlineIcon} from '@sanity/icons'\nimport {Box, Card, Flex, Text} from '@sanity/ui'\nimport {type HTMLProps, useCallback, useMemo} from 'react'\nimport {\n  getPreviewValueWithFallback,\n  PreviewCard,\n  SanityDefaultPreview,\n  Translate,\n  useSchema,\n  useTranslation,\n} from 'sanity'\nimport {StateLink} from 'sanity/router'\n\nimport {presentationLocaleNamespace} from '../i18n'\nimport {\n  type MainDocumentState,\n  type PresentationNavigate,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {DocumentListPane} from './DocumentListPane'\nimport {DocumentPanel} from './DocumentPanel'\nimport usePreviewState from './usePreviewState'\n\nexport function ContentEditor(props: {\n  documentId?: string\n  documentType?: string\n  mainDocumentState?: MainDocumentState\n  onEditReference: PresentationNavigate\n  onFocusPath: (state: Required<PresentationStateParams>) => void\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  refs: {_id: string; _type: string}[]\n  structureParams: StructureDocumentPaneParams\n  searchParams: PresentationSearchParams\n}): React.JSX.Element {\n  const {\n    documentId,\n    documentType,\n    mainDocumentState,\n    onEditReference,\n    onFocusPath,\n    onStructureParams,\n    refs,\n    searchParams,\n    structureParams,\n  } = props\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const schema = useSchema()\n\n  const MainDocumentLink = useCallback(\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    (props: HTMLProps<HTMLAnchorElement>) => {\n      return (\n        <StateLink\n          {...props}\n          state={{\n            id: mainDocumentState?.document?._id,\n            type: mainDocumentState?.document?._type,\n            _searchParams: Object.entries(searchParams),\n          }}\n        />\n      )\n    },\n    [mainDocumentState, searchParams],\n  )\n\n  const schemaType = useMemo(\n    () => schema.get(mainDocumentState?.document?._type || 'shoe')!,\n    [mainDocumentState, schema],\n  )\n\n  const previewState = usePreviewState(mainDocumentState?.document?._id || '', schemaType)\n\n  const preview = useMemo(() => {\n    if (!mainDocumentState?.document) return null\n\n    return (\n      <SanityDefaultPreview\n        {...getPreviewValueWithFallback({\n          snapshot: previewState.snapshot,\n          fallback: mainDocumentState!.document,\n        })}\n        schemaType={schemaType}\n        status={\n          <Card padding={1} radius={2} shadow={1}>\n            <Text muted size={0} weight=\"medium\">\n              {t('main-document.label')}\n            </Text>\n          </Card>\n        }\n      />\n    )\n  }, [mainDocumentState, schemaType, t, previewState])\n\n  if (documentId && documentType) {\n    return (\n      <DocumentPanel\n        documentId={documentId}\n        documentType={documentType}\n        onEditReference={onEditReference}\n        onFocusPath={onFocusPath}\n        onStructureParams={onStructureParams}\n        searchParams={searchParams}\n        structureParams={structureParams}\n      />\n    )\n  }\n\n  return (\n    <Flex direction=\"column\" flex={1} height=\"fill\">\n      {mainDocumentState && (\n        <Card padding={3} tone={mainDocumentState.document ? 'inherit' : 'caution'}>\n          {mainDocumentState.document ? (\n            <PreviewCard\n              __unstable_focusRing\n              // oxlint-disable-next-line no-explicit-any\n              as={MainDocumentLink as any}\n              data-as=\"a\"\n              radius={2}\n              sizing=\"border\"\n              tone=\"inherit\"\n            >\n              {preview}\n            </PreviewCard>\n          ) : (\n            <Card padding={2} radius={2} tone=\"inherit\">\n              <Flex gap={3}>\n                <Box flex=\"none\">\n                  <Text size={1}>\n                    <WarningOutlineIcon />\n                  </Text>\n                </Box>\n                <Box flex={1}>\n                  <Text size={1}>\n                    <Translate\n                      t={t}\n                      i18nKey=\"main-document.missing.text\"\n                      components={{Code: 'code'}}\n                      values={{path: mainDocumentState.path}}\n                    />\n                  </Text>\n                </Box>\n              </Flex>\n            </Card>\n          )}\n        </Card>\n      )}\n\n      <DocumentListPane\n        mainDocumentState={mainDocumentState}\n        onEditReference={onEditReference}\n        onStructureParams={onStructureParams}\n        searchParams={searchParams}\n        refs={refs}\n      />\n    </Flex>\n  )\n}\n","import {useState} from 'react'\nimport {v4 as uuid} from 'uuid'\n\nexport function usePanelId(id?: string): string {\n  const [panelId] = useState(() => id || uuid())\n  return panelId\n}\n","import {\n  type FunctionComponent,\n  type MouseEvent as ReactMouseEvent,\n  useCallback,\n  useContext,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n} from 'react'\nimport {PresentationPanelsContext} from 'sanity/_singletons'\nimport {styled} from 'styled-components'\n\nimport {usePanelId} from './usePanelId'\n\nconst Resizer = styled.div`\n  position: relative;\n`\nconst ResizerInner = styled.div<{\n  $disabled: boolean\n}>`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: -5px;\n  width: 9px;\n  z-index: 10;\n  cursor: ${({$disabled}) => ($disabled ? 'auto' : 'ew-resize')};\n\n  /* Border */\n  & > span:nth-child(1) {\n    display: block;\n    border-left: 1px solid var(--card-border-color);\n    position: absolute;\n    top: 0;\n    left: 4px;\n    bottom: 0;\n    transition: opacity 200ms;\n  }\n\n  ${({$disabled}) =>\n    !$disabled &&\n    `\n    /* Hover effect */\n    & > span:nth-child(2) {\n      display: block;\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 9px;\n      bottom: 0;\n      background-color: var(--card-border-color);\n      opacity: 0;\n      transition: opacity 150ms;\n    }\n\n    @media (hover: hover) {\n      &:hover > span:nth-child(2) {\n        opacity: 0.2;\n      }\n    }\n  `}\n`\n\nexport const PanelResizer: FunctionComponent<{\n  id?: string\n  order: number\n  disabled?: boolean\n}> = function ({id: propId, order, disabled = false}) {\n  const el = useRef<HTMLDivElement>(null)\n\n  const context = useContext(PresentationPanelsContext)\n\n  if (context === null) {\n    throw Error(`Panel components must be rendered within a PanelGroup container`)\n  }\n\n  const id = usePanelId(propId)\n\n  const {activeResizer, drag, startDragging, stopDragging, registerElement, unregisterElement} =\n    context\n\n  const isDragging = activeResizer === id\n\n  if (context === null) {\n    throw Error(`Panel components must be rendered within a PanelGroup container`)\n  }\n\n  const onMouseDown = useCallback(\n    (event: ReactMouseEvent) => {\n      startDragging(id, event.nativeEvent)\n    },\n    [id, startDragging],\n  )\n\n  const onDrag = useCallback(\n    (e: MouseEvent) => {\n      drag(id, e)\n    },\n    [id, drag],\n  )\n\n  const onDragStop = useCallback(() => {\n    el.current!.blur()\n    stopDragging()\n  }, [stopDragging])\n\n  useEffect(() => {\n    if (!isDragging || disabled) return\n\n    // Set styles to prevent text selection and force an ew-resize cursor whilst\n    // dragging. Return a reset callback so we can revert to any values that\n    // might have been present before dragging started.\n    function setDocumentStyles() {\n      const bodyStyle = document.body.style\n      const documentStyle = document.documentElement.style\n\n      const {cursor} = documentStyle\n      const {userSelect} = bodyStyle\n\n      documentStyle.cursor = 'ew-resize'\n      bodyStyle.userSelect = 'none'\n\n      return () => {\n        if (cursor) documentStyle.cursor = cursor\n        else documentStyle.removeProperty('cursor')\n\n        if (userSelect) bodyStyle.userSelect = userSelect\n        else bodyStyle.removeProperty('user-select')\n      }\n    }\n\n    const resetDocumentStyles = setDocumentStyles()\n    window.addEventListener('mousemove', onDrag)\n    window.addEventListener('mouseup', onDragStop)\n    window.addEventListener('contextmenu', onDragStop)\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      resetDocumentStyles()\n      window.removeEventListener('mousemove', onDrag)\n      window.removeEventListener('mouseup', onDragStop)\n      window.removeEventListener('contextmenu', onDragStop)\n    }\n  }, [disabled, isDragging, onDrag, onDragStop])\n\n  useLayoutEffect(() => {\n    registerElement(id, {id, order, type: 'resizer', el})\n\n    return () => {\n      unregisterElement(id)\n    }\n  }, [id, order, registerElement, unregisterElement])\n\n  return (\n    <Resizer onMouseDown={onMouseDown} ref={el}>\n      <ResizerInner $disabled={disabled}>\n        <span />\n        <span />\n      </ResizerInner>\n    </Resizer>\n  )\n}\n","import {\n  type Dispatch,\n  type FunctionComponent,\n  type PropsWithChildren,\n  type SetStateAction,\n} from 'react'\nimport {type CommentIntentGetter, CommentsIntentProvider, type SanityDocument} from 'sanity'\n\nimport {ContentEditor} from './editor/ContentEditor'\nimport {DisplayedDocumentBroadcasterProvider} from './loader/DisplayedDocumentBroadcaster'\nimport {Panel} from './panels/Panel'\nimport {PanelResizer} from './panels/PanelResizer'\nimport {\n  type MainDocumentState,\n  type PresentationNavigate,\n  type PresentationParamsContextValue,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from './types'\n\nexport interface PresentationContentProps {\n  documentId: PresentationParamsContextValue['id']\n  documentsOnPage: {_id: string; _type: string}[]\n  documentType: PresentationParamsContextValue['type']\n  getCommentIntent: CommentIntentGetter\n  mainDocumentState: MainDocumentState | undefined\n  onEditReference: PresentationNavigate\n  onFocusPath: (state: Required<PresentationStateParams>) => void\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  searchParams: PresentationSearchParams\n  setDisplayedDocument: Dispatch<SetStateAction<Partial<SanityDocument> | null | undefined>>\n  structureParams: StructureDocumentPaneParams\n}\n\nconst PresentationContentWrapper: FunctionComponent<\n  PropsWithChildren<{\n    documentId?: string\n    getCommentIntent: CommentIntentGetter\n    setDisplayedDocument: Dispatch<SetStateAction<Partial<SanityDocument> | null | undefined>>\n  }>\n> = (props) => {\n  const {documentId, setDisplayedDocument, getCommentIntent} = props\n  return (\n    <>\n      <PanelResizer order={4} />\n      <Panel id=\"content\" minWidth={325} order={5}>\n        <DisplayedDocumentBroadcasterProvider\n          documentId={documentId}\n          setDisplayedDocument={setDisplayedDocument}\n        >\n          <CommentsIntentProvider getIntent={getCommentIntent}>\n            {props.children}\n          </CommentsIntentProvider>\n        </DisplayedDocumentBroadcasterProvider>\n      </Panel>\n    </>\n  )\n}\n\nexport const PresentationContent: FunctionComponent<PresentationContentProps> = (props) => {\n  const {\n    documentId,\n    documentsOnPage,\n    documentType,\n    getCommentIntent,\n    mainDocumentState,\n    onEditReference,\n    onFocusPath,\n    onStructureParams,\n    searchParams,\n    setDisplayedDocument,\n    structureParams,\n  } = props\n\n  return (\n    <PresentationContentWrapper\n      documentId={documentId}\n      getCommentIntent={getCommentIntent}\n      setDisplayedDocument={setDisplayedDocument}\n    >\n      <ContentEditor\n        documentId={documentId}\n        documentType={documentType}\n        mainDocumentState={mainDocumentState}\n        onEditReference={onEditReference}\n        onFocusPath={onFocusPath}\n        onStructureParams={onStructureParams}\n        refs={documentsOnPage}\n        searchParams={searchParams}\n        structureParams={structureParams}\n      />\n    </PresentationContentWrapper>\n  )\n}\n","import {type FunctionComponent, type PropsWithChildren, useCallback} from 'react'\nimport {PresentationNavigateContext} from 'sanity/_singletons'\n\nimport {\n  type CombinedSearchParams,\n  type PresentationNavigate,\n  type PresentationNavigateContextValue,\n  type PresentationNavigateOptions,\n  type PresentationStateParams,\n} from './types'\n\nexport const PresentationNavigateProvider: FunctionComponent<\n  PropsWithChildren<{\n    navigate: PresentationNavigate\n  }>\n> = function (props) {\n  const {children, navigate: _navigate} = props\n\n  const navigate = useCallback<PresentationNavigateContextValue>(\n    (preview, document) => {\n      if (preview || document) {\n        const obj: {\n          state?: PresentationStateParams\n          params?: CombinedSearchParams\n        } = {}\n        if (preview) obj.params = {preview}\n        if (document) obj.state = document\n        // Cast because navigate expects either params or state to be defined, which we guarantee above\n        _navigate(obj as PresentationNavigateOptions)\n      }\n    },\n    [_navigate],\n  )\n\n  return (\n    <PresentationNavigateContext.Provider value={navigate}>\n      {children}\n    </PresentationNavigateContext.Provider>\n  )\n}\n","import {type Dispatch, type SetStateAction, useEffect, useState} from 'react'\n\nexport function useLocalState<T>(key: string, defaultValue: T): [T, Dispatch<SetStateAction<T>>] {\n  const [value, setValue] = useState<T>(() =>\n    JSON.parse(localStorage.getItem(key) ?? JSON.stringify(defaultValue)),\n  )\n\n  useEffect(() => {\n    localStorage.setItem(key, JSON.stringify(value))\n  }, [key, value])\n\n  return [value, setValue]\n}\n","import {memo, useCallback, useMemo} from 'react'\n\nimport {Panel} from './panels/Panel'\nimport {PanelResizer} from './panels/PanelResizer'\nimport {type NavigatorOptions} from './types'\nimport {useLocalState} from './useLocalState'\n\n/** @internal */\nexport interface UsePresentationNavigatorProps {\n  unstable_navigator?: NavigatorOptions\n}\n\n/** @internal */\nexport interface UsePresentationNavigatorState {\n  navigatorEnabled: boolean\n  toggleNavigator: (() => void) | undefined\n}\n\n/** @internal */\nexport function usePresentationNavigator(\n  props: UsePresentationNavigatorProps,\n): [UsePresentationNavigatorState, () => React.JSX.Element] {\n  const {unstable_navigator} = props\n\n  const navigatorProvided = !!unstable_navigator?.component\n  const [_navigatorEnabled, setNavigatorEnabled] = useLocalState<boolean>(\n    'presentation/navigator',\n    navigatorProvided,\n  )\n  const navigatorEnabled = navigatorProvided ? _navigatorEnabled : false\n  const toggleNavigator = useMemo(() => {\n    if (!navigatorProvided) return undefined\n\n    return () => setNavigatorEnabled((enabled) => !enabled)\n  }, [navigatorProvided, setNavigatorEnabled])\n\n  const Component = useCallback(\n    function PresentationNavigator() {\n      return <>{navigatorEnabled && <Navigator {...unstable_navigator!} />}</>\n    },\n    [navigatorEnabled, unstable_navigator],\n  )\n\n  return [{navigatorEnabled, toggleNavigator}, Component]\n}\n\nfunction NavigatorComponent(props: NavigatorOptions) {\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  const {minWidth, maxWidth, component: NavigatorComponent} = props\n  // eslint-disable-next-line no-eq-null\n  const navigatorDisabled = minWidth != null && maxWidth != null && minWidth === maxWidth\n  return (\n    <>\n      <Panel id=\"navigator\" minWidth={minWidth} maxWidth={maxWidth} order={1}>\n        <NavigatorComponent />\n      </Panel>\n      <PanelResizer order={2} disabled={navigatorDisabled} />\n    </>\n  )\n}\nconst Navigator = memo(NavigatorComponent)\n","import {type FunctionComponent, type PropsWithChildren, useMemo} from 'react'\nimport {PresentationParamsContext} from 'sanity/_singletons'\n\nimport {type PresentationParamsContextValue} from './types'\n\nexport const PresentationParamsProvider: FunctionComponent<\n  PropsWithChildren<{\n    params: PresentationParamsContextValue\n  }>\n> = function (props) {\n  const {children, params} = props\n\n  const context = useMemo<PresentationParamsContextValue>(() => params, [params])\n\n  return (\n    <PresentationParamsContext.Provider value={context}>\n      {children}\n    </PresentationParamsContext.Provider>\n  )\n}\n","import {type FunctionComponent, type PropsWithChildren, useMemo} from 'react'\nimport {PresentationContext} from 'sanity/_singletons'\n\nimport {\n  type PresentationContextValue,\n  type PresentationNavigate,\n  type PresentationParamsContextValue,\n  type PresentationSearchParams,\n  type StructureDocumentPaneParams,\n} from './types'\n\nexport const PresentationProvider: FunctionComponent<\n  PropsWithChildren<{\n    devMode: boolean\n    name: string\n    navigate: PresentationNavigate\n    params: PresentationParamsContextValue\n    searchParams: PresentationSearchParams\n    structureParams: StructureDocumentPaneParams\n  }>\n> = function (props) {\n  const {children, devMode, name, navigate, params, searchParams, structureParams} = props\n\n  const context = useMemo<PresentationContextValue>(\n    () => ({\n      devMode,\n      name,\n      navigate,\n      params,\n      searchParams,\n      structureParams,\n    }),\n    [devMode, name, navigate, params, searchParams, structureParams],\n  )\n\n  return <PresentationContext.Provider value={context}>{children}</PresentationContext.Provider>\n}\n","import {useSelector} from '@xstate/react'\n\nimport {type PreviewUrlRef} from './machines/preview-url'\n\nexport function useAllowPatterns(previewUrlRef: PreviewUrlRef) {\n  const allowPatterns = useSelector(previewUrlRef, (state) => state.context.allowOrigins)\n  if (!Array.isArray(allowPatterns)) {\n    throw new TypeError('allowPatterns must be an array')\n  }\n  return allowPatterns\n}\n","/**\n * When encoding the current studio perspective it's necessary to deal with it sometimes being an array, in a consistent way.\n */\nexport function encodeStudioPerspective(studioPerspective: string[] | string): string {\n  return Array.isArray(studioPerspective) ? studioPerspective.join(',') : studioPerspective\n}\n","import {useId as useReactId} from 'react'\n\nexport function useId(): string {\n  const id = useReactId()\n  // Uses the new format introduced in: https://github.com/facebook/react/pull/32001\n  return id.startsWith(':') ? id.replace(/^:(.+):$/, '\\u00AB$1\\u00BB') : id\n}\n","import {Box} from '@sanity/ui'\nimport {motion, type VariantLabels, type Variants} from 'motion/react'\nimport {forwardRef, type ReactEventHandler, useEffect, useImperativeHandle, useRef} from 'react'\nimport {createGlobalStyle, styled} from 'styled-components'\n\nimport {useId} from '../useId'\n\ninterface IFrameProps {\n  animate: VariantLabels\n  initial: VariantLabels\n  onLoad: ReactEventHandler<HTMLIFrameElement>\n  preventClick: boolean\n  src: string\n  variants: Variants\n  style: React.CSSProperties\n}\n\nexport const IFrame = forwardRef<HTMLIFrameElement, IFrameProps>(\n  function IFrame(props, forwardedRef) {\n    const {animate, initial, onLoad, preventClick, src, variants, style} = props\n\n    const ref = useRef<HTMLIFrameElement | null>(null)\n    // Forward the iframe ref to the parent component\n    useImperativeHandle<HTMLIFrameElement | null, HTMLIFrameElement | null>(\n      forwardedRef,\n      () => ref.current,\n    )\n\n    /**\n     * Ensure that clicking outside of menus and dialogs will close as focus shifts to the iframe\n     */\n\n    useEffect(() => {\n      if (!ref.current) {\n        return undefined\n      }\n      const instance = ref.current\n      function handleBlur() {\n        if (instance !== document.activeElement) {\n          return\n        }\n\n        instance.dispatchEvent(new MouseEvent('mousedown', {bubbles: true, cancelable: true}))\n      }\n      window.addEventListener('blur', handleBlur)\n      return () => {\n        window.removeEventListener('blur', handleBlur)\n      }\n    }, [])\n\n    const viewTransitionName = useId()\n\n    return (\n      <>\n        <IFrameElement\n          style={{\n            ...style,\n            viewTransitionName,\n          }}\n          animate={animate}\n          initial={initial}\n          onLoad={onLoad}\n          ref={ref}\n          src={src}\n          variants={variants}\n        />\n        {preventClick && <IFrameOverlay />}\n        <GlobalViewTransition />\n      </>\n    )\n  },\n)\n\nconst IFrameElement = motion.create(styled.iframe`\n  box-shadow: 0 0 0 1px var(--card-border-color);\n  border: 0;\n  max-height: 100%;\n  width: 100%;\n  view-transition-class: presentation-tool-iframe;\n`)\n\nconst IFrameOverlay = styled(Box)`\n  position: absolute;\n  inset: 0;\n  background: transparent;\n`\n\nconst GlobalViewTransition = createGlobalStyle`\nhtml:active-view-transition-type(sanity-iframe-viewport) {\n  view-transition-name: none;\n  &::view-transition {\n    pointer-events: none;\n  }\n  /* &::view-transition-old(root) {\n    display: none;\n  }\n  &::view-transition-new(root) {\n    animation: none;\n  } */\n}\n`\n","import {LaunchIcon} from '@sanity/icons'\nimport {urlSearchParamPreviewPerspective} from '@sanity/preview-url-secret/constants'\nimport {Text} from '@sanity/ui'\nimport {useCallback, useMemo} from 'react'\nimport {useTranslation} from 'sanity'\n\nimport {Button, Tooltip} from '../../ui-components'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {type PresentationPerspective} from '../types'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\nimport {type PreviewProps} from './Preview'\n\n/** @internal */\nexport function OpenPreviewButton(\n  props: Pick<PreviewProps, 'openPopup'> & {\n    previewLocationOrigin?: string\n    previewLocationRoute: string\n    perspective: PresentationPerspective\n    targetOrigin: string\n  },\n): React.ReactNode {\n  const {openPopup, previewLocationOrigin, previewLocationRoute, perspective, targetOrigin} = props\n\n  const openPreviewLink = useMemo(() => {\n    const url = new URL(previewLocationRoute, previewLocationOrigin || targetOrigin)\n    url.searchParams.set(urlSearchParamPreviewPerspective, encodeStudioPerspective(perspective))\n    const {pathname, search} = url\n\n    return `${previewLocationOrigin}${pathname}${search}`\n  }, [perspective, previewLocationOrigin, previewLocationRoute, targetOrigin])\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n\n  const handleOpenPopup = useCallback(\n    (event: React.MouseEvent<HTMLAnchorElement, MouseEvent>) => {\n      event.preventDefault()\n      openPopup(event.currentTarget.href)\n    },\n    [openPopup],\n  )\n\n  return (\n    <Tooltip\n      animate\n      content={<Text size={1}>{t('share-url.menu-item.open.text')}</Text>}\n      fallbackPlacements={['bottom-start']}\n      placement=\"bottom\"\n      portal\n    >\n      <Button\n        as=\"a\"\n        aria-label={t('share-url.menu-item.open.text')}\n        icon={LaunchIcon}\n        mode=\"bleed\"\n        href={openPreviewLink}\n        rel=\"opener\"\n        target=\"_blank\"\n        tooltipProps={null}\n        // @ts-expect-error the `as=\"a\"` prop isn't enough to change the type of event.target from <div> to <a>\n        onClick={handleOpenPopup}\n      />\n    </Tooltip>\n  )\n}\n","import {useSelector} from '@xstate/react'\n\nimport {type PreviewUrlRef} from './machines/preview-url'\n\nexport function useTargetOrigin(previewUrlRef: PreviewUrlRef): string {\n  const targetOrigin = useSelector(previewUrlRef, (state) => state.context.previewUrl?.origin)\n  if (!targetOrigin) {\n    throw new TypeError('targetOrigin is required')\n  }\n  return targetOrigin\n}\n","import {ResetIcon} from '@sanity/icons'\nimport {TextInput, type TextInputClearButtonProps} from '@sanity/ui'\nimport {\n  type ChangeEvent,\n  type KeyboardEvent,\n  type ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport {useActiveWorkspace, useTranslation} from 'sanity'\n\nimport {presentationLocaleNamespace} from '../i18n'\nimport {type PreviewUrlRef} from '../machines/preview-url'\nimport {useAllowPatterns} from '../useAllowPatterns'\nimport {useTargetOrigin} from '../useTargetOrigin'\n\nexport function PreviewLocationInput(props: {\n  fontSize?: number\n  onChange: (value: string) => void\n  previewUrlRef: PreviewUrlRef\n  padding?: number\n  prefix?: ReactNode\n  suffix?: ReactNode\n  value: string\n}): React.JSX.Element {\n  const {fontSize = 1, onChange, padding = 3, prefix, suffix, value, previewUrlRef} = props\n  const allowOrigins = useAllowPatterns(previewUrlRef)\n  const targetOrigin = useTargetOrigin(previewUrlRef)\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {basePath = '/'} = useActiveWorkspace()?.activeWorkspace || {}\n\n  const inputRef = useRef<HTMLInputElement | null>(null)\n  const [sessionValue, setSessionValue] = useState<string | undefined>(undefined)\n  const [customValidity, setCustomValidity] = useState<string | undefined>(undefined)\n\n  const handleChange = useCallback((event: ChangeEvent<HTMLInputElement>) => {\n    setSessionValue(event.currentTarget.value)\n  }, [])\n\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent<HTMLInputElement>) => {\n      if (event.key === 'Enter') {\n        if (sessionValue === undefined) {\n          return\n        }\n\n        let absoluteValue = sessionValue\n        try {\n          absoluteValue = new URL(sessionValue, targetOrigin).toString()\n        } catch {\n          // ignore\n        }\n\n        if (Array.isArray(allowOrigins)) {\n          if (!allowOrigins.some((pattern) => pattern.test(absoluteValue))) {\n            setCustomValidity(\n              t('preview-location-input.error', {\n                origin: targetOrigin,\n                context: 'origin-not-allowed',\n              }),\n            )\n            event.currentTarget.reportValidity()\n            return\n          }\n          // `origin` is an empty string '' if the Studio is embedded, and that's when we need to protect against recursion\n        } else if (\n          !targetOrigin &&\n          (absoluteValue.startsWith(`${basePath}/`) || absoluteValue === basePath)\n        ) {\n          setCustomValidity(\n            t('preview-location-input.error', {basePath, context: 'same-base-path'}),\n          )\n          return\n        }\n\n        const nextValue = absoluteValue === targetOrigin ? `${targetOrigin}/` : absoluteValue\n\n        setCustomValidity(undefined)\n        setSessionValue(undefined)\n\n        onChange(nextValue)\n\n        inputRef.current?.blur()\n      }\n\n      if (event.key === 'Escape') {\n        setCustomValidity(undefined)\n        setSessionValue(undefined)\n      }\n    },\n    [allowOrigins, basePath, onChange, sessionValue, t, targetOrigin],\n  )\n\n  const handleBlur = useCallback(() => {\n    setCustomValidity(undefined)\n    setSessionValue(undefined)\n  }, [])\n\n  const handleClear = useCallback(() => {\n    setCustomValidity(undefined)\n    let nextValue = value\n    try {\n      nextValue = new URL(value, targetOrigin).toString()\n    } catch {\n      // ignore\n    }\n    setSessionValue(nextValue)\n  }, [targetOrigin, value])\n\n  useEffect(() => {\n    setCustomValidity(undefined)\n    setSessionValue(undefined)\n  }, [targetOrigin, value])\n\n  const resetButton: TextInputClearButtonProps = useMemo(() => ({icon: ResetIcon}), [])\n\n  return (\n    <>\n      <TextInput\n        clearButton={customValidity ? resetButton : undefined}\n        customValidity={customValidity}\n        fontSize={fontSize}\n        onBlur={handleBlur}\n        onClear={handleClear}\n        onChange={handleChange}\n        onKeyDownCapture={handleKeyDown}\n        padding={padding}\n        prefix={prefix}\n        style={{zIndex: 1}}\n        radius={2}\n        ref={inputRef}\n        space={padding}\n        suffix={suffix}\n        value={sessionValue === undefined ? new URL(value, targetOrigin).toString() : sessionValue}\n      />\n    </>\n  )\n}\n","/* eslint-disable @typescript-eslint/no-shadow,no-negated-condition */\nimport {type ClientPerspective, type SyncTag} from '@sanity/client'\nimport {CopyIcon, ShareIcon} from '@sanity/icons'\nimport {SanityMonogram} from '@sanity/logos'\nimport {fetchSharedAccessQuery} from '@sanity/preview-url-secret/constants'\nimport {\n  disablePreviewAccessSharing,\n  enablePreviewAccessSharing,\n} from '@sanity/preview-url-secret/toggle-preview-access-sharing'\nimport {setSecretSearchParams} from '@sanity/preview-url-secret/without-secret-search-params'\nimport {\n  Box,\n  Card,\n  Grid,\n  Menu,\n  MenuDivider,\n  Spinner,\n  Stack,\n  Switch,\n  Text,\n  useToast,\n} from '@sanity/ui'\nimport {AnimatePresence, motion} from 'motion/react'\nimport {lazy, Suspense, useCallback, useEffect, useMemo, useState} from 'react'\nimport {useClient, useCurrentUser, useTranslation} from 'sanity'\nimport {styled} from 'styled-components'\n\nimport {Button, MenuButton, MenuItem, Tooltip} from '../../ui-components'\nimport {API_VERSION} from '../constants'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\nimport {type PreviewProps} from './Preview'\n\nconst QRCodeSVG = lazy(() => import('./QRCodeSVG'))\n\nexport interface SharePreviewMenuProps {\n  canToggleSharePreviewAccess: boolean\n  canUseSharedPreviewAccess: boolean\n  previewLocationRoute: string\n  initialUrl: PreviewProps['initialUrl']\n  perspective: ClientPerspective\n}\n\nconst QrCodeLogoSize = 24\nconst QrCodeLogoPadding = 16\nconst QrSize = 224\n\nconst StyledSanityMonogram = styled(SanityMonogram)`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  height: ${QrCodeLogoSize}px;\n  width: ${QrCodeLogoSize}px;\n`\n\nconst MotionSpinner = motion.create(Spinner)\nconst MotionText = motion.create(Text)\nconst MotionMonogram = motion.create(StyledSanityMonogram)\n\nexport function SharePreviewMenu(props: SharePreviewMenuProps): React.JSX.Element {\n  const {\n    canToggleSharePreviewAccess,\n    canUseSharedPreviewAccess,\n    initialUrl,\n    previewLocationRoute,\n    perspective,\n  } = props\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {push: pushToast} = useToast()\n  const client = useClient({apiVersion: API_VERSION})\n  const currentUser = useCurrentUser()\n  const [loading, setLoading] = useState(true)\n  const [enabling, setEnabling] = useState(false)\n  const [disabling, setDisabling] = useState(false)\n  const [secret, setSecret] = useState<string | null>(null)\n  const busy = enabling || disabling || loading\n  const url = useMemo(\n    () =>\n      secret\n        ? setSecretSearchParams(\n            initialUrl,\n            secret,\n            previewLocationRoute,\n            encodeStudioPerspective(perspective),\n          )\n        : null,\n    [initialUrl, perspective, previewLocationRoute, secret],\n  )\n\n  const [error, setError] = useState<unknown>(null)\n  if (error) {\n    throw error\n  }\n\n  const handleUnableToToggle = useCallback(() => {\n    pushToast({\n      closable: true,\n      status: 'warning',\n      title: t('share-preview-menu.error_toggle-sharing', {context: 'toggle-sharing'}),\n    })\n  }, [pushToast, t])\n\n  const handleDisableSharing = async () => {\n    // Workaround for React Compiler not yet fully supporting try/catch/finally syntax\n    const run = async () => {\n      setDisabling(true)\n      await disablePreviewAccessSharing(\n        client,\n        'sanity/presentation',\n        typeof window === 'undefined' ? '' : location.href,\n        currentUser?.id,\n      )\n      setSecret(null)\n    }\n    try {\n      await run()\n    } catch (error) {\n      setError(error)\n    }\n    setDisabling(false)\n  }\n  const handleEnableSharing = async () => {\n    // Workaround for React Compiler not yet fully supporting try/catch/finally syntax\n    const run = async () => {\n      setEnabling(true)\n\n      const previewUrlSecret = await enablePreviewAccessSharing(\n        client,\n        'sanity/presentation',\n        typeof window === 'undefined' ? '' : location.href,\n        currentUser?.id,\n      )\n      setSecret(previewUrlSecret.secret)\n    }\n    try {\n      await run()\n    } catch (error) {\n      setError(error)\n    }\n    setEnabling(false)\n  }\n\n  const handleCopyUrl = useCallback(async () => {\n    // Workaround for React Compiler not yet fully supporting try/catch/finally syntax\n    const run = async () => {\n      if (!url) {\n        throw new Error('No URL to copy')\n      }\n      await navigator.clipboard.writeText(url.toString())\n      pushToast({\n        closable: true,\n        status: 'success',\n        title: t('share-url.clipboard.status', {context: 'success'}),\n      })\n    }\n    try {\n      await run()\n    } catch (error) {\n      setError(error)\n    }\n  }, [pushToast, t, url])\n\n  useEffect(() => {\n    let controller = new AbortController()\n    let usedTags: SyncTag[] = []\n    async function fetchShareSecret(lastLiveEventId: string | null, signal: AbortSignal) {\n      const {result, syncTags} = await client.fetch<string | null>(\n        fetchSharedAccessQuery,\n        {},\n        {filterResponse: false, lastLiveEventId, tag: 'presentation.fetch-shared-access-secret'},\n      )\n      if (Array.isArray(syncTags)) {\n        usedTags = syncTags\n      }\n      if (!signal.aborted) {\n        setSecret(result)\n      }\n    }\n    const subscription = client.live.events().subscribe({\n      next: (event) => {\n        if (event.type === 'message') {\n          controller.abort()\n          controller = new AbortController()\n          if (event.tags.some((tag) => usedTags.includes(tag))) {\n            void fetchShareSecret(event.id, controller.signal)\n          }\n        }\n      },\n      error: setError,\n    })\n\n    void fetchShareSecret(null, controller.signal).finally(() => setLoading(false))\n\n    return () => {\n      subscription.unsubscribe()\n      controller.abort()\n    }\n  }, [client])\n\n  return (\n    <MenuButton\n      button={\n        <Button\n          aria-label={t('preview-frame.share-button.aria-label')}\n          icon={ShareIcon}\n          mode=\"bleed\"\n          tooltipProps={null}\n        />\n      }\n      id=\"share-menu\"\n      menu={\n        <Menu style={{maxWidth: 248}} padding={canUseSharedPreviewAccess ? undefined : 0}>\n          {canUseSharedPreviewAccess ? (\n            <>\n              <label style={{cursor: 'pointer'}}>\n                <Grid\n                  columns={2}\n                  rows={2}\n                  gapX={3}\n                  gapY={1}\n                  style={{\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    gridTemplateColumns: 'min-content 1fr',\n                    gridTemplateRows: 'min-content',\n                  }}\n                  paddingTop={3}\n                  paddingX={3}\n                >\n                  <Tooltip\n                    animate\n                    content={\n                      <Text size={1}>\n                        {t('share-preview-menu.toggle-button.tooltip', {\n                          context: url ? 'disable' : 'enable',\n                        })}\n                      </Text>\n                    }\n                    fallbackPlacements={['bottom-start']}\n                    placement=\"bottom\"\n                    portal\n                  >\n                    <Switch\n                      checked={enabling || (url !== null && !disabling)}\n                      readOnly={enabling || disabling}\n                      indeterminate={loading}\n                      onChange={\n                        !canToggleSharePreviewAccess\n                          ? handleUnableToToggle\n                          : url\n                            ? handleDisableSharing\n                            : handleEnableSharing\n                      }\n                    />\n                  </Tooltip>\n                  <Text size={1} weight=\"medium\">\n                    {t('share-preview-menu.toggle-button.label', {context: 'first-line'})}\n                  </Text>\n                  <span />\n                  <Text muted size={1}>\n                    {t('share-preview-menu.toggle-button.label', {context: 'second-line'})}\n                  </Text>\n                </Grid>\n              </label>\n              <Box padding={3} paddingTop={2}>\n                <Stack space={3}>\n                  <Card\n                    tone={busy || !url ? 'transparent' : undefined}\n                    style={{\n                      position: 'relative',\n                      aspectRatio: '1 / 1',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                    }}\n                  >\n                    <AnimatePresence>\n                      {busy ? (\n                        <MotionSpinner\n                          muted\n                          initial={{opacity: 0}}\n                          animate={{opacity: 1}}\n                          exit={{opacity: 0}}\n                        />\n                      ) : url ? (\n                        <>\n                          <Suspense fallback={<Spinner />}>\n                            <QRCodeSVG\n                              title={t('share-preview-menu.qr-code.title', {url: url.toString()})}\n                              value={url.toString()}\n                              size={QrSize}\n                              color=\"var(--card-fg-color)\"\n                              logoSize={QrCodeLogoSize + QrCodeLogoPadding}\n                            />\n                            <MotionMonogram\n                              initial={{opacity: -0.5}}\n                              animate={{opacity: 1.5}}\n                              exit={{opacity: 0}}\n                            />\n                          </Suspense>\n                        </>\n                      ) : (\n                        <MotionText\n                          muted\n                          size={1}\n                          style={{maxWidth: '100px', textWrap: 'pretty', textAlign: 'center'}}\n                          initial={{opacity: 0}}\n                          animate={{opacity: 1}}\n                          exit={{opacity: 0}}\n                        >\n                          {t('share-preview-menu.qr-code.placeholder')}\n                        </MotionText>\n                      )}\n                    </AnimatePresence>\n                  </Card>\n                  <Text muted size={1}>\n                    {t('share-preview-menu.qr-code.instructions')}\n                  </Text>\n                </Stack>\n              </Box>\n              <MenuDivider />\n              <MenuItem\n                disabled={!url || disabling}\n                icon={CopyIcon}\n                onClick={handleCopyUrl}\n                text={t('share-preview-menu.copy-url.text')}\n              />\n            </>\n          ) : (\n            <Card padding={2} tone=\"caution\" radius={3}>\n              <Text style={{textWrap: 'pretty'}}>\n                {t('share-preview-menu.error', {context: 'missing-grants'})}\n              </Text>\n            </Card>\n          )}\n        </Menu>\n      }\n      popover={{\n        constrainSize: true,\n        placement: 'bottom',\n        portal: true,\n      }}\n    />\n  )\n}\n","import {DesktopIcon, MobileDeviceIcon, PanelLeftIcon, RefreshIcon} from '@sanity/icons'\nimport {withoutSecretSearchParams} from '@sanity/preview-url-secret/without-secret-search-params'\nimport {Box, Card, Flex, Hotkeys, Switch, Text} from '@sanity/ui'\nimport {useSelector} from '@xstate/react'\nimport {type RefObject, useCallback, useMemo} from 'react'\nimport {useTranslation} from 'sanity'\n\nimport {Button, Tooltip} from '../../ui-components'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {type HeaderOptions} from '../types'\nimport {useId} from '../useId'\nimport {OpenPreviewButton} from './OpenPreviewButton'\nimport {type PreviewProps} from './Preview'\nimport {PreviewLocationInput} from './PreviewLocationInput'\nimport {SharePreviewMenu} from './SharePreviewMenu'\n\n/** @public */\nexport interface PreviewHeaderProps extends PreviewProps {\n  iframeRef: RefObject<HTMLIFrameElement | null>\n  renderDefault: (props: PreviewHeaderProps) => React.JSX.Element\n}\n\nconst PreviewHeaderDefault = (props: Omit<PreviewHeaderProps, 'renderDefault'>) => {\n  const {\n    canSharePreviewAccess,\n    canToggleSharePreviewAccess,\n    canUseSharedPreviewAccess,\n    iframeRef,\n    initialUrl,\n    navigatorEnabled,\n    onPathChange,\n    onRefresh,\n    openPopup,\n    overlaysConnection,\n    presentationRef,\n    perspective,\n    previewUrl,\n    setViewport,\n    targetOrigin,\n    toggleNavigator,\n    toggleOverlay,\n    viewport,\n    previewUrlRef,\n  } = props\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n\n  const toggleViewportSize = useCallback(\n    () => setViewport(viewport === 'desktop' ? 'mobile' : 'desktop'),\n    [setViewport, viewport],\n  )\n\n  const previewLocationOrigin = useMemo(() => {\n    return targetOrigin === location.origin ? '' : targetOrigin\n  }, [targetOrigin])\n\n  const handleRefresh = () => {\n    onRefresh(() => {\n      if (!iframeRef.current) {\n        return\n      }\n      presentationRef.send({type: 'iframe reload'})\n      // Funky way to reload an iframe without CORS issues\n      // ref.current.src = ref.current.src\n      Object.assign(iframeRef.current, {src: `${targetOrigin}${previewUrl || '/'}`})\n    })\n  }\n\n  const isLoading = useSelector(presentationRef, (state) => state.matches('loading'))\n  const isLoaded = useSelector(presentationRef, (state) => state.matches('loaded'))\n  const isRefreshing = useSelector(presentationRef, (state) =>\n    state.matches({loaded: 'refreshing'}),\n  )\n  const isReloading = useSelector(presentationRef, (state) => state.matches({loaded: 'reloading'}))\n  const overlaysEnabled = useSelector(\n    presentationRef,\n    (state) => state.context.visualEditingOverlaysEnabled,\n  )\n\n  const previewLocationRoute = useMemo(() => {\n    const previewURL = new URL(previewUrl || '/', targetOrigin)\n    const {pathname, search} = withoutSecretSearchParams(previewURL)\n\n    return `${pathname}${search}`\n  }, [previewUrl, targetOrigin])\n\n  const perspectiveToggleTooltipId = useId()\n\n  /**\n   * If the preview URL machine is busy it means it's about to change the target origin and reload the iframe,\n   * so we show a spinner\n   */\n  const previewUrlBusy = useSelector(previewUrlRef, (state) => state.hasTag('busy'))\n\n  return (\n    <Flex align=\"center\" gap={1} paddingX={1} style={{width: '100%'}}>\n      {toggleNavigator && (\n        <Button\n          aria-label={t('preview-frame.navigator.toggle-button.aria-label')}\n          icon={PanelLeftIcon}\n          mode=\"bleed\"\n          onClick={toggleNavigator}\n          selected={navigatorEnabled}\n          tooltipProps={{\n            content: <Text size={1}>{t('preview-frame.navigator.toggle-button.tooltip')}</Text>,\n            fallbackPlacements: ['bottom-start'],\n            placement: 'bottom',\n          }}\n        />\n      )}\n\n      <Tooltip\n        animate\n        content={\n          <Flex align=\"center\" style={{whiteSpace: 'nowrap'}}>\n            <Box padding={1}>\n              <Text size={1}>\n                {t('preview-frame.overlay.toggle-button.tooltip', {\n                  context: overlaysEnabled ? 'disable' : 'enable',\n                })}\n              </Text>\n            </Box>\n            <Box paddingY={1}>\n              <Hotkeys keys={['Alt']} style={{marginTop: -4, marginBottom: -4}} />\n            </Box>\n          </Flex>\n        }\n        fallbackPlacements={['bottom-start']}\n        placement=\"bottom\"\n        portal\n      >\n        <Card\n          as=\"label\"\n          flex=\"none\"\n          padding={3}\n          marginX={1}\n          style={{\n            lineHeight: 0,\n            borderRadius: 999,\n            userSelect: 'none',\n          }}\n          tone={overlaysEnabled ? 'transparent' : undefined}\n        >\n          <Flex align=\"center\" gap={3}>\n            <div style={{margin: -4}}>\n              <Switch\n                indeterminate={!isLoaded}\n                checked={overlaysEnabled}\n                onChange={toggleOverlay}\n                disabled={isLoading || overlaysConnection !== 'connected'}\n              />\n            </div>\n            <Box>\n              <Text muted={!overlaysEnabled} size={1} weight=\"medium\">\n                {t('preview-frame.overlay.toggle-button.text')}\n              </Text>\n            </Box>\n          </Flex>\n        </Card>\n      </Tooltip>\n\n      <Box flex={1}>\n        <PreviewLocationInput\n          previewUrlRef={previewUrlRef}\n          prefix={\n            <Box padding={1}>\n              <Tooltip\n                animate\n                content={\n                  <Text size={1}>\n                    {isLoaded\n                      ? t('preview-frame.refresh-button.tooltip')\n                      : t('preview-frame.status', {\n                          context: isLoading\n                            ? 'loading'\n                            : isRefreshing\n                              ? 'refreshing'\n                              : isReloading\n                                ? 'reloading'\n                                : 'unknown',\n                        })}\n                  </Text>\n                }\n                fallbackPlacements={['bottom-end']}\n                placement=\"bottom\"\n                portal\n              >\n                <Button\n                  aria-label={t('preview-frame.refresh-button.aria-label')}\n                  icon={RefreshIcon}\n                  mode=\"bleed\"\n                  loading={isReloading || isRefreshing || previewUrlBusy}\n                  onClick={handleRefresh}\n                  tooltipProps={null}\n                />\n              </Tooltip>\n            </Box>\n          }\n          onChange={onPathChange}\n          suffix={\n            <Box padding={1}>\n              <OpenPreviewButton\n                openPopup={openPopup}\n                previewLocationOrigin={previewLocationOrigin}\n                previewLocationRoute={previewLocationRoute}\n                perspective={perspective}\n                targetOrigin={targetOrigin}\n              />\n            </Box>\n          }\n          value={previewLocationRoute}\n        />\n      </Box>\n\n      <Flex align=\"center\" flex=\"none\" gap={1}>\n        <Tooltip\n          animate\n          ref={(node) => {\n            node?.style.setProperty('view-transition-name', perspectiveToggleTooltipId)\n          }}\n          content={\n            <Text size={1}>\n              {t('preview-frame.viewport-button.tooltip', {\n                context: viewport === 'desktop' ? 'narrow' : 'full',\n              })}\n            </Text>\n          }\n          fallbackPlacements={['bottom-start']}\n          placement=\"bottom\"\n          portal\n        >\n          <Button\n            data-testid=\"preview-viewport-toggle\"\n            data-viewport={viewport}\n            aria-label={t('preview-frame.viewport-button.aria-label')}\n            icon={viewport === 'desktop' ? MobileDeviceIcon : DesktopIcon}\n            mode=\"bleed\"\n            onClick={toggleViewportSize}\n            tooltipProps={null}\n          />\n        </Tooltip>\n      </Flex>\n\n      {canSharePreviewAccess && (\n        <Flex align=\"center\" flex=\"none\" gap={1}>\n          <SharePreviewMenu\n            canToggleSharePreviewAccess={canToggleSharePreviewAccess}\n            canUseSharedPreviewAccess={canUseSharedPreviewAccess}\n            previewLocationRoute={previewLocationRoute}\n            initialUrl={initialUrl}\n            perspective={perspective}\n          />\n        </Flex>\n      )}\n    </Flex>\n  )\n}\n\n/** @internal */\nexport function PreviewHeader(\n  props: Omit<PreviewHeaderProps, 'renderDefault'> & {options?: HeaderOptions},\n): React.JSX.Element {\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  const renderDefault = useCallback((props: Omit<PreviewHeaderProps, 'renderDefault'>) => {\n    return <PreviewHeaderDefault {...props} />\n  }, [])\n\n  const HeaderComponent = props.options?.component\n  const header = HeaderComponent ? (\n    <HeaderComponent {...props} renderDefault={renderDefault} />\n  ) : (\n    renderDefault(props)\n  )\n\n  return (\n    <Card flex=\"none\" padding={2} borderBottom style={{position: 'relative'}}>\n      <Flex align=\"center\" style={{minHeight: 0}}>\n        {header}\n      </Flex>\n    </Card>\n  )\n}\n","/* eslint-disable react/no-unused-prop-types */\nimport {createConnectionMachine, createController} from '@sanity/comlink'\nimport {\n  createCompatibilityActors,\n  type VisualEditingControllerMsg,\n  type VisualEditingNodeMsg,\n} from '@sanity/presentation-comlink'\nimport {\n  urlSearchParamPreviewPerspective,\n  urlSearchParamVercelProtectionBypass,\n  urlSearchParamVercelSetBypassCookie,\n  type VercelSetBypassCookieValue,\n} from '@sanity/preview-url-secret/constants'\nimport {\n  Card,\n  Code,\n  Flex,\n  Label,\n  Spinner,\n  Stack,\n  Text,\n  usePrefersReducedMotion,\n  useToast,\n} from '@sanity/ui'\nimport {useSelector} from '@xstate/react'\nimport {AnimatePresence, motion, MotionConfig} from 'motion/react'\nimport {\n  forwardRef,\n  memo,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n  useSyncExternalStore,\n} from 'react'\nimport {flushSync} from 'react-dom'\nimport {Translate, useTranslation} from 'sanity'\nimport {useEffectEvent} from 'use-effect-event'\n\nimport {Button, TooltipDelayGroupProvider} from '../../ui-components'\nimport {ErrorCard} from '../components/ErrorCard'\nimport {MAX_TIME_TO_OVERLAYS_CONNECTION} from '../constants'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {type PresentationMachineRef} from '../machines/presentation-machine'\nimport {type PreviewUrlRef} from '../machines/preview-url'\nimport {\n  type ConnectionStatus,\n  type HeaderOptions,\n  type PresentationPerspective,\n  type PresentationViewport,\n} from '../types'\nimport {useAllowPatterns} from '../useAllowPatterns'\nimport {usePresentationNavigate} from '../usePresentationNavigate'\nimport {usePresentationTool} from '../usePresentationTool'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\nimport {IFrame} from './IFrame'\nimport {PreviewHeader} from './PreviewHeader'\n\nconst MotionFlex = motion.create(Flex)\n\n/** @public */\nexport interface PreviewProps {\n  canSharePreviewAccess: boolean\n  canToggleSharePreviewAccess: boolean\n  canUseSharedPreviewAccess: boolean\n  header?: HeaderOptions\n  initialUrl: URL\n  loadersConnection: ConnectionStatus\n  navigatorEnabled: boolean\n  onPathChange: (nextPath: string) => void\n  onRefresh: (fallback: () => void) => void\n  openPopup: (url: string) => void\n  overlaysConnection: ConnectionStatus\n  presentationRef: PresentationMachineRef\n  perspective: PresentationPerspective\n  previewUrl?: string\n  setViewport: (mode: 'desktop' | 'mobile') => void\n  targetOrigin: string\n  toggleNavigator?: () => void\n  toggleOverlay: () => void\n  viewport: PresentationViewport\n  vercelProtectionBypass: string | null\n  previewUrlRef: PreviewUrlRef\n}\n\nexport const Preview = memo(\n  forwardRef<HTMLIFrameElement, PreviewProps>(function PreviewComponent(props, forwardedRef) {\n    const {\n      header,\n      initialUrl,\n      loadersConnection,\n      overlaysConnection,\n      perspective,\n      viewport,\n      vercelProtectionBypass,\n      presentationRef,\n      previewUrlRef,\n    } = props\n\n    const [stablePerspective, setStablePerspective] = useState<typeof perspective | null>(null)\n    const urlPerspective = encodeStudioPerspective(\n      stablePerspective === null ? perspective : stablePerspective,\n    )\n    const previewUrl = useMemo(() => {\n      const url = new URL(initialUrl)\n      // Always set the perspective that's being used, even if preview mode isn't configured\n      if (!url.searchParams.get(urlSearchParamPreviewPerspective)) {\n        url.searchParams.set(urlSearchParamPreviewPerspective, urlPerspective)\n      }\n\n      if (vercelProtectionBypass || url.searchParams.get(urlSearchParamVercelProtectionBypass)) {\n        // samesitenone is required since the request is from an iframe\n        url.searchParams.set(\n          urlSearchParamVercelSetBypassCookie,\n          'samesitenone' satisfies VercelSetBypassCookieValue,\n        )\n      }\n      // If there's a vercel protection bypass secret in the context, set it if none exists already\n      if (vercelProtectionBypass && !url.searchParams.get(urlSearchParamVercelProtectionBypass)) {\n        url.searchParams.set(urlSearchParamVercelProtectionBypass, vercelProtectionBypass)\n      }\n\n      return url\n    }, [initialUrl, urlPerspective, vercelProtectionBypass])\n\n    useEffect(() => {\n      /**\n       * If the preview iframe is connected to the loader, we know that switching the perspective can be done without reloading the iframe.\n       */\n      if (loadersConnection === 'connected') {\n        /**\n         * Only set the stable perspective if it hasn't been set yet.\n         */\n        setStablePerspective((prev) => (prev === null ? perspective : prev))\n      }\n    }, [loadersConnection, perspective])\n\n    const {t} = useTranslation(presentationLocaleNamespace)\n    const {devMode} = usePresentationTool()\n    const prefersReducedMotion = usePrefersReducedMotion()\n    const ref = useRef<HTMLIFrameElement | null>(null)\n\n    const previewHeader = <PreviewHeader {...props} iframeRef={ref} options={header} />\n\n    // Forward the iframe ref to the parent component\n    useImperativeHandle<HTMLIFrameElement | null, HTMLIFrameElement | null>(\n      forwardedRef,\n      () => ref.current,\n    )\n\n    const isLoading = useSelector(\n      presentationRef,\n      (state) => state.matches('loading') || state.matches({loaded: 'reloading'}),\n    )\n\n    const [timedOut, setTimedOut] = useState(false)\n    const isRefreshing = useSelector(presentationRef, (state) =>\n      state.matches({loaded: 'refreshing'}),\n    )\n    const [somethingIsWrong, setSomethingIsWrong] = useState(false)\n    const iframeIsBusy = isLoading || isRefreshing || overlaysConnection === 'connecting'\n\n    const handleRetry = useCallback(() => {\n      if (!ref.current) {\n        return\n      }\n\n      ref.current.src = previewUrl.toString()\n\n      presentationRef.send({type: 'iframe reload'})\n    }, [presentationRef, previewUrl])\n\n    const [continueAnyway, setContinueAnyway] = useState(false)\n    const handleContinueAnyway = useCallback(() => {\n      setContinueAnyway(true)\n    }, [])\n    const [showOverlaysConnectionStatus, setShowOverlaysConnectionState] = useState(false)\n    useEffect(() => {\n      if (isLoading || isRefreshing) {\n        return undefined\n      }\n\n      if (overlaysConnection === 'connecting' || overlaysConnection === 'reconnecting') {\n        const timeout = setTimeout(() => {\n          setShowOverlaysConnectionState(true)\n        }, 5_000)\n        return () => clearTimeout(timeout)\n      }\n      return undefined\n    }, [overlaysConnection, isLoading, isRefreshing])\n\n    useEffect(() => {\n      if (isLoading || isRefreshing || !showOverlaysConnectionStatus) {\n        return undefined\n      }\n      if (overlaysConnection === 'connected') {\n        setSomethingIsWrong(false)\n        setShowOverlaysConnectionState(false)\n        setTimedOut(false)\n        setContinueAnyway(false)\n      }\n      if (overlaysConnection === 'connecting') {\n        const timeout = setTimeout(() => {\n          setTimedOut(true)\n          console.error(\n            `Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly`,\n          )\n        }, MAX_TIME_TO_OVERLAYS_CONNECTION)\n        return () => clearTimeout(timeout)\n      }\n      if (overlaysConnection === 'reconnecting') {\n        const timeout = setTimeout(() => {\n          setTimedOut(true)\n          setSomethingIsWrong(true)\n        }, MAX_TIME_TO_OVERLAYS_CONNECTION)\n        return () => clearTimeout(timeout)\n      }\n      return undefined\n    }, [isLoading, overlaysConnection, isRefreshing, showOverlaysConnectionStatus])\n\n    const onIFrameLoad = useCallback(() => {\n      presentationRef.send({type: 'iframe loaded'})\n    }, [presentationRef])\n\n    const preventIframeInteraction = useMemo(() => {\n      return (\n        (isLoading || (overlaysConnection === 'connecting' && !isRefreshing)) && !continueAnyway\n      )\n    }, [continueAnyway, isLoading, isRefreshing, overlaysConnection])\n\n    const canUseViewTransition = useSyncExternalStore(\n      // eslint-disable-next-line no-empty-function\n      useCallback(() => () => {}, []),\n      () => CSS.supports(`(view-transition-name: test)`),\n    )\n    const iframeAnimations = useMemo(() => {\n      return [\n        preventIframeInteraction ? 'background' : 'active',\n        isLoading ? 'reloading' : 'idle',\n        // If CSS View Transitions are supported, then transition iframe viewport dimensions with that instead of Motion\n        canUseViewTransition ? '' : viewport,\n        showOverlaysConnectionStatus && !continueAnyway ? 'timedOut' : '',\n      ]\n    }, [\n      canUseViewTransition,\n      continueAnyway,\n      isLoading,\n      preventIframeInteraction,\n      showOverlaysConnectionStatus,\n      viewport,\n    ])\n\n    const [currentViewport, setCurrentViewport] = useState(viewport)\n    const [iframeStyle, setIframeStyle] = useState(iframeVariants[viewport])\n    useEffect(() => {\n      if (canUseViewTransition && viewport !== currentViewport) {\n        const update = () => {\n          setCurrentViewport(viewport)\n          setIframeStyle(iframeVariants[viewport])\n        }\n        if (\n          !prefersReducedMotion &&\n          'startViewTransition' in document &&\n          typeof document.startViewTransition === 'function'\n        ) {\n          document.startViewTransition({\n            update: () => flushSync(() => update()),\n            types: ['sanity-iframe-viewport'],\n          })\n        } else {\n          update()\n        }\n      }\n    }, [canUseViewTransition, prefersReducedMotion, currentViewport, viewport])\n\n    const toast = useToast()\n    const allowOrigins = useAllowPatterns(previewUrlRef)\n    const [checkOrigin, setCheckOrigin] = useState<false | string>(false)\n    const [reportedMismatches] = useState(new Set<string>())\n    const reportMismatchingOrigin = useEffectEvent((reportedOrigin: string) => {\n      if (allowOrigins.some((allow) => allow.test(reportedOrigin))) {\n        setCheckOrigin(reportedOrigin)\n        return\n      }\n      if (reportedMismatches.has(reportedOrigin)) return\n      reportedMismatches.add(reportedOrigin)\n      console.warn('Visual Editing is here but misconfigured', {reportedOrigin})\n      toast.push({\n        closable: true,\n        id: `presentation-iframe-origin-mismatch-${reportedOrigin}`,\n        status: 'error',\n        duration: Infinity,\n        title: t('preview-frame.configuration.error.title'),\n        description: (\n          <Translate\n            t={t}\n            i18nKey=\"preview-frame.configuration.error.description\"\n            components={{Code: 'code'}}\n            values={{\n              targetOrigin: previewUrl.origin,\n              reportedOrigin,\n            }}\n          />\n        ),\n      })\n    })\n    const navigate = usePresentationNavigate()\n    const navigateEvent = useEffectEvent((url: string) => {\n      if (!checkOrigin) return\n      const nextUrl = new URL(url, checkOrigin)\n      navigate(`${checkOrigin}${nextUrl.pathname}${nextUrl.search}${nextUrl.hash}`)\n    })\n    useEffect(() => {\n      if (!checkOrigin) {\n        return undefined\n      }\n      const target = ref.current?.contentWindow\n      if (!target) {\n        return undefined\n      }\n      const controller = createController({targetOrigin: checkOrigin})\n      controller.addTarget(target)\n      const comlink = controller.createChannel<VisualEditingControllerMsg, VisualEditingNodeMsg>(\n        {\n          name: 'presentation',\n          heartbeat: true,\n          connectTo: 'visual-editing',\n        },\n        createConnectionMachine<VisualEditingControllerMsg, VisualEditingNodeMsg>().provide({\n          actors: createCompatibilityActors<VisualEditingControllerMsg>(),\n        }),\n      )\n\n      comlink.on('visual-editing/navigate', (data) => {\n        navigateEvent(data.url)\n      })\n      const stop = comlink.start()\n\n      return () => {\n        stop()\n        controller.destroy()\n      }\n    }, [checkOrigin])\n    useEffect(() => {\n      if (overlaysConnection === 'connecting' || overlaysConnection === 'reconnecting') {\n        const interval = setInterval(() => {\n          ref.current?.contentWindow?.postMessage(\n            {domain: 'sanity/channels', from: 'presentation', type: 'presentation/status'},\n            /**\n             * The targetOrigin is set to '*' intentionally here, as we need to find out if the iframe is misconfigured and has the wrong origin\n             */\n            '*',\n          )\n        }, 1_000)\n\n        const controller = new AbortController()\n        window.addEventListener(\n          'message',\n          ({data}: MessageEvent<unknown>) => {\n            /**\n             * Listen for replies to presentation/status\n             */\n            if (\n              data &&\n              typeof data === 'object' &&\n              'domain' in data &&\n              data.domain === 'sanity/channels' &&\n              'type' in data &&\n              data.type === 'visual-editing/status' &&\n              'data' in data &&\n              typeof data.data === 'object' &&\n              data.data &&\n              'origin' in data.data &&\n              typeof data.data.origin === 'string'\n            ) {\n              reportMismatchingOrigin(data.data.origin)\n            }\n          },\n          {signal: controller.signal},\n        )\n\n        return () => {\n          controller.abort()\n          clearInterval(interval)\n        }\n      }\n      return undefined\n    }, [overlaysConnection, timedOut])\n\n    return (\n      <MotionConfig transition={prefersReducedMotion ? {duration: 0} : undefined}>\n        <TooltipDelayGroupProvider>\n          {previewHeader}\n          <Card flex={1} tone=\"transparent\">\n            <Flex\n              align=\"center\"\n              height=\"fill\"\n              justify=\"center\"\n              padding={(canUseViewTransition ? currentViewport : viewport) === 'desktop' ? 0 : 2}\n              sizing=\"border\"\n              style={{\n                position: 'relative',\n                cursor: iframeIsBusy ? 'wait' : undefined,\n              }}\n            >\n              <AnimatePresence>\n                {!somethingIsWrong &&\n                !isLoading &&\n                !isRefreshing &&\n                // viewport, // using CSS View Transitions instead of framer motion to drive this\n                showOverlaysConnectionStatus &&\n                !continueAnyway ? (\n                  <MotionFlex\n                    initial=\"initial\"\n                    animate=\"animate\"\n                    exit=\"exit\"\n                    variants={spinnerVariants}\n                    justify=\"center\"\n                    align=\"center\"\n                    style={{\n                      inset: '0',\n                      position: 'absolute',\n                      backdropFilter: timedOut\n                        ? 'blur(16px) saturate(0.5) grayscale(0.5)'\n                        : 'blur(2px)',\n                      ['transition' as string]: 'backdrop-filter 0.2s ease-in-out',\n                      // @TODO Because of Safari we have to do this\n                      WebkitBackdropFilter: timedOut\n                        ? 'blur(16px) saturate(0.5) grayscale(0.5)'\n                        : 'blur(2px)',\n                      WebkitTransition: '-webkit-backdrop-filter 0.2s ease-in-out',\n                      zIndex: 1,\n                    }}\n                  >\n                    <Flex\n                      style={{...sizes[viewport]}}\n                      justify=\"center\"\n                      align=\"center\"\n                      direction=\"column\"\n                      gap={4}\n                    >\n                      {timedOut && (\n                        <Button\n                          disabled\n                          mode=\"ghost\"\n                          text={t('preview-frame.continue-button.text')}\n                          style={{opacity: 0}}\n                        />\n                      )}\n                      <Card\n                        radius={2}\n                        tone={timedOut ? 'caution' : 'inherit'}\n                        padding={4}\n                        shadow={1}\n                      >\n                        <Flex justify=\"center\" align=\"center\" direction=\"column\" gap={4}>\n                          <Spinner muted />\n                          <Text muted size={1}>\n                            {timedOut\n                              ? t('preview-frame.status', {context: 'timeout'})\n                              : t('preview-frame.status', {context: 'connecting'})}\n                          </Text>\n                        </Flex>\n                      </Card>\n                      {timedOut && (\n                        <Button\n                          // mode=\"ghost\"\n                          tone=\"critical\"\n                          onClick={handleContinueAnyway}\n                          text={t('preview-frame.continue-button.text')}\n                        />\n                      )}\n                    </Flex>\n                  </MotionFlex>\n                ) : (isLoading || (overlaysConnection === 'connecting' && !isRefreshing)) &&\n                  !continueAnyway ? (\n                  <MotionFlex\n                    initial=\"initial\"\n                    animate=\"animate\"\n                    exit=\"exit\"\n                    variants={spinnerVariants}\n                    justify=\"center\"\n                    align=\"center\"\n                    style={{\n                      inset: '0',\n                      position: 'absolute',\n                      // boxShadow: '0 0 0 1px var(--card-shadow-outline-color)',\n                    }}\n                  >\n                    <Flex\n                      style={{...sizes[viewport]}}\n                      justify=\"center\"\n                      align=\"center\"\n                      direction=\"column\"\n                      gap={4}\n                    >\n                      <Spinner muted />\n                      <Text muted size={1}>\n                        {t('preview-frame.status', {context: 'loading'})}\n                      </Text>\n                    </Flex>\n                  </MotionFlex>\n                ) : somethingIsWrong && !continueAnyway ? (\n                  <MotionFlex\n                    initial=\"initial\"\n                    animate=\"animate\"\n                    exit=\"exit\"\n                    variants={errorVariants}\n                    justify=\"center\"\n                    align=\"center\"\n                    style={{\n                      background: 'var(--card-bg-color)',\n                      inset: '0',\n                      position: 'absolute',\n                    }}\n                  >\n                    <ErrorCard\n                      flex={1}\n                      message={t('preview-frame.connection.error.text')}\n                      onRetry={handleRetry}\n                      onContinueAnyway={handleContinueAnyway}\n                    >\n                      {devMode && (\n                        <>\n                          {overlaysConnection !== 'connected' && (\n                            <Card padding={3} radius={2} tone=\"critical\">\n                              <Stack space={3}>\n                                <Label muted size={0}>\n                                  {t('preview-frame.overlay.connection-status.label')}\n                                </Label>\n                                <Code size={1}>\n                                  {t('channel.status', {context: overlaysConnection})}\n                                </Code>\n                              </Stack>\n                            </Card>\n                          )}\n\n                          {loadersConnection !== 'connected' && (\n                            <Card padding={3} radius={2} tone=\"critical\">\n                              <Stack space={3}>\n                                <Label muted size={0}>\n                                  {t('preview-frame.loader.connection-status.label')}\n                                </Label>\n                                <Code size={1}>\n                                  {t('channel.status', {context: loadersConnection})}\n                                </Code>\n                              </Stack>\n                            </Card>\n                          )}\n                        </>\n                      )}\n                    </ErrorCard>\n                  </MotionFlex>\n                ) : null}\n              </AnimatePresence>\n              <IFrame\n                animate={iframeAnimations}\n                initial={['background']}\n                onLoad={onIFrameLoad}\n                preventClick={preventIframeInteraction}\n                ref={ref}\n                src={previewUrl.toString()}\n                style={iframeStyle}\n                variants={iframeVariants}\n              />\n            </Flex>\n          </Card>\n        </TooltipDelayGroupProvider>\n      </MotionConfig>\n    )\n  }),\n)\nPreview.displayName = 'Memo(ForwardRef(Preview))'\n\nconst sizes = {\n  desktop: {\n    width: '100%',\n    height: '100%',\n  },\n  mobile: {\n    width: 375,\n    height: 650,\n  },\n}\n\nconst spinnerVariants = {\n  initial: {opacity: 1},\n  animate: {opacity: [0, 0, 1]},\n  exit: {opacity: [1, 0, 0]},\n}\n\nconst errorVariants = {\n  initial: {opacity: 1},\n  animate: {opacity: [0, 0, 1]},\n  exit: {opacity: [1, 0, 0]},\n}\n\nconst iframeVariants = {\n  desktop: {\n    ...sizes.desktop,\n    boxShadow: '0 0 0 0px var(--card-border-color)',\n  },\n  mobile: {\n    ...sizes.mobile,\n    boxShadow: '0 0 0 1px var(--card-border-color)',\n  },\n  background: {\n    opacity: 0,\n    scale: 1,\n  },\n  idle: {\n    scale: 1,\n  },\n  reloading: {\n    scale: [1, 1, 1, 0.98],\n  },\n  active: {\n    opacity: [0, 0, 1],\n    scale: 1,\n  },\n  timedOut: {\n    opacity: [0, 0, 1],\n  },\n}\n","/** @internal */\nexport function defineWarnOnce() {\n  let warned = false\n  // oxlint-disable-next-line no-explicit-any\n  return (...args: any[]): void => {\n    if (!warned) {\n      console.warn(...args)\n      warned = true\n    }\n  }\n}\n","import {validateApiPerspective} from '@sanity/client'\nimport isEqual from 'fast-deep-equal'\nimport {type MutableRefObject, useCallback, useMemo, useRef, useState} from 'react'\n\nimport {type FrameState, type PresentationPerspective} from './types'\nimport {defineWarnOnce} from './util/warnOnce'\n\nexport type DocumentOnPage = {\n  _id: string\n  _type: string\n}\n\ntype DocumentCache = Record<string, DocumentOnPage>\ntype KeyedDocumentCache = Record<string, DocumentCache>\n\nconst warnOnceAboutCrossDatasetReference = defineWarnOnce()\n\n/**\n * @TODO should be refactored to an lru-cache that is keyed by the perspective, which could be an array (if it is, it should use consistent sorting),\n *       and the url path (optionally the origin too), so that swapping between perspectives and urls is fast.\n */\nexport function useDocumentsOnPage(\n  perspective: PresentationPerspective,\n  frameStateRef: MutableRefObject<FrameState>,\n): [\n  DocumentOnPage[],\n  (key: string, perspective: PresentationPerspective, state: DocumentOnPage[]) => void,\n] {\n  validateApiPerspective(perspective)\n\n  const [published, setPublished] = useState<KeyedDocumentCache>({})\n  const [previewDrafts, setPreviewDrafts] = useState<KeyedDocumentCache>({})\n\n  // Used to compare the frame url with its value when the cache was last updated\n  // If the url has changed, the entire cache is replaced\n  const urlRef = useRef<string | undefined>('')\n\n  const setDocumentsOnPage = useCallback(\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    (key: string, perspective: PresentationPerspective, sourceDocuments: DocumentOnPage[] = []) => {\n      const documents = sourceDocuments.filter((sourceDocument) => {\n        if ('_projectId' in sourceDocument && sourceDocument._projectId) {\n          // @TODO Handle cross dataset references\n\n          warnOnceAboutCrossDatasetReference(\n            'Cross dataset references are not supported yet, ignoring source document',\n            sourceDocument,\n          )\n          return false\n        }\n        return sourceDocument\n      })\n\n      const setCache = perspective === 'published' ? setPublished : setPreviewDrafts\n\n      setCache((cache) => {\n        // Create the `next` documents, dedupe by `_id`\n        const next: Record<string, DocumentOnPage> = {}\n        for (const document of documents) {\n          next[document._id] = document\n        }\n\n        // If the frame url has changed, replace the entire cache with the next documents\n        if (urlRef.current !== frameStateRef.current.url) {\n          urlRef.current = frameStateRef.current.url\n          return {[key]: next}\n        }\n\n        // If the keyed cache has changed, return the entire cache and replace the keyed part\n        const prev = cache[key]\n        if (!isEqual(prev, next)) {\n          return {...cache, [key]: next}\n        }\n\n        // Otherwise return the entire cache as is\n        return cache\n      })\n    },\n    [frameStateRef],\n  )\n\n  const documentsOnPage = useMemo(() => {\n    const keyedCache = perspective === 'published' ? published : previewDrafts\n    const uniqueDocuments = Object.values(keyedCache).reduce((acc, cache) => {\n      Object.values(cache).forEach((doc) => {\n        acc[doc._id] = doc\n      })\n      return acc\n    }, {})\n\n    return Object.values(uniqueDocuments)\n  }, [perspective, previewDrafts, published])\n\n  return [documentsOnPage, setDocumentsOnPage]\n}\n","import {type ResponseQueryOptions} from '@sanity/client'\nimport {match, type Path} from 'path-to-regexp'\nimport {useEffect, useRef, useState} from 'react'\nimport {useClient} from 'sanity'\nimport {type RouterState, useRouter} from 'sanity/router'\nimport {useEffectEvent} from 'use-effect-event'\n\nimport {API_VERSION} from './constants'\nimport {\n  type DocumentResolver,\n  type DocumentResolverContext,\n  type MainDocument,\n  type MainDocumentState,\n  type PresentationNavigate,\n  type PresentationPerspective,\n} from './types'\n\n// Helper function to \"unwrap\" a result when it is either explicitly provided or\n// returned as the result of a passed function\nfunction fnOrObj<T, U>(arg: T | ((ctx: U) => T), context: U): T {\n  return arg instanceof Function ? arg(context) : arg\n}\n\nfunction getQueryFromResult(\n  resolver: DocumentResolver,\n  context: DocumentResolverContext,\n): string | undefined {\n  if (resolver.resolve) {\n    const filter = resolver.resolve(context)?.filter\n    return filter\n      ? `// groq\n*[${filter}][0]{_id, _type}`\n      : undefined\n  }\n\n  if ('type' in resolver) {\n    return `// groq\n*[_type == \"${resolver.type}\"][0]{_id, _type}`\n  }\n\n  return `// groq\n*[${fnOrObj(resolver.filter, context)}][0]{_id, _type}`\n}\n\nfunction getParamsFromResult(\n  resolver: DocumentResolver,\n  context: DocumentResolverContext,\n): Record<string, string> {\n  if (resolver.resolve) {\n    return resolver.resolve(context)?.params ?? context.params\n  }\n\n  if ('type' in resolver) {\n    return {}\n  }\n\n  return fnOrObj(resolver.params, context) ?? context.params\n}\n\nexport function getRouteContext(route: Path, url: URL): DocumentResolverContext | undefined {\n  const routes = Array.isArray(route) ? route : [route]\n\n  for (route of routes) {\n    let {origin} = url\n    let path = route\n\n    // Handle absolute URLs\n    if (typeof route === 'string') {\n      try {\n        const absolute = new URL(route)\n\n        // If we are dealing with an absolute URL, ensure the origins match\n        if (absolute.origin !== origin) continue\n\n        origin = absolute.origin\n        path = absolute.pathname\n      } catch {\n        // Ignore, as we assume a relative path\n      }\n    }\n\n    try {\n      const matcher = match<Record<string, string>>(path, {decode: decodeURIComponent})\n      const result = matcher(url.pathname)\n      if (result) {\n        // eslint-disable-next-line @typescript-eslint/no-shadow\n        const {params, path} = result\n        return {origin, params, path}\n      }\n    } catch (e) {\n      throw new Error(`\"${route}\" is not a valid route pattern`, {cause: e})\n    }\n  }\n  return undefined\n}\n\nexport function useMainDocument(props: {\n  navigate?: PresentationNavigate\n  navigationHistory: RouterState[]\n  path?: string\n  targetOrigin: string\n  resolvers?: DocumentResolver[]\n  perspective: PresentationPerspective\n}): MainDocumentState | undefined {\n  const {navigate, navigationHistory, path, targetOrigin, resolvers = [], perspective} = props\n  const {state: routerState} = useRouter()\n  const client = useClient({apiVersion: API_VERSION})\n  const relativeUrl =\n    path || routerState._searchParams?.find(([key]) => key === 'preview')?.[1] || ''\n\n  const [mainDocumentState, setMainDocumentState] = useState<MainDocumentState | undefined>(\n    undefined,\n  )\n  const mainDocumentIdRef = useRef<string | undefined>(undefined)\n\n  const handleResponse = useEffectEvent((doc: MainDocument | undefined, url: URL) => {\n    if (!doc || mainDocumentIdRef.current !== doc._id) {\n      setMainDocumentState({\n        document: doc,\n        path: url.pathname,\n      })\n      mainDocumentIdRef.current = doc?._id\n\n      // We only want to force a navigation to the main document if\n      // the path changed but the document ID did not. An explicit\n      // document navigation should take precedence over displaying\n      // the main document. We determine if an explicit document\n      // navigation has occured by comparing the IDs of the last two\n      // resultant navigation states.\n      if (navigationHistory.at(-1)?.id === navigationHistory.at(-2)?.id) {\n        navigate?.({\n          state: {\n            id: doc?._id,\n            type: doc?._type,\n          },\n        })\n      }\n    }\n  })\n\n  useEffect(() => {\n    const url = new URL(relativeUrl, targetOrigin)\n\n    if (resolvers.length) {\n      let result:\n        | {\n            context: DocumentResolverContext\n            resolver: DocumentResolver\n          }\n        | undefined\n      for (const resolver of resolvers) {\n        const context = getRouteContext(resolver.route, url)\n        if (context) {\n          result = {context, resolver}\n          break\n        }\n      }\n\n      if (result) {\n        const query = getQueryFromResult(result.resolver, result.context)\n        const params = getParamsFromResult(result.resolver, result.context)\n        if (query) {\n          const controller = new AbortController()\n          const options: ResponseQueryOptions = {\n            perspective: perspective,\n            signal: controller.signal,\n            tag: 'use-main-document',\n          }\n\n          client\n            .fetch<MainDocument | undefined>(query, params, options)\n            .then((doc) => handleResponse(doc, url))\n            .catch((e) => {\n              if (e instanceof Error && e.name === 'AbortError') return\n              setMainDocumentState({document: undefined, path: url.pathname})\n              mainDocumentIdRef.current = undefined\n            })\n          return () => {\n            controller.abort()\n          }\n        }\n      }\n    }\n    setMainDocumentState(undefined)\n    mainDocumentIdRef.current = undefined\n    return undefined\n  }, [client, perspective, relativeUrl, resolvers, targetOrigin])\n\n  return mainDocumentState\n}\n","import {studioPath} from '@sanity/client/csm'\nimport {urlStringToPath} from '@sanity/visual-editing-csm'\n\nimport {type PresentationStateParams} from '../types'\n\nexport function parseId(rawId: string | undefined): string | undefined {\n  if (rawId === undefined) {\n    return undefined\n  }\n\n  const segments = decodeURIComponent(rawId)?.split('.')\n\n  if (segments[0] === 'drafts') {\n    segments.shift()\n  }\n\n  return segments.join('.')\n}\n\nexport function parsePath(rawPath: string | undefined): string | undefined {\n  if (rawPath === undefined) {\n    return undefined\n  }\n\n  return studioPath.toString(urlStringToPath(decodeURIComponent(rawPath)))\n}\n\nexport function parseRouterState(state: PresentationStateParams): PresentationStateParams {\n  return {\n    id: parseId(state.id),\n    path: parsePath(state.path),\n    type: state.type,\n  }\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\nimport {type MutableRefObject, useCallback, useLayoutEffect, useMemo, useRef, useState} from 'react'\nimport {getPublishedId} from 'sanity'\nimport {type RouterContextValue, type RouterState, type SearchParam} from 'sanity/router'\n\nimport {\n  type CombinedSearchParams,\n  type FrameState,\n  type PresentationNavigate,\n  type PresentationParamsContextValue,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from './types'\nimport {parseRouterState} from './util/parse'\n\nfunction pruneObject<T extends RouterState | PresentationParamsContextValue>(obj: T): T {\n  return Object.fromEntries(\n    Object.entries(obj).filter(\n      ([, value]) => value !== undefined && value !== '' && value !== null,\n    ),\n  ) as T\n}\n\n/**\n * Ensures the array contains all members of the union T.\n */\nconst exhaustiveTupleOf =\n  <T>() =>\n  <U extends T[]>(array: U & ([T] extends [U[number]] ? unknown : 'Invalid') & {0: T}) =>\n    array\n\nconst maintainOnDocumentChange = exhaustiveTupleOf<keyof PresentationSearchParams>()([\n  'perspective',\n  'preview',\n  'viewport',\n])\n\nconst maintainOnSameDocument = exhaustiveTupleOf<keyof StructureDocumentPaneParams>()([\n  'changesInspectorTab',\n  'comment',\n  'inspect',\n  'instruction',\n  'scheduledDraft',\n  'parentRefPath',\n  'path',\n  'pathKey',\n  'rev',\n  'since',\n  'template',\n  'templateParams',\n  'version',\n  'view',\n])\n\nexport function useParams({\n  initialPreviewUrl,\n  routerNavigate,\n  routerState,\n  routerSearchParams,\n  frameStateRef,\n}: {\n  initialPreviewUrl: URL\n  routerNavigate: RouterContextValue['navigate']\n  routerState: RouterState & PresentationStateParams\n  routerSearchParams: {\n    [k: string]: string\n  }\n  frameStateRef: MutableRefObject<FrameState>\n}): {\n  isSameDocument: (state: PresentationStateParams) => boolean\n  navigate: PresentationNavigate\n  navigationHistory: RouterState[]\n  params: PresentationParamsContextValue\n  searchParams: PresentationSearchParams\n  structureParams: StructureDocumentPaneParams\n} {\n  const params = useMemo<PresentationParamsContextValue>(() => {\n    const {id, path, type} = parseRouterState(routerState)\n\n    return {\n      id,\n      type,\n      path,\n      preview: routerSearchParams.preview || initialPreviewUrl.toString(),\n      perspective: routerSearchParams.perspective,\n      viewport: routerSearchParams.viewport,\n      inspect: routerSearchParams.inspect,\n      scheduledDraft: routerSearchParams.scheduledDraft,\n\n      parentRefPath: routerSearchParams.parentRefPath,\n      rev: routerSearchParams.rev,\n      since: routerSearchParams.since,\n      template: routerSearchParams.template,\n      templateParams: routerSearchParams.templateParams,\n      view: routerSearchParams.view,\n      // assist\n      pathKey: routerSearchParams.pathKey,\n      instruction: routerSearchParams.instruction,\n      // comments\n      comment: routerSearchParams.comment,\n      changesInspectorTab: routerSearchParams.changesInspectorTab as 'history' | 'review',\n    }\n  }, [routerState, routerSearchParams, initialPreviewUrl])\n\n  const structureParams = useMemo<StructureDocumentPaneParams>(() => {\n    const pruned = pruneObject({\n      inspect: params.inspect,\n      scheduledDraft: params.scheduledDraft,\n      path: params.path,\n      parentRefPath: params.parentRefPath,\n      rev: params.rev,\n      since: params.since,\n      template: params.template,\n      templateParams: params.templateParams,\n      view: params.view,\n      // assist\n      pathKey: params.pathKey,\n      instruction: params.instruction,\n      // comments\n      comment: params.comment,\n      changesInspectorTab: params.changesInspectorTab,\n    })\n    return pruned\n  }, [\n    params.changesInspectorTab,\n    params.comment,\n    params.inspect,\n    params.instruction,\n    params.path,\n    params.pathKey,\n    params.parentRefPath,\n    params.rev,\n    params.since,\n    params.template,\n    params.templateParams,\n    params.view,\n    params.scheduledDraft,\n  ])\n\n  const searchParams = useMemo<PresentationSearchParams>(() => {\n    const pruned = pruneObject({\n      perspective: params.perspective,\n      preview: params.preview,\n      viewport: params.viewport,\n    })\n    return pruned\n  }, [params.perspective, params.preview, params.viewport])\n\n  const routerStateRef = useRef(routerState)\n\n  useLayoutEffect(() => {\n    routerStateRef.current = routerState\n  }, [routerState])\n\n  const [navigationHistory, setNavigationHistory] = useState<RouterState[]>([routerState])\n\n  // Helper function to check if a given document is the same as the one in the\n  // current router state\n  const isSameDocument = useCallback(({id, type}: PresentationStateParams) => {\n    const {current} = routerStateRef\n    return id === current.id && type === current.type\n  }, [])\n\n  const navigate = useCallback<PresentationNavigate>(\n    (options) => {\n      const {state, params, replace = false} = options\n\n      // Force navigation to use published IDs only\n      if (state?.id) state.id = getPublishedId(state.id)\n\n      // Get the current state and params\n      const {current} = routerStateRef\n      const currentState = {\n        id: current.id,\n        type: current.type,\n        path: current.path,\n      } satisfies PresentationStateParams\n      const currentParams = Object.fromEntries(current._searchParams || []) as CombinedSearchParams\n\n      // If state is provided, replace the current state with the provided\n      // state, otherwise maintain the current state\n      const nextState = state || currentState\n\n      // Different params need to be maintained under different conditions\n      const maintainedParamKeys = [\n        ...maintainOnDocumentChange,\n        ...(isSameDocument(nextState) ? maintainOnSameDocument : []),\n      ] satisfies (keyof CombinedSearchParams)[]\n\n      const maintainedParams = maintainedParamKeys.reduce((acc, key) => {\n        // @ts-expect-error changesInspectorTab union type doesn't play nicely\n        // here, if it were just a string it would be fine\n        acc[key] = currentParams[key]\n        return acc\n      }, {} as Partial<CombinedSearchParams>)\n\n      // If params are provided, merge them with the maintained params\n      const nextParams = {...maintainedParams, ...params}\n\n      const nextRouterState = {\n        ...nextState,\n        _searchParams: Object.entries(nextParams).reduce(\n          (acc, [key, value]) => [...acc, [key, value] as SearchParam],\n          [] as SearchParam[],\n        ),\n      } satisfies RouterState\n\n      setNavigationHistory((prev) => [...prev, nextRouterState])\n      routerNavigate(nextRouterState, {replace})\n    },\n    [isSameDocument, routerNavigate],\n  )\n\n  return {\n    isSameDocument,\n    navigate,\n    navigationHistory,\n    params,\n    searchParams,\n    structureParams,\n  }\n}\n","import {type Controller} from '@sanity/comlink'\nimport {useCallback, useEffect, useState} from 'react'\n\nimport {POPUP_CHECK_INTERVAL} from './constants'\n\n/**\n * A hook for managing popup Window contexts\n *\n * This hook handles:\n * - Opening new popup Windows, and adding them as targets to the controller\n * - Tracking existing popup windows, and cleaning up closed popups\n *\n * @param controller - Comlink controller instance that manages communication\n * between Window contexts\n *\n * @returns An object containing:\n * - popups: A Set of currently open popup Window objects\n * - open: Function to open a new popup Window with the specified URL\n *\n */\nexport const usePopups = (\n  controller?: Controller,\n): {\n  popups: Set<Window>\n  open: (url: string) => void\n} => {\n  // State to keep track of open popup windows\n  const [popups, setPopups] = useState<Set<Window>>(() => new Set())\n\n  // Function to open a new popup window\n  const open = useCallback((url: string) => {\n    const source = window.open(url, '_blank')\n    if (source) {\n      setPopups((prev) => new Set(prev).add(source))\n    }\n  }, [])\n\n  // Handles syncing the existing popups with the controller\n  useEffect(() => {\n    const unsubs: Array<() => void> = []\n    if (popups.size && controller) {\n      // loop popups and add targets\n      for (const source of popups) {\n        if (source && 'closed' in source && !source.closed) {\n          unsubs.push(controller.addTarget(source))\n        }\n      }\n    }\n    return () => {\n      unsubs.forEach((unsub) => unsub())\n    }\n  }, [controller, popups])\n\n  // Checks for closed popups and removes them from the tracked Set\n  useEffect(() => {\n    if (popups.size) {\n      const interval = setInterval(() => {\n        const closed = new Set<Window>()\n        for (const source of popups) {\n          if (source && 'closed' in source && source.closed) {\n            closed.add(source)\n          }\n        }\n        if (closed.size) {\n          setPopups((prev) => {\n            const next = new Set(prev)\n            for (const source of closed) {\n              next.delete(source)\n            }\n            return next\n          })\n        }\n      }, POPUP_CHECK_INTERVAL)\n\n      return () => {\n        clearInterval(interval)\n      }\n    }\n    return undefined\n  }, [popups])\n\n  return {popups, open}\n}\n","import {usePerspective} from 'sanity'\n\nimport {type PresentationPerspective} from './types'\n\n/**\n * @internal\n */\nexport function usePresentationPerspective({\n  scheduledDraft,\n}: {\n  scheduledDraft: string | undefined\n}): PresentationPerspective {\n  const {selectedPerspectiveName = 'drafts', selectedReleaseId, perspectiveStack} = usePerspective()\n\n  const perspective = (\n    selectedReleaseId || scheduledDraft\n      ? [scheduledDraft, ...perspectiveStack]\n      : selectedPerspectiveName\n  ) as PresentationPerspective\n  return perspective\n}\n","import {type StatusEvent} from '@sanity/comlink'\nimport {useCallback, useMemo, useState} from 'react'\n\nimport {type ConnectionStatus} from './types'\n\n/**\n * A hook that manages and returns the connection status of multiple channels\n *\n * returns an array containing the\n * current status and a function to update the status based on incoming events\n *\n * The status can be one of the following:\n * - 'connected': If any channel is connected\n * - 'connecting': If the first connection is being established\n * - 'reconnecting': If a reconnection is in progress\n * - 'idle': If no connections have been made yet\n *\n * The function to update the status takes a `StatusEvent` object which includes\n * the channel and the status\n */\nexport function useStatus(): [ConnectionStatus, (event: StatusEvent) => void] {\n  // State to keep track of the status of each channel\n  const [statusMap, setStatusMap] = useState(\n    new Map<string, {status: ConnectionStatus; hasConnected: boolean}>(),\n  )\n\n  // Memoized computation of the overall status based on the status of individual channels\n  const memoStatus = useMemo(() => {\n    const values = Array.from(statusMap.values())\n    // If any channel is connected, return the `connected` status\n    if (values.find(({status}) => status === 'connected')) {\n      return 'connected'\n    }\n    // If the initial connection is being established, return `connecting` status\n    const handshaking = values.filter(({status}) => status === 'connecting')\n    if (handshaking.length) {\n      return handshaking.some(({hasConnected}) => !hasConnected) ? 'connecting' : 'reconnecting'\n    }\n    // If nothing has happened yet, return `idle` status\n    return 'idle'\n  }, [statusMap])\n\n  // Callback to update the status map based on the received event\n  const setStatusFromEvent = useCallback((event: StatusEvent) => {\n    setStatusMap((prev) => {\n      const next = new Map(prev)\n      if (event.status === 'disconnected') {\n        // Remove the channel from the map if a disconnect event is received\n        next.delete(event.connection)\n      } else {\n        // Update the status and connection flag for the channel\n        const hasConnected =\n          next.get(event.connection)?.hasConnected || event.status === 'connected'\n        const status = event.status === 'handshaking' ? 'connecting' : event.status\n        next.set(event.connection, {status, hasConnected})\n      }\n      return next\n    })\n  }, [])\n\n  // Return the overall status and the function to update the status\n  return [memoStatus, setStatusFromEvent]\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\nimport {\n  type Controller,\n  createConnectionMachine,\n  createController,\n  type Message,\n} from '@sanity/comlink'\nimport {\n  createCompatibilityActors,\n  type PreviewKitNodeMsg,\n  type VisualEditingControllerMsg,\n  type VisualEditingNodeMsg,\n} from '@sanity/presentation-comlink'\nimport {\n  urlSearchParamVercelProtectionBypass,\n  urlSearchParamVercelSetBypassCookie,\n} from '@sanity/preview-url-secret/constants'\nimport {BoundaryElementProvider, Flex} from '@sanity/ui'\nimport {useActorRef, useSelector} from '@xstate/react'\nimport {lazy, Suspense, useCallback, useEffect, useMemo, useRef, useState} from 'react'\nimport {\n  type CommentIntentGetter,\n  COMMENTS_INSPECTOR_NAME,\n  type SanityDocument,\n  type Tool,\n  useDataset,\n  useProjectId,\n  useUnique,\n  useWorkspace,\n} from 'sanity'\nimport {type RouterContextValue, useRouter} from 'sanity/router'\nimport {styled} from 'styled-components'\nimport {useEffectEvent} from 'use-effect-event'\n\nimport {DEFAULT_TOOL_NAME, EDIT_INTENT_MODE} from './constants'\nimport PostMessageFeatures from './features/PostMessageFeatures'\nimport {presentationMachine} from './machines/presentation-machine'\nimport {type PreviewUrlRef} from './machines/preview-url'\nimport {SharedStateProvider} from './overlays/SharedStateProvider'\nimport {Panel} from './panels/Panel'\nimport {Panels} from './panels/Panels'\nimport {PresentationContent} from './PresentationContent'\nimport {PresentationNavigateProvider} from './PresentationNavigateProvider'\nimport {usePresentationNavigator} from './PresentationNavigator'\nimport {PresentationParamsProvider} from './PresentationParamsProvider'\nimport {PresentationProvider} from './PresentationProvider'\nimport {Preview} from './preview/Preview'\nimport {\n  type FrameState,\n  type PresentationNavigate,\n  type PresentationPluginOptions,\n  type PresentationStateParams,\n  type PresentationViewport,\n  type StructureDocumentPaneParams,\n  type VisualEditingConnection,\n} from './types'\nimport {useAllowPatterns} from './useAllowPatterns'\nimport {useDocumentsOnPage} from './useDocumentsOnPage'\nimport {useMainDocument} from './useMainDocument'\nimport {useParams} from './useParams'\nimport {usePopups} from './usePopups'\nimport {usePresentationPerspective} from './usePresentationPerspective'\nimport {useStatus} from './useStatus'\nimport {useTargetOrigin} from './useTargetOrigin'\nimport {debounce} from './util/debounce'\n\nconst LiveQueries = lazy(() => import('./loader/LiveQueries'))\nconst PostMessageDocuments = lazy(() => import('./overlays/PostMessageDocuments'))\nconst PostMessageRefreshMutations = lazy(() => import('./editor/PostMessageRefreshMutations'))\nconst PostMessagePerspective = lazy(() => import('./PostMessagePerspective'))\nconst PostMessagePreviewSnapshots = lazy(() => import('./editor/PostMessagePreviewSnapshots'))\nconst PostMessageSchema = lazy(() => import('./overlays/schema/PostMessageSchema'))\nconst PostMessageTelemetry = lazy(() => import('./PostMessageTelemetry'))\n\nconst Container = styled(Flex)`\n  overflow-x: auto;\n`\n\nexport default function PresentationTool(props: {\n  tool: Tool<PresentationPluginOptions>\n  canToggleSharePreviewAccess: boolean\n  canUseSharedPreviewAccess: boolean\n  vercelProtectionBypass: string | null\n  initialPreviewUrl: URL\n  previewUrlRef: PreviewUrlRef\n}): React.JSX.Element {\n  const {\n    canToggleSharePreviewAccess,\n    canUseSharedPreviewAccess,\n    tool,\n    vercelProtectionBypass,\n    initialPreviewUrl,\n    previewUrlRef,\n  } = props\n\n  const allowOrigins = useAllowPatterns(previewUrlRef)\n  const targetOrigin = useTargetOrigin(previewUrlRef)\n\n  const components = tool.options?.components\n  const name = tool.name || DEFAULT_TOOL_NAME\n  const {unstable_navigator, unstable_header} = components || {}\n\n  const {navigate: routerNavigate, state: routerState} = useRouter() as RouterContextValue & {\n    state: PresentationStateParams\n  }\n  const routerSearchParams = useUnique(Object.fromEntries(routerState._searchParams || []))\n\n  const canSharePreviewAccess = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewMode?.shareAccess !== false,\n  )\n\n  const [devMode] = useState(() => {\n    const option = tool.options?.devMode\n\n    if (typeof option === 'function') return option()\n    if (typeof option === 'boolean') return option\n\n    return typeof window !== 'undefined' && window.location.hostname === 'localhost'\n  })\n\n  const iframeRef = useRef<HTMLIFrameElement>(null)\n\n  const [controller, setController] = useState<Controller>()\n  const [visualEditingComlink, setVisualEditingComlink] = useState<VisualEditingConnection | null>(\n    null,\n  )\n\n  const frameStateRef = useRef<FrameState>({\n    title: undefined,\n    url: undefined,\n  })\n\n  const {isSameDocument, navigate, navigationHistory, params, searchParams, structureParams} =\n    useParams({\n      initialPreviewUrl,\n      routerNavigate,\n      routerState,\n      routerSearchParams,\n      frameStateRef,\n    })\n  const perspective = usePresentationPerspective({scheduledDraft: params.scheduledDraft})\n\n  const presentationRef = useActorRef(presentationMachine)\n\n  const viewport = useMemo(() => (params.viewport ? 'mobile' : 'desktop'), [params.viewport])\n\n  const [documentsOnPage, setDocumentsOnPage] = useDocumentsOnPage(perspective, frameStateRef)\n\n  const projectId = useProjectId()\n  const dataset = useDataset()\n\n  const mainDocumentState = useMainDocument({\n    navigate,\n    navigationHistory,\n    path: params.preview,\n    targetOrigin,\n    resolvers: tool.options?.resolve?.mainDocuments,\n    perspective,\n  })\n\n  const [overlaysConnection, setOverlaysConnection] = useStatus()\n  const [loadersConnection, setLoadersConnection] = useStatus()\n  const [previewKitConnection, setPreviewKitConnection] = useStatus()\n\n  const {open: handleOpenPopup} = usePopups(controller)\n\n  const isLoading = useSelector(presentationRef, (state) => state.matches('loading'))\n\n  useEffect(() => {\n    const target = iframeRef.current?.contentWindow\n\n    if (!target || isLoading) return undefined\n\n    const controller = createController({targetOrigin})\n    controller.addTarget(target)\n    setController(controller)\n\n    return () => {\n      controller.destroy()\n      setController(undefined)\n    }\n  }, [targetOrigin, isLoading])\n\n  const handleNavigate = useEffectEvent<PresentationNavigate>((options) => {\n    navigate(options)\n  })\n\n  const refreshRef = useRef<number>(undefined)\n\n  useEffect(() => {\n    if (!controller) return undefined\n\n    const comlink = controller.createChannel<VisualEditingControllerMsg, VisualEditingNodeMsg>(\n      {\n        name: 'presentation',\n        heartbeat: true,\n        connectTo: 'visual-editing',\n      },\n      createConnectionMachine<VisualEditingControllerMsg, VisualEditingNodeMsg>().provide({\n        actors: createCompatibilityActors<VisualEditingControllerMsg>(),\n      }),\n    )\n\n    comlink.on('visual-editing/focus', (data) => {\n      if (!('id' in data)) return\n      handleNavigate({\n        state: {\n          type: data.type,\n          id: data.id,\n          path: data.path,\n        },\n      })\n    })\n\n    comlink.on('visual-editing/navigate', (data) => {\n      const {title} = data\n      let url = data.url\n      /**\n       * The URL is relative, we need to resolve it to an absolute URL\n       */\n      if (!url.startsWith('http')) {\n        try {\n          url = new URL(url, targetOrigin).toString()\n        } catch {\n          // ignore\n        }\n      }\n\n      if (frameStateRef.current.url !== url) {\n        // Workaround for React Compiler not yet fully supporting try/catch/finally syntax\n        const run = () => {\n          // Handle bypass params being forwarded to the final URL\n          const [urlWithoutSearch, search] = url.split('?')\n          const searchParams = new URLSearchParams(search)\n          searchParams.delete(urlSearchParamVercelProtectionBypass)\n          searchParams.delete(urlSearchParamVercelSetBypassCookie)\n          handleNavigate({\n            params: {\n              preview: `${urlWithoutSearch}${searchParams.size > 0 ? '?' : ''}${searchParams}`,\n            },\n          })\n        }\n        try {\n          run()\n        } catch {\n          handleNavigate({params: {preview: url}})\n        }\n      }\n      frameStateRef.current = {title, url}\n    })\n\n    comlink.on('visual-editing/meta', (data) => {\n      frameStateRef.current.title = data.title\n    })\n\n    comlink.on('visual-editing/toggle', (data) => {\n      presentationRef.send({type: 'toggle visual editing overlays', enabled: data.enabled})\n    })\n\n    comlink.on('visual-editing/documents', (data) => {\n      setDocumentsOnPage(\n        'visual-editing',\n        // oxlint-disable-next-line no-explicit-any\n        data.perspective as unknown as any,\n        data.documents,\n      )\n    })\n\n    // @todo This won't work for multiple window contexts?\n    comlink.on('visual-editing/refreshing', (data) => {\n      if (data.source === 'manual') {\n        clearTimeout(refreshRef.current)\n      } else if (data.source === 'mutation') {\n        presentationRef.send({type: 'iframe refresh'})\n      }\n    })\n\n    comlink.on('visual-editing/refreshed', () => {\n      presentationRef.send({type: 'iframe loaded'})\n    })\n\n    comlink.onStatus(setOverlaysConnection)\n\n    const stop = comlink.start()\n    setVisualEditingComlink(comlink)\n    return () => {\n      stop()\n      setVisualEditingComlink(null)\n    }\n  }, [controller, presentationRef, setDocumentsOnPage, setOverlaysConnection, targetOrigin])\n\n  useEffect(() => {\n    if (!controller) return undefined\n    const comlink = controller.createChannel<Message, PreviewKitNodeMsg>(\n      {\n        name: 'presentation',\n        connectTo: 'preview-kit',\n        heartbeat: true,\n      },\n      createConnectionMachine<Message, PreviewKitNodeMsg>().provide({\n        actors: createCompatibilityActors(),\n      }),\n    )\n\n    comlink.onStatus(setPreviewKitConnection)\n\n    comlink.on('preview-kit/documents', (data) => {\n      if (data.projectId === projectId && data.dataset === dataset) {\n        setDocumentsOnPage(\n          'preview-kit',\n          // oxlint-disable-next-line no-explicit-any\n          data.perspective as unknown as any,\n          data.documents,\n        )\n      }\n    })\n\n    return comlink.start()\n  }, [controller, dataset, projectId, setDocumentsOnPage, setPreviewKitConnection, targetOrigin])\n\n  const handleFocusPath = useMemo(\n    () =>\n      // When moving from one field to another, blur and focus events will trigger\n      // this handler. We debounce to avoid unwanted intermediate navigations this\n      // would cause.\n      debounce<(state: Required<PresentationStateParams>) => void>((state) => {\n        // We only ever want to update the path if we are still viewing the\n        // document that was active when the focus event was triggered\n        if (isSameDocument(state)) {\n          navigate({\n            state,\n            replace: true,\n          })\n        }\n      }, 0),\n    [isSameDocument, navigate],\n  )\n\n  const handlePreviewPath = useCallback(\n    (nextPath: string) => {\n      const url = new URL(nextPath, targetOrigin)\n      const preview = url.toString()\n      if (params.preview === preview) {\n        return\n      }\n      if (Array.isArray(allowOrigins)) {\n        if (allowOrigins.some((pattern) => pattern.test(preview))) {\n          navigate({params: {preview}})\n        }\n      } else if (url.origin === targetOrigin) {\n        navigate({params: {preview}})\n      }\n    },\n    [targetOrigin, params.preview, allowOrigins, navigate],\n  )\n\n  const handleStructureParams = useCallback(\n    (params: StructureDocumentPaneParams) => {\n      navigate({params})\n    },\n    [navigate],\n  )\n\n  const handleEditReference = useCallback<PresentationNavigate>(\n    (options) => {\n      navigate(options)\n    },\n    [navigate],\n  )\n\n  // Dispatch a focus or blur message when the id or path change\n  useEffect(() => {\n    if (params.id && params.path) {\n      visualEditingComlink?.post('presentation/focus', {id: params.id, path: params.path})\n    } else {\n      visualEditingComlink?.post('presentation/blur')\n    }\n  }, [params.id, params.path, visualEditingComlink])\n\n  // Dispatch a navigation message when the preview param changes\n  useEffect(() => {\n    if (\n      frameStateRef.current.url &&\n      params.preview &&\n      frameStateRef.current.url !== params.preview\n    ) {\n      try {\n        const frameOrigin = new URL(frameStateRef.current.url, targetOrigin).origin\n        const previewOrigin = new URL(params.preview, targetOrigin).origin\n        if (frameOrigin !== previewOrigin) {\n          return\n        }\n      } catch {\n        // ignore\n      }\n\n      frameStateRef.current.url = params.preview\n      if (overlaysConnection === 'connected') {\n        /**\n         * Translate the possibly absolute params url back to a relative URL\n         */\n        let url = params.preview\n        if (url.startsWith('http')) {\n          try {\n            const newUrl = new URL(params.preview, targetOrigin)\n            url = newUrl.pathname + newUrl.search + newUrl.hash\n          } catch {\n            // ignore\n          }\n        }\n        visualEditingComlink?.post('presentation/navigate', {\n          url,\n          type: 'replace',\n        })\n      }\n    }\n  }, [overlaysConnection, targetOrigin, params.preview, visualEditingComlink])\n\n  const toggleOverlay = useCallback(\n    () => visualEditingComlink?.post('presentation/toggle-overlay'),\n    [visualEditingComlink],\n  )\n\n  const [displayedDocument, setDisplayedDocument] = useState<\n    Partial<SanityDocument> | null | undefined\n  >(null)\n\n  useEffect(() => {\n    const handleKeyUp = (e: KeyboardEvent) => {\n      if (isAltKey(e)) {\n        toggleOverlay()\n      }\n    }\n    const handleKeydown = (e: KeyboardEvent) => {\n      if (isAltKey(e)) {\n        toggleOverlay()\n      }\n\n      if (isHotkey(['mod', '\\\\'], e)) {\n        toggleOverlay()\n      }\n    }\n    window.addEventListener('keydown', handleKeydown)\n    window.addEventListener('keyup', handleKeyUp)\n    return () => {\n      window.removeEventListener('keydown', handleKeydown)\n      window.removeEventListener('keyup', handleKeyUp)\n    }\n  }, [toggleOverlay])\n\n  const [boundaryElement, setBoundaryElement] = useState<HTMLDivElement | null>(null)\n\n  const [{navigatorEnabled, toggleNavigator}, PresentationNavigator] = usePresentationNavigator({\n    unstable_navigator,\n  })\n\n  const handleRefresh = useCallback(\n    (fallback: () => void) => {\n      presentationRef.send({type: 'iframe refresh'})\n      if (visualEditingComlink) {\n        // We only wait 300ms for the iframe to ack the refresh request before running the fallback logic\n        refreshRef.current = window.setTimeout(fallback, 300)\n        visualEditingComlink.post('presentation/refresh', {\n          source: 'manual',\n          livePreviewEnabled:\n            previewKitConnection === 'connected' || loadersConnection === 'connected',\n        })\n        return\n      }\n      fallback()\n    },\n    [loadersConnection, presentationRef, previewKitConnection, visualEditingComlink],\n  )\n\n  const workspace = useWorkspace()\n\n  const getCommentIntent = useCallback<CommentIntentGetter>(\n    ({id, type, path}) => {\n      if (frameStateRef.current.url) {\n        return {\n          title: frameStateRef.current.title || frameStateRef.current.url,\n          name: 'edit',\n          params: {\n            id,\n            path,\n            type,\n            inspect: COMMENTS_INSPECTOR_NAME,\n            workspace: workspace.name,\n            mode: EDIT_INTENT_MODE,\n            preview: params.preview,\n          },\n        }\n      }\n      return undefined\n    },\n    [params.preview, workspace.name],\n  )\n\n  const setViewport = useCallback(\n    (next: PresentationViewport) => {\n      // Omit the viewport URL search param if the next viewport state is the\n      // default: 'desktop'\n      const viewport = next === 'desktop' ? undefined : 'mobile'\n      navigate({\n        params: {viewport},\n        replace: true,\n      })\n    },\n    [navigate],\n  )\n\n  return (\n    <>\n      <PresentationProvider\n        devMode={devMode}\n        name={name}\n        navigate={navigate}\n        params={params}\n        searchParams={searchParams}\n        structureParams={structureParams}\n      >\n        <PresentationNavigateProvider navigate={navigate}>\n          <PresentationParamsProvider params={params}>\n            <SharedStateProvider comlink={visualEditingComlink}>\n              <Container data-testid=\"presentation-root\" height=\"fill\">\n                <Panels>\n                  <PresentationNavigator />\n                  <Panel\n                    id=\"preview\"\n                    minWidth={325}\n                    defaultSize={navigatorEnabled ? 50 : 75}\n                    order={3}\n                  >\n                    <Flex direction=\"column\" flex={1} height=\"fill\" ref={setBoundaryElement}>\n                      <BoundaryElementProvider element={boundaryElement}>\n                        <Preview\n                          // @TODO move closer to the <iframe> element itself to allow for more precise handling of when to reload the iframe and when to reconnect when the target origin changes\n                          // Make sure the iframe is unmounted if the targetOrigin has changed\n                          key={targetOrigin}\n                          canSharePreviewAccess={canSharePreviewAccess}\n                          canToggleSharePreviewAccess={canToggleSharePreviewAccess}\n                          canUseSharedPreviewAccess={canUseSharedPreviewAccess}\n                          header={unstable_header}\n                          initialUrl={initialPreviewUrl}\n                          loadersConnection={loadersConnection}\n                          navigatorEnabled={navigatorEnabled}\n                          onPathChange={handlePreviewPath}\n                          onRefresh={handleRefresh}\n                          openPopup={handleOpenPopup}\n                          overlaysConnection={overlaysConnection}\n                          previewUrl={params.preview}\n                          perspective={perspective}\n                          ref={iframeRef}\n                          setViewport={setViewport}\n                          targetOrigin={targetOrigin}\n                          toggleNavigator={toggleNavigator}\n                          toggleOverlay={toggleOverlay}\n                          viewport={viewport}\n                          vercelProtectionBypass={vercelProtectionBypass}\n                          presentationRef={presentationRef}\n                          previewUrlRef={previewUrlRef}\n                        />\n                      </BoundaryElementProvider>\n                    </Flex>\n                  </Panel>\n                  <PresentationContent\n                    documentId={params.id}\n                    documentsOnPage={documentsOnPage}\n                    documentType={params.type}\n                    getCommentIntent={getCommentIntent}\n                    mainDocumentState={mainDocumentState}\n                    onEditReference={handleEditReference}\n                    onFocusPath={handleFocusPath}\n                    onStructureParams={handleStructureParams}\n                    searchParams={searchParams}\n                    setDisplayedDocument={setDisplayedDocument}\n                    structureParams={structureParams}\n                  />\n                </Panels>\n              </Container>\n            </SharedStateProvider>\n          </PresentationParamsProvider>\n        </PresentationNavigateProvider>\n      </PresentationProvider>\n      <Suspense>\n        {controller && (\n          <LiveQueries\n            controller={controller}\n            perspective={perspective}\n            liveDocument={displayedDocument}\n            onDocumentsOnPage={setDocumentsOnPage}\n            onLoadersConnection={setLoadersConnection}\n          />\n        )}\n        {visualEditingComlink && params.id && params.type && (\n          <PostMessageRefreshMutations\n            comlink={visualEditingComlink}\n            id={params.id}\n            type={params.type}\n            loadersConnection={loadersConnection}\n            previewKitConnection={previewKitConnection}\n          />\n        )}\n        {visualEditingComlink && (\n          <PostMessageSchema comlink={visualEditingComlink} perspective={perspective} />\n        )}\n        {visualEditingComlink && documentsOnPage.length > 0 && (\n          <PostMessagePreviewSnapshots\n            comlink={visualEditingComlink}\n            perspective={perspective}\n            refs={documentsOnPage}\n          />\n        )}\n        {visualEditingComlink && (\n          <PostMessageDocuments comlink={visualEditingComlink} perspective={perspective} />\n        )}\n        {visualEditingComlink && <PostMessageFeatures comlink={visualEditingComlink} />}\n        {visualEditingComlink && (\n          <PostMessagePerspective comlink={visualEditingComlink} perspective={perspective} />\n        )}\n        {visualEditingComlink && <PostMessageTelemetry comlink={visualEditingComlink} />}\n      </Suspense>\n    </>\n  )\n}\n\n// @TODO reconcile with core utils\nfunction isAltKey(event: KeyboardEvent): boolean {\n  return event.key === 'Alt'\n}\n\n// @TODO reconcile with core utils\nconst IS_MAC =\n  typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform)\nconst MODIFIERS: Record<string, 'altKey' | 'ctrlKey' | 'metaKey' | 'shiftKey'> = {\n  alt: 'altKey',\n  ctrl: 'ctrlKey',\n  mod: IS_MAC ? 'metaKey' : 'ctrlKey',\n  shift: 'shiftKey',\n}\n// @TODO reconcile with core utils\nfunction isHotkey(keys: string[], event: KeyboardEvent): boolean {\n  return keys.every((key) => {\n    if (MODIFIERS[key]) {\n      return event[MODIFIERS[key]]\n    }\n    return event.key === key.toUpperCase()\n  })\n}\n","import {createPreviewSecret} from '@sanity/preview-url-secret/create-secret'\nimport {type SanityClient} from 'sanity'\nimport {fromPromise, type PromiseActorLogic} from 'xstate'\n\n/** @internal */\nexport function defineCreatePreviewSecretActor({\n  client,\n  currentUserId,\n}: {\n  client: SanityClient\n  currentUserId: string | undefined\n}): PromiseActorLogic<{\n  secret: string\n  expiresAt: Date\n}> {\n  return fromPromise(async () => {\n    return await createPreviewSecret(client, 'sanity/presentation', location.href, currentUserId)\n  })\n}\n","import {fetchSharedAccessQuery} from '@sanity/preview-url-secret/constants'\nimport {type SanityClient} from 'sanity'\nimport {fromPromise, type PromiseActorLogic} from 'xstate'\n\n/** @internal */\nexport function defineReadSharedSecretActor({\n  client,\n}: {\n  client: SanityClient\n}): PromiseActorLogic<string | null> {\n  return fromPromise(async () => {\n    return client.fetch<string | null>(\n      fetchSharedAccessQuery,\n      {},\n      {tag: 'presentation.fallback-to-shared-access-secret'},\n    )\n  })\n}\n","import {fromPromise, type PromiseActorLogic} from 'xstate'\n\nimport {type PreviewUrlAllowOption, type PreviewUrlAllowOptionContext} from '../types'\n\ninterface Context extends Pick<PreviewUrlAllowOptionContext, 'client'> {\n  allowOption: PreviewUrlAllowOption | undefined\n}\ntype Input = Omit<PreviewUrlAllowOptionContext, 'client' | 'origin'>\n\n/** @internal */\nexport function defineResolveAllowPatternsActor({\n  client,\n  allowOption,\n}: Context): PromiseActorLogic<URLPattern[], Input> {\n  return fromPromise<URLPattern[], Input>(async ({input}) => {\n    const {initialUrl} = input\n\n    /**\n     * Lazy load the URLPattern polyfill on-demand, if needed\n     */\n    if (typeof URLPattern === 'undefined') {\n      await import('urlpattern-polyfill')\n    }\n\n    /**\n     * If no allow option is provided, we use the initial URL to infer the pattern\n     */\n    if (!allowOption) {\n      return [new URLPattern(initialUrl.origin)]\n    }\n\n    const maybePatterns =\n      typeof allowOption === 'function'\n        ? await allowOption({client, origin, initialUrl})\n        : allowOption\n    const patterns = Array.isArray(maybePatterns) ? maybePatterns : [maybePatterns]\n    const urlPatterns = patterns.map((value) => {\n      const urlPattern = new URLPattern(value)\n      if (urlPattern.hostname === '*') {\n        throw new Error(\n          `It's insecure to allow any hostname, it could disclose data to a malicious site`,\n        )\n      }\n      return urlPattern\n    })\n    /**\n     * If the declared patterns don't consider the initial URL valid, we add it to the list of patterns\n     */\n    if (!urlPatterns.some((pattern) => pattern.test(initialUrl.origin))) {\n      return [...urlPatterns, new URLPattern(initialUrl.origin)]\n    }\n\n    return urlPatterns\n  })\n}\n","import {type SanityClient} from 'sanity'\nimport {fromPromise, type PromiseActorLogic} from 'xstate'\n\nimport {type PresentationPerspective, type PreviewUrlOption} from '../types'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\n\n/** @internal */\nexport function defineResolveInitialUrlActor({\n  client,\n  studioBasePath,\n  previewUrlOption,\n  perspective,\n}: {\n  client: SanityClient\n  studioBasePath: string\n  previewUrlOption: PreviewUrlOption | undefined\n  perspective: PresentationPerspective\n}): PromiseActorLogic<URL, {previewSearchParam: string | null}> {\n  return fromPromise<URL, {previewSearchParam: string | null}>(\n    async ({input}: {input: {previewSearchParam: string | null}}) => {\n      const {origin} = location\n      /**\n       * If the previewUrlOption is a function, we need to resolve it and maintain backwards compatibility\n       */\n      if (typeof previewUrlOption === 'function') {\n        const initial = await previewUrlOption({\n          client,\n          studioBasePath,\n          // @TODO handle checking permissions here, and then generating a secret\n          previewUrlSecret: '',\n          studioPreviewPerspective: encodeStudioPerspective(perspective),\n          previewSearchParam: input.previewSearchParam,\n        })\n        return new URL(initial, origin)\n      }\n\n      /**\n       * Provide backwards compatibility for versions where `previewUrl` where optional\n       */\n      if (!previewUrlOption) {\n        return new URL('/', origin)\n      }\n      /**\n       * Support setting `previewUrl` as a string shorthand\n       */\n      if (typeof previewUrlOption === 'string') {\n        return new URL(previewUrlOption, origin)\n      }\n\n      if (typeof previewUrlOption.initial === 'function') {\n        const initial = await previewUrlOption.initial({\n          client,\n          origin,\n        })\n        return new URL(initial, origin)\n      }\n\n      if (typeof previewUrlOption.initial === 'string') {\n        return new URL(previewUrlOption.initial, origin)\n      }\n\n      return new URL(previewUrlOption.preview || '/', previewUrlOption.origin || origin)\n    },\n  )\n}\n","import {fromPromise, type PromiseActorLogic} from 'xstate'\n\nimport {\n  type PreviewUrlOption,\n  type PreviewUrlPreviewMode,\n  type PreviewUrlPreviewModeOptionContext,\n} from '../types'\n\ntype Options = Omit<PreviewUrlPreviewModeOptionContext, 'origin'>\n\ninterface Context extends Pick<Options, 'client'> {\n  previewUrlOption: PreviewUrlOption | undefined\n}\ntype Input = Omit<Options, 'client'>\n\n/** @internal */\nexport function defineResolvePreviewModeActor({\n  client,\n  previewUrlOption,\n}: Context): PromiseActorLogic<PreviewUrlPreviewMode | false, Input> {\n  return fromPromise<PreviewUrlPreviewMode | false, Input>(async ({input}) => {\n    const {targetOrigin} = input\n\n    /**\n     * Handle legacy draftMode options\n     */\n    if (typeof previewUrlOption === 'object' && previewUrlOption?.draftMode) {\n      return {\n        enable: previewUrlOption.draftMode.enable,\n        shareAccess: previewUrlOption.draftMode.shareAccess ?? true,\n      }\n    }\n\n    /**\n     * If no preview mode option is provided, we disable preview mode\n     */\n    if (\n      !previewUrlOption ||\n      typeof previewUrlOption === 'string' ||\n      typeof previewUrlOption === 'function' ||\n      !previewUrlOption.previewMode\n    ) {\n      return false\n    }\n\n    /**\n     * If the option is a function, we resolve it\n     */\n    const previewMode =\n      typeof previewUrlOption.previewMode === 'function'\n        ? await previewUrlOption.previewMode({client, origin, targetOrigin})\n        : previewUrlOption.previewMode\n\n    if (previewMode === false) {\n      return false\n    }\n\n    /**\n     * Return only supported preview mode options, filter out unknowns\n     */\n    return {\n      enable: previewMode.enable,\n      shareAccess: previewMode.shareAccess ?? true,\n    }\n  })\n}\n","import {\n  urlSearchParamPreviewPathname,\n  urlSearchParamPreviewPerspective,\n  urlSearchParamPreviewSecret,\n} from '@sanity/preview-url-secret/constants'\nimport {type SanityClient} from 'sanity'\nimport {fromPromise, type PromiseActorLogic} from 'xstate'\n\nimport {\n  type PresentationPerspective,\n  type PreviewUrlOption,\n  type PreviewUrlPreviewMode,\n} from '../types'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\n\n/** @internal */\nexport interface ResolvePreviewModeUrlInput {\n  previewUrlSecret: string\n  resolvedPreviewMode: PreviewUrlPreviewMode\n  initialUrl: URL\n}\n\n/** @internal */\nexport function defineResolvePreviewModeUrlActor({\n  client,\n  studioBasePath,\n  previewUrlOption,\n  perspective,\n}: {\n  client: SanityClient\n  studioBasePath: string\n  previewUrlOption: PreviewUrlOption | undefined\n  perspective: PresentationPerspective\n}): PromiseActorLogic<URL, ResolvePreviewModeUrlInput> {\n  return fromPromise<URL, ResolvePreviewModeUrlInput>(async ({input}) => {\n    const {previewUrlSecret, resolvedPreviewMode, initialUrl} = input\n\n    /**\n     * If the previewUrlOption is a function, we need to resolve it and maintain backwards compatibility\n     */\n    if (typeof previewUrlOption === 'function') {\n      const initial = await previewUrlOption({\n        client,\n        studioBasePath,\n        previewUrlSecret,\n        studioPreviewPerspective: encodeStudioPerspective(perspective),\n        previewSearchParam: initialUrl.toString(),\n      })\n      return new URL(initial, initialUrl)\n    }\n\n    /**\n     * If the resolved preview mode is false then we have an unexpected state that shouldn't be possible\n     */\n    if (!resolvedPreviewMode) {\n      throw new Error('Resolved preview mode is false')\n    }\n\n    const url = new URL(resolvedPreviewMode.enable, initialUrl)\n\n    url.searchParams.set(urlSearchParamPreviewSecret, previewUrlSecret)\n    url.searchParams.set(urlSearchParamPreviewPerspective, encodeStudioPerspective(perspective))\n    if (initialUrl.pathname !== url.pathname) {\n      url.searchParams.set(\n        urlSearchParamPreviewPathname,\n        `${initialUrl.pathname}${initialUrl.search}${initialUrl.hash}`,\n      )\n    }\n\n    return url\n  })\n}\n","import {fromPromise} from 'xstate'\n\n/** @internal */\nexport const resolveUrlFromPreviewSearchParamActor = fromPromise<\n  URL,\n  {initialUrl: URL; previewSearchParam: string | null | undefined; allowOrigins: URLPattern[]}\n>(async ({input}) => {\n  const {previewSearchParam, initialUrl, allowOrigins} = input\n\n  /**\n   * If the preview search param is falsy we can skip\n   */\n  if (!previewSearchParam) {\n    return initialUrl\n  }\n\n  /**\n   * Validate the previewSearchParam\n   */\n  try {\n    const previewSearchParamUrl = new URL(previewSearchParam, initialUrl.origin)\n    if (!allowOrigins.some((pattern) => pattern.test(previewSearchParamUrl.origin))) {\n      return initialUrl\n    }\n    return previewSearchParamUrl\n  } catch (err) {\n    return initialUrl\n  }\n})\n","import {\n  schemaIdSingleton,\n  schemaType,\n  schemaTypeSingleton,\n} from '@sanity/preview-url-secret/constants'\nimport {type SanityDocument} from '@sanity/types'\nimport {uuid} from '@sanity/uuid'\nimport {throwError} from 'rxjs'\nimport {type DocumentValuePermission, type PermissionCheckResult} from 'sanity'\nimport {type ActorRefFrom, assign, fromObservable, fromPromise, log, setup} from 'xstate'\n\nimport {type ResolvePreviewModeUrlInput} from '../actors/resolve-preview-mode-url'\nimport {resolveUrlFromPreviewSearchParamActor} from '../actors/resolve-url-from-preview-search-param'\nimport {type PreviewUrlPreviewMode} from '../types'\n\ninterface Context {\n  initialUrl: URL | null\n  previewUrl: URL | null\n  allowOrigins: URLPattern[] | null\n  error: Error | null\n  previewSearchParam: string | null\n  previewUrlSecret: {secret: string; expiresAt: Date} | null\n  previewAccessSharingCreatePermission: PermissionCheckResult | null\n  previewAccessSharingReadPermission: PermissionCheckResult | null\n  previewAccessSharingUpdatePermission: PermissionCheckResult | null\n  previewUrlSecretPermission: PermissionCheckResult | null\n  previewMode: PreviewUrlPreviewMode | null\n}\n\ntype SetPreviewSearchParamEvent = {\n  type: 'set preview search param'\n  previewSearchParam: string | null\n}\ntype Event = SetPreviewSearchParamEvent\n\ntype Input = Omit<SetPreviewSearchParamEvent, 'type'>\n\nexport interface CheckPermissionInput {\n  checkPermissionName: DocumentValuePermission\n  document: Partial<SanityDocument> | null\n}\n\n/**\n * Used for permissions checks\n */\nexport const shareAccessSingletonDocument = {_id: schemaIdSingleton, _type: schemaTypeSingleton}\nexport const previewUrlSecretDocument = {\n  _id: `drafts.${uuid()}`,\n  _type: schemaType,\n}\n\nexport const previewUrlMachine = setup({\n  types: {} as {\n    context: Context\n    events: Event\n    input: Input\n    tags: 'busy' | 'error'\n  },\n  actions: {\n    'notify preview will likely fail': log(\n      `Missing permissions to create preview secret, or read shared preview secret. Preview will likely fail loading.`,\n    ),\n    'assign preview search param': assign({\n      previewSearchParam: (_, params: {previewSearchParam: string | null}) =>\n        params.previewSearchParam,\n    }),\n    'assign error': assign({\n      error: (_, params: {message: string; error: unknown}) => {\n        return params.error instanceof Error\n          ? params.error\n          : new Error(params.message, {cause: params.error})\n      },\n    }),\n  },\n  actors: {\n    'check permission': fromObservable<PermissionCheckResult, CheckPermissionInput>(() =>\n      throwError(\n        () =>\n          new Error(\n            `The 'check permission' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'check permission': fromObservable(({input}: {input: CheckPermissionInput}) => ...)}})`,\n          ),\n      ),\n    ),\n    'resolve initial url': fromPromise<URL, {previewSearchParam: string | null}>(() =>\n      Promise.reject(\n        new Error(\n          `The 'resolve initial url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve initial url': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'resolve allow patterns': fromPromise<URLPattern[], {initialUrl: URL}>(() =>\n      Promise.reject(\n        new Error(\n          `The 'resolve allow patterns' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve allow pattern': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'resolve url from preview search param': resolveUrlFromPreviewSearchParamActor,\n    'resolve preview mode': fromPromise<PreviewUrlPreviewMode | false, {targetOrigin: string}>(() =>\n      Promise.reject(\n        new Error(\n          `The 'resolve preview mode' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'create preview secret': fromPromise<{\n      secret: string\n      expiresAt: Date\n    }>(async () =>\n      Promise.reject(\n        new Error(\n          `The 'create preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'create preview secret': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'read shared preview secret': fromPromise<string | null>(async () =>\n      Promise.reject(\n        new Error(\n          `The 'read shared preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'read shared preview secret': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'resolve preview mode url': fromPromise<URL, ResolvePreviewModeUrlInput>(() =>\n      Promise.reject(\n        new Error(\n          `The 'resolve preview mode url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode url': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n  },\n  guards: {\n    'has checked permissions': ({context}) => {\n      return Boolean(\n        context.previewAccessSharingCreatePermission &&\n          context.previewAccessSharingReadPermission &&\n          context.previewAccessSharingUpdatePermission &&\n          context.previewUrlSecretPermission,\n      )\n    },\n    'search param has new origin': ({context, event}) => {\n      if (!context.previewUrl || !event.previewSearchParam) {\n        return false\n      }\n      try {\n        const previewSearchParamUrl = new URL(event.previewSearchParam, context.previewUrl)\n        return context.previewUrl.origin !== previewSearchParamUrl.origin\n      } catch {\n        return false\n      }\n    },\n    'can create preview secret': ({context}) => {\n      return context.previewUrlSecretPermission?.granted === true\n    },\n\n    'has preview mode with created secret': ({context}, params: PreviewUrlPreviewMode | false) => {\n      if (params === false) {\n        return false\n      }\n      return context.previewUrlSecretPermission?.granted === true\n    },\n    'has preview mode with share access': ({context}, params: PreviewUrlPreviewMode | false) => {\n      if (params === false) {\n        return false\n      }\n      return context.previewAccessSharingReadPermission?.granted === true\n    },\n    'has preview mode without permissions': ({context}, params: PreviewUrlPreviewMode | false) => {\n      if (params === false) {\n        return false\n      }\n      return (\n        context.previewAccessSharingReadPermission?.granted === false &&\n        context.previewUrlSecretPermission?.granted === false\n      )\n    },\n  },\n  delays: {\n    expiredSecret: ({context}) => {\n      if (!context.previewUrlSecret?.expiresAt) {\n        return 0\n      }\n      const now = Date.now()\n      const expiresAt = context.previewUrlSecret.expiresAt.getTime()\n      return Math.max(expiresAt - now, 0)\n    },\n  },\n}).createMachine({\n  // eslint-disable-next-line tsdoc/syntax\n  /** @xstate-layout N4IgpgJg5mDOIC5QAUBOYBuBLMB3ABAKoBKAMgMRiqoD2qAdAA4A2AhgC4BmdAtvWphwESpBFgB2GGgGMOWGuIDaABgC6K1YlCMasLO3nitIAB6IArAA56AZgCcAdkcBGS8vMAmO+YBszgDQgAJ6Izs4+9M7KACzKztGWHg4OPubmAL7pgQLYeERklNR0TGxcvPzoucJkYpIycgqKzupqxjp6BgrGZggAtM520ZHRdjZjNjFe7oEhCGERUbHxicmpGVkgOUL5FFS0DCwc3Kh8W3kitVKynUoeLZpIIO36ht2IvV62Hl7elmE2lh83xmoXCkRicQSSRS5gSmWylW2IkK+xKR3KZ2qogkVwaShs9zauheXUePV6gPo3jSUyi-xBczBi0hKxh5mc8M2iPOBVgYHY+EY3IIfNYqGkAAtBWLWDwNESOq8yaCbM56A4bB5fGllHYvD4fAz4h56CNfG5LKqHMpLdFOZidvRJWBpABrCRQZBUHhYWB6BSwcjyx7PG5vPrs5TqjWqyyjTXRDwMjwxei68J2ZQ2nyWXN2jYOkT0dCwGjMbDiKAASXEL1YzEIqGY5AgCjA9BxNFd7cLZGLcDLFertYM9cbzEu9RuGmD2mJYeVfRGdipyh86Yc0XiE3MDK3JssIwcrmtPjGSXzCMEPNI-dL5Y9NbrDabKOKhzKJwq16xd8Hj5HLAxybSdrkMGdWhDeclVAclN3odlzBsKwBjSSxjwcZM7DVeJ1w8P4xmidk7HtYVHRLf9KwAQWYZgaFwZAOHYKhxEDVtxHbTtu2-KpyIHB9qNo+jGPYZjUFY0C8Qgh450VUlYPedkHHoHwnDSZDVOiGwfGiBlUhXXwwjsQYtKSYzSJ-Pj7yHGi6IYpiWMDPZ31KY5TjIosKIEqBbOEhzxNgSTpzUWcnmg+TTHePV6Hw3MYgzaItJ0hlYRNTNkLiHxBl1GILN4zz+KHccADFaB4TEAGUwDFSVGNQWUWzbDs6m43tby8oqm1KmhyuFKqaolOrZSC8CQsg2SSSMRdel8ZSNUTdlcw8M07AZQZrDXdaDRtUZnHWK98r7DqPRKsrKuq8VBplHg3wOVyMQ8o7CpOrqzr6i7auukbGjGmSwrkqaFL6MJlLiWFlC1EGty0hknAiXVVPMRx12UJwOQLR72ueytMQAWRoCAwEajjmqkVrMb-by8YJsBvqUX6FUm8Nem2+hbWPUZErGTcjS8NUJg8AE9T1ZwHHwvKkSe6yPWpwnic4lqewp46ceFfHCbpmdmkZhcgZmyxzFsDmTPcXUUiNRKDy3ZQJlVLSkYlm9KaHWWifYhWyaVyyCul1Wf3V2nOzAn71DuHWYMivovGsBxPCy74beWaJDWCUJzBSFTrUcQYdMzIFHd-FXPTVmn5dJrsvcOrHfeL-2ac1kKCXDiLyWcNKJiiHM-BtONwgtnMEM1DVNwhhI7B8AurMo2uqgD260U-dzval6fXYbwkoIB5moijLLkm5tvYRBo1nGQtND11ZaIdzEiMeX6vV5LuW+QFIVLNFS7pXquVxv+pnF1FtYP4OY7AG3QohJMqcEDeGUq4NwYQBhLEnkWWAABXaQ0g4CBhfoKMiH9JRf1lKFUMEceiizVPA0+7gtQQy8LzXU6obaJTFtEJwHhXDIL7G-WepccHcO2PgqUjBrrEPCoDSOFI3C2AGHtQ8sIiJJGTILZS7JRaeGSKw7CnDbz8LwAHJ06AOBgHOtIdA7Ay5cUrpLHRT92ymOqsxExZj16iK3gAqI6oaQ6QtE4YylhkynzmkCBGNgNR7VvgdaxTBbEGIccY969jzHOTuuiL8bVol10JrEoxTj+QuN-iQlu7xwjKX1P8bSTC0hGhcKaBIOZAQGkBKE7RGSeFZMMRACqEoxRgCohgrBFjFY8Sibo3A+iOldJ6X0zBfp8l-UKeIshjgqTGTiPYPaGotS7igd8QWtgsp6iQnFOEd8q6tKEOM6qnTunoGmQM5JC83LDKdqMy5rBrlTP6bMoOUkGab3-kDU+ERVEpnsEjDRVSdljBXKeQY3h5gOBaa8mmzt4k-nHIMz2zzfzIvaYVNFVRxxzObosxAfg1Q2jSOERIh5kIBNGKaNZ2lvjhFhEimJHUCVCAxQ8j8Tz0m4vbJyzERKfnBQ3hNXWkdyWeJsCMVhqNsK6mTO4Q2Q9DysLCEhDw7LMntjQV8wMJhYDsCMfQVgnAxIAAowAmEYFgdAnSXRmIAJTkAFTEg1MzYCuIBZHKYKlUiqWwrCMJkDZgDAYceRMfwUisPYZYTIGxxA03gI8NqJLmZ6msKqENcjErqIZL0cethvDGXLew9hiYWnOjdDLb0vp-SsUzdNcwEMEJ7WTohDMfgU4RpTCpUJnhYrHghuEFpRcnyjhfMwFtet2Q2FNOwsWZarBan8TsuMkRvhIzPJGDwmkWnJLnf6g0aZl0mQTURDdsxYiGwwsRIEgwEwTuxj5IS9lRKORPeSJCOF4XgrUZqbZsxwZszcJtbC4RUg2FfTXU6PVzoDSGjwH9ik-gxRGG4NtxkkZblhgyxIhFQG5lSPEODj89VoYjKqGKURkij0zImXSUCwiozZuDLUCQQY6tOVEr1WDqMsxNCkP4RFPBZj+I4I0qoRMODjIlceBzkK6raWAIT7DDZlNPhUuVkKI0pEXbHBISF1yAiIqpi5KL7E5ISWYoTna2b6Qg+DcFN7EAphLdpdOWVoPJ0RXxl5HKrmTNuYahzaQviaQPVERa8mlGeBUnnQyDStSwcCzi4L1kuV4HHNR4DCFdRaVVFSzcZ4VVIVsDEVhZ5QnWlYZZvRKLj3-KlT0FIKjVRZghkCXwqkjQGzVFxvOMisoWYy46QV9ABN+mo3mFZZ427lp032jzVa2bJGtCUtciak1AA */\n  id: 'Preview URL',\n  context: ({input}) => ({\n    initialUrl: null,\n    previewUrl: null,\n    error: null,\n    allowOrigins: null,\n    previewSearchParam: input.previewSearchParam,\n    previewUrlSecret: null,\n    previewAccessSharingCreatePermission: null,\n    previewAccessSharingReadPermission: null,\n    previewAccessSharingUpdatePermission: null,\n    previewUrlSecretPermission: null,\n    previewMode: null,\n  }),\n\n  invoke: [\n    {\n      src: 'check permission',\n      input: () => ({checkPermissionName: 'read', document: shareAccessSingletonDocument}),\n      onError: {\n        target: '.error',\n        actions: {\n          type: 'assign error',\n          params: ({event}) => ({\n            message: 'Failed to check permission',\n            error: event.error,\n          }),\n        },\n      },\n      onSnapshot: {\n        actions: assign({\n          previewAccessSharingReadPermission: ({event}) => event.snapshot.context ?? null,\n        }),\n      },\n    },\n    {\n      src: 'check permission',\n      input: () => ({checkPermissionName: 'create', document: shareAccessSingletonDocument}),\n      onError: {\n        target: '.error',\n        actions: {\n          type: 'assign error',\n          params: ({event}) => ({\n            message: 'Failed to check permission',\n            error: event.error,\n          }),\n        },\n      },\n      onSnapshot: {\n        actions: assign({\n          previewAccessSharingCreatePermission: ({event}) => event.snapshot.context ?? null,\n        }),\n      },\n    },\n    {\n      src: 'check permission',\n      input: () => ({checkPermissionName: 'update', document: shareAccessSingletonDocument}),\n      onError: {\n        target: '.error',\n        actions: {\n          type: 'assign error',\n          params: ({event}) => ({\n            message: 'Failed to check permission',\n            error: event.error,\n          }),\n        },\n      },\n      onSnapshot: {\n        actions: assign({\n          previewAccessSharingUpdatePermission: ({event}) => event.snapshot.context ?? null,\n        }),\n      },\n    },\n    {\n      src: 'check permission',\n      input: () => ({checkPermissionName: 'create', document: previewUrlSecretDocument}),\n      onError: {\n        target: '.error',\n        actions: {\n          type: 'assign error',\n          params: ({event}) => ({\n            message: 'Failed to check permission',\n            error: event.error,\n          }),\n        },\n      },\n      onSnapshot: {\n        actions: assign({\n          previewUrlSecretPermission: ({event}) => event.snapshot.context ?? null,\n        }),\n      },\n    },\n  ],\n\n  on: {\n    'set preview search param': {\n      actions: {\n        type: 'assign preview search param',\n        params: ({event}) => ({previewSearchParam: event.previewSearchParam}),\n      },\n    },\n  },\n\n  states: {\n    checkingPermissions: {\n      always: {\n        guard: 'has checked permissions',\n        target: 'resolvingInitialUrl',\n      },\n      tags: 'busy',\n    },\n\n    resolvingInitialUrl: {\n      invoke: {\n        src: 'resolve initial url',\n        input: ({context}) => ({previewSearchParam: context.previewSearchParam}),\n        onError: {\n          target: 'error',\n          actions: {\n            type: 'assign error',\n            params: ({event}) => ({\n              message: 'Failed to resolve initial url',\n              error: event.error,\n            }),\n          },\n        },\n        onDone: {\n          target: 'resolvingAllowPatterns',\n          actions: assign({initialUrl: ({event}) => event.output}),\n        },\n      },\n\n      tags: 'busy',\n    },\n\n    error: {\n      type: 'final',\n      tags: 'error',\n    },\n\n    resolvingAllowPatterns: {\n      invoke: {\n        src: 'resolve allow patterns',\n        input: ({context}) => ({initialUrl: context.initialUrl!}),\n        onError: {\n          target: 'error',\n          actions: {\n            type: 'assign error',\n            params: ({event}) => ({\n              message: 'Failed to resolve preview url allow patterns',\n              error: event.error,\n            }),\n          },\n        },\n        onDone: {\n          target: 'resolvingUrlFromPreviewSearchParam',\n          actions: assign({allowOrigins: ({event}) => event.output}),\n        },\n      },\n      tags: ['busy'],\n    },\n\n    resolvingUrlFromPreviewSearchParam: {\n      id: 'loop',\n      invoke: {\n        src: 'resolve url from preview search param',\n        input: ({context}) => ({\n          initialUrl: context.initialUrl!,\n          allowOrigins: context.allowOrigins!,\n          previewSearchParam: context.previewSearchParam,\n        }),\n        onError: {\n          target: 'error',\n          actions: {\n            type: 'assign error',\n            params: ({event}) => ({\n              message: 'Failed to resolve preview url from search param',\n              error: event.error,\n            }),\n          },\n        },\n        onDone: {\n          target: 'resolvingPreviewMode',\n          actions: assign({initialUrl: ({event}) => event.output}),\n        },\n      },\n      tags: ['busy'],\n    },\n\n    resolvingPreviewMode: {\n      on: {\n        'set preview search param': {\n          guard: 'search param has new origin',\n          actions: {\n            type: 'assign preview search param',\n            params: ({event}) => ({previewSearchParam: event.previewSearchParam}),\n          },\n          target: '#loop',\n          reenter: true,\n        },\n      },\n      invoke: {\n        src: 'resolve preview mode',\n        input: ({context}) => ({targetOrigin: context.initialUrl!.origin}),\n        onError: {\n          target: 'error',\n          actions: {\n            type: 'assign error',\n            params: ({event}) => ({\n              message: 'Failed to resolve preview url allow patterns',\n              error: event.error,\n            }),\n          },\n        },\n        onDone: [\n          {\n            guard: {\n              type: 'has preview mode with created secret',\n              params: ({event}) => event.output,\n            },\n            actions: assign({\n              previewMode: ({event}) => event.output as unknown as PreviewUrlPreviewMode,\n            }),\n            target: 'previewMode.createPreviewSecret',\n          },\n          {\n            guard: {\n              type: 'has preview mode with share access',\n              params: ({event}) => event.output,\n            },\n            actions: assign({\n              previewMode: ({event}) => event.output as unknown as PreviewUrlPreviewMode,\n            }),\n            target: 'previewMode.readShareAccess',\n          },\n          {\n            guard: {\n              type: 'has preview mode without permissions',\n              params: ({event}) => event.output,\n            },\n            actions: [\n              assign({\n                previewUrl: ({context}) => context.initialUrl,\n              }),\n              'notify preview will likely fail',\n            ],\n            target: 'success',\n          },\n          {\n            actions: assign({\n              previewUrl: ({context}) => context.initialUrl,\n            }),\n            target: 'success',\n          },\n        ],\n      },\n      tags: ['busy'],\n    },\n\n    success: {\n      on: {\n        'set preview search param': {\n          guard: 'search param has new origin',\n          actions: {\n            type: 'assign preview search param',\n            params: ({event}) => ({previewSearchParam: event.previewSearchParam}),\n          },\n          target: '#loop',\n          reenter: true,\n        },\n      },\n    },\n\n    previewMode: {\n      on: {\n        'set preview search param': {\n          guard: 'search param has new origin',\n          actions: {\n            type: 'assign preview search param',\n            params: ({event}) => ({previewSearchParam: event.previewSearchParam}),\n          },\n          target: '#loop',\n          reenter: true,\n        },\n      },\n\n      states: {\n        createPreviewSecret: {\n          invoke: {\n            src: 'create preview secret',\n            onError: {\n              target: 'error',\n              actions: {\n                type: 'assign error',\n                params: ({event}) => ({\n                  message: 'Failed to create preview secret',\n                  error: event.error,\n                }),\n              },\n            },\n            onDone: {\n              target: 'resolvePreviewUrl',\n              actions: assign({previewUrlSecret: ({event}) => event.output}),\n            },\n          },\n          tags: ['busy'],\n        },\n        readShareAccess: {\n          invoke: {\n            src: 'read shared preview secret',\n            onError: {\n              target: 'error',\n              actions: {\n                type: 'assign error',\n                params: ({event}) => ({\n                  message: 'Failed to read shared preview secret',\n                  error: event.error,\n                }),\n              },\n            },\n            onDone: {\n              target: 'resolvePreviewUrl',\n              actions: assign({\n                previewUrlSecret: ({event}) => ({\n                  secret: event.output!,\n                  expiresAt: new Date(Date.now() + 1000 * 60 * 60 * 60 * 24),\n                }),\n              }),\n            },\n          },\n          tags: ['busy'],\n        },\n        resolvePreviewUrl: {\n          invoke: {\n            src: 'resolve preview mode url',\n            input: ({context}) => ({\n              initialUrl: context.initialUrl!,\n              resolvedPreviewMode: context.previewMode!,\n              previewUrlSecret: context.previewUrlSecret!.secret,\n            }),\n            onError: {\n              target: 'error',\n              actions: {\n                type: 'assign error',\n                params: ({event}) => ({\n                  message: 'Failed to resolve preview url',\n                  error: event.error,\n                }),\n              },\n            },\n            onDone: {\n              target: 'success',\n              actions: assign({previewUrl: ({event}) => event.output}),\n            },\n          },\n          tags: ['busy'],\n        },\n        error: {\n          type: 'final',\n          tags: ['error'],\n        },\n        success: {\n          after: {\n            expiredSecret: {\n              guard: 'can create preview secret',\n              actions: assign({previewUrlSecret: null}),\n              target: 'createPreviewSecret',\n              reenter: true,\n            },\n          },\n        },\n      },\n      initial: 'readShareAccess',\n    },\n  },\n\n  initial: 'checkingPermissions',\n})\nexport type PreviewUrlRef = ActorRefFrom<typeof previewUrlMachine>\n","import {useToast} from '@sanity/ui'\nimport {useActorRef, useSelector} from '@xstate/react'\nimport {useEffect} from 'react'\nimport {useActiveWorkspace, useClient, useCurrentUser, useGrantsStore, useTranslation} from 'sanity'\nimport {useRouter} from 'sanity/router'\nimport {fromObservable} from 'xstate'\n\nimport {defineCreatePreviewSecretActor} from './actors/create-preview-secret'\nimport {defineReadSharedSecretActor} from './actors/read-shared-secret'\nimport {defineResolveAllowPatternsActor} from './actors/resolve-allow-patterns'\nimport {defineResolveInitialUrlActor} from './actors/resolve-initial-url'\nimport {defineResolvePreviewModeActor} from './actors/resolve-preview-mode'\nimport {defineResolvePreviewModeUrlActor} from './actors/resolve-preview-mode-url'\nimport {API_VERSION} from './constants'\nimport {presentationLocaleNamespace} from './i18n'\nimport {previewUrlMachine, type PreviewUrlRef} from './machines/preview-url'\nimport {type PreviewUrlAllowOption, type PreviewUrlOption} from './types'\nimport {usePresentationPerspective} from './usePresentationPerspective'\n\nexport function usePreviewUrlActorRef(\n  previewUrlOption: PreviewUrlOption | undefined,\n  allowOption: PreviewUrlAllowOption | undefined,\n): PreviewUrlRef {\n  const grantsStore = useGrantsStore()\n  const client = useClient({apiVersion: API_VERSION})\n  const currentUser = useCurrentUser()\n  const currentUserId = currentUser?.id\n  const workspace = useActiveWorkspace()\n  const studioBasePath = workspace?.activeWorkspace?.basePath || '/'\n  const router = useRouter()\n  const routerSearchParams = new URLSearchParams(router.state._searchParams)\n  const previewSearchParam = routerSearchParams.get('preview')\n  const {push: pushToast} = useToast()\n  const {t} = useTranslation(presentationLocaleNamespace)\n\n  // TODO: Do we need to pass the scheduled draft perspective here?\n  // Scheduled draft are a \"local\" perspective which applies only when the user is in the document pane and has selected the scheduled draft.\n  const perspective = usePresentationPerspective({scheduledDraft: undefined})\n\n  const actorRef = useActorRef(\n    previewUrlMachine.provide({\n      actions: {\n        'notify preview will likely fail': () =>\n          pushToast({\n            id: 'preview-url-secret.missing-grants',\n            closable: true,\n            status: 'error',\n            duration: Infinity,\n            title: t('preview-url-secret.missing-grants'),\n          }),\n      },\n      actors: {\n        'create preview secret': defineCreatePreviewSecretActor({client, currentUserId}),\n        'read shared preview secret': defineReadSharedSecretActor({client}),\n        'resolve allow patterns': defineResolveAllowPatternsActor({\n          client,\n          allowOption,\n        }),\n        'resolve initial url': defineResolveInitialUrlActor({\n          client,\n          studioBasePath,\n          previewUrlOption,\n          perspective,\n        }),\n        'resolve preview mode': defineResolvePreviewModeActor({\n          client,\n          previewUrlOption,\n        }),\n        'resolve preview mode url': defineResolvePreviewModeUrlActor({\n          client,\n          studioBasePath,\n          previewUrlOption,\n          perspective,\n        }),\n        'check permission': fromObservable(({input}) =>\n          grantsStore.checkDocumentPermission(input.checkPermissionName, input.document),\n        ),\n      },\n    }),\n    {input: {previewSearchParam}},\n  )\n\n  /**\n   * Sync changes to router state for the preview search param\n   */\n  useEffect(() => {\n    actorRef.send({type: 'set preview search param', previewSearchParam})\n  }, [actorRef, previewSearchParam])\n\n  const error = useSelector(actorRef, (state) =>\n    state.status === 'error' ? state.error : state.hasTag('error') ? state.context.error : null,\n  )\n\n  // Propagate the error to the nearest error boundary\n  if (error) throw error\n\n  return actorRef\n}\n","import {useToast} from '@sanity/ui'\nimport {useSelector} from '@xstate/react'\nimport {useEffect} from 'react'\nimport {Translate, useTranslation} from 'sanity'\nimport {useRouter} from 'sanity/router'\n\nimport {presentationLocaleNamespace} from './i18n'\nimport {type PreviewUrlRef} from './machines/preview-url'\n\nexport function useReportInvalidPreviewSearchParam(previewUrlRef: PreviewUrlRef): void {\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {push: pushToast} = useToast()\n  const router = useRouter()\n  const routerSearchParams = new URLSearchParams(router.state._searchParams)\n  const previewSearchParam = routerSearchParams.get('preview')\n\n  const allowOrigins = useSelector(previewUrlRef, (state) => state.context.allowOrigins)\n  const currentOrigin = useSelector(previewUrlRef, (state) => state.context.previewUrl?.origin)\n  useEffect(() => {\n    if (!Array.isArray(allowOrigins) || !previewSearchParam || !currentOrigin) return\n    const nextOrigin = new URL(previewSearchParam, currentOrigin).origin\n    if (!allowOrigins.some((pattern) => pattern.test(nextOrigin))) {\n      pushToast({\n        closable: true,\n        id: `presentation-iframe-origin-mismatch-${nextOrigin}`,\n        status: 'error',\n        duration: Infinity,\n        title: t('preview-search-param.configuration.error.title'),\n        description: (\n          <Translate\n            t={t}\n            i18nKey=\"preview-search-param.configuration.error.description\"\n            components={{Code: 'code'}}\n            values={{\n              previewSearchParam,\n              blockedOrigin: nextOrigin,\n            }}\n          />\n        ),\n      })\n    }\n  }, [allowOrigins, currentOrigin, previewSearchParam, pushToast, t])\n}\n","import {subscribeToVercelProtectionBypass} from '@sanity/preview-url-secret/toggle-vercel-protection-bypass'\nimport {useEffect, useReducer, useState} from 'react'\nimport {useClient} from 'sanity'\n\nimport {API_VERSION} from './constants'\n\ntype VercelProtectionBypassReadyState = 'loading' | 'ready'\n\nexport function useVercelBypassSecret(): [\n  vercelProtectionBypassSecret: string | null,\n  vercelProtectionBypassReadyState: VercelProtectionBypassReadyState,\n] {\n  const client = useClient({apiVersion: API_VERSION})\n  const [vercelProtectionBypassReadyState, ready] = useReducer(\n    () => 'ready' as 'ready' | 'loading',\n    'loading',\n  )\n  const [vercelProtectionBypassSecret, setVercelProtectionBypassSecret] = useState<string | null>(\n    null,\n  )\n\n  useEffect(() => {\n    const unsubscribe = subscribeToVercelProtectionBypass(client, (secret) => {\n      setVercelProtectionBypassSecret(secret)\n      ready()\n    })\n    return () => unsubscribe()\n  }, [client])\n\n  return [vercelProtectionBypassSecret, vercelProtectionBypassReadyState]\n}\n","import {useSelector} from '@xstate/react'\nimport {type Tool} from 'sanity'\n\nimport {PresentationSpinner} from './PresentationSpinner'\nimport PresentationTool from './PresentationTool'\nimport {type PresentationPluginOptions} from './types'\nimport {usePreviewUrlActorRef} from './usePreviewUrlActorRef'\nimport {useReportInvalidPreviewSearchParam} from './useReportInvalidPreviewSearchParam'\nimport {useVercelBypassSecret} from './useVercelBypassSecret'\n\nexport default function PresentationToolGrantsCheck({\n  tool,\n}: {\n  tool: Tool<PresentationPluginOptions>\n}): React.JSX.Element {\n  const previewUrlRef = usePreviewUrlActorRef(tool.options?.previewUrl, tool.options?.allowOrigins)\n  useReportInvalidPreviewSearchParam(previewUrlRef)\n\n  const previewAccessSharingCreatePermission = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewAccessSharingCreatePermission,\n  )\n  const previewAccessSharingUpdatePermission = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewAccessSharingUpdatePermission,\n  )\n  const previewAccessSharingReadPermission = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewAccessSharingReadPermission,\n  )\n  const previewUrlSecretPermission = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewUrlSecretPermission,\n  )\n  const url = useSelector(previewUrlRef, (state) => state.context.previewUrl)\n  // @TODO the vercel protection bypass can be moved to the iframe level\n  const [vercelProtectionBypass, vercelProtectionBypassReadyState] = useVercelBypassSecret()\n\n  if (\n    !url ||\n    vercelProtectionBypassReadyState === 'loading' ||\n    !previewAccessSharingCreatePermission ||\n    typeof previewAccessSharingCreatePermission.granted === 'undefined' ||\n    !previewAccessSharingUpdatePermission ||\n    typeof previewAccessSharingUpdatePermission.granted === 'undefined' ||\n    !previewUrlSecretPermission ||\n    !previewAccessSharingReadPermission ||\n    typeof previewAccessSharingReadPermission.granted === 'undefined' ||\n    typeof previewUrlSecretPermission.granted === 'undefined'\n  ) {\n    return <PresentationSpinner />\n  }\n\n  return (\n    <PresentationTool\n      tool={tool}\n      initialPreviewUrl={url}\n      vercelProtectionBypass={vercelProtectionBypass}\n      canToggleSharePreviewAccess={\n        previewAccessSharingCreatePermission?.granted === true &&\n        previewAccessSharingUpdatePermission?.granted === true\n      }\n      canUseSharedPreviewAccess={previewAccessSharingReadPermission?.granted === true}\n      previewUrlRef={previewUrlRef}\n    />\n  )\n}\n"],"names":["PostMessageFeatures","props","$","_c","comlink","t0","t1","on","_temp","useEffect","memo","features","optimistic","presentationMachine","setup","types","actions","actors","guards","createMachine","id","context","url","error","visualEditingOverlaysEnabled","assign","target","states","description","tags","loading","loaded","event","enabled","idle","refreshing","reloading","initial","SharedStateProvider","children","Symbol","for","sharedState","useRef","t2","state","current","t3","key","value","post","setValue","t4","key_0","removeValue","t5","t6","jsx","PresentationSharedStateContext","Root","styled","div","Panel","defaultSize","minWidth","maxWidth","order","undefined","useContext","PresentationPanelsContext","Error","getPanelStyle","registerElement","unregisterElement","style","type","useLayoutEffect","debounce","fn","timeout","timer","args","clearTimeout","setTimeout","apply","itemKey","getStoredItem","JSON","parse","localStorage","getItem","setStoredItem","data","setItem","stringify","getKeyForPanels","panels","map","panel","join","usePanelsStorage","get","_temp2","set","_temp3","setDebounced","panels_0","widths","stored_0","stored","Array","isArray","some","val","getNextWidth","nextWidth","containerWidth","maxWidthPx","minWidthPx","Math","min","max","getNextWidths","delta","panelBefore","panelAfter","panelsState","initialDragState","prevWidths","initialWidths","nextWidths","pivotPanel","index","findIndex","width","abs","deltaApplied","deltaRemaining","toPrecision","localeCompare","numeric","length","getPanelWidth","getOffset","handleElement","initialOffset","initialHandleElementRect","pointerOffset","clientX","elementOffset","getBoundingClientRect","left","isPanel","element","isResizer","getSortedElements","elements","from","values","sort","a","b","validateWidths","widthsToValidate","total","reduce","remainingWidth","toFixed","getDefaultWidths","panelsWithoutWidth","remainingWidthTotal","widthsWithNulls","defaultWidth","PanelsWrapper","Panels","panelsEl","Map","setElements","useState","filter","setWidths","activeResizer","setActiveResizer","panelsRef","flexGrow","pointerEvents","id_0","prev","has","next","t7","id_1","prev_0","next_0","delete","t8","window","innerWidth","dragOffset","resizerIndex","resizerRect","startX","dragRef","t9","id_2","elementsArr","el","resizer","resizeElement","acc","el_0","i","acc_0","el_1","i_0","pageX","startDragging","t10","stopDragging","t11","id_3","event_0","preventDefault","stopPropagation","resizer_0","resizeElement_0","offset","rect","prevWidth","i_1","drag","t12","t13","storage","t14","t15","widths_0","storedWidths","validatedStoredWidths","defaultWidths","t16","t17","t18","t19","resizeObserver","ResizeObserver","prevWidths_0","nextWidths_0","prevWidth_0","i_2","observe","disconnect","t20","t21","t22","ErrorCard","message","onContinueAnyway","onRetry","restProps","t","useTranslation","presentationLocaleNamespace","Button","retryButton","continueAnywayButton","Text","jsxs","Stack","Inline","Box","Flex","Container","Card","ChildLink","forwardRef","ref","childId","childParameters","childType","rest","searchParams","childPayload","Object","entries","_searchParams","StateLink","ReferenceChildLink","documentId","documentType","parentRefPath","template","getPublishedId","params","pathToString","encodeQueryString","parts","resolveQueryStringFromParams","nextParams","allowed","safeNextParams","includes","obj","BackLink","PresentationPaneRouterProvider","onEditReference","onStructureParams","structureParams","refs","routerState","resolvePathFromState","useRouter","fromEntries","routerSearchParams","useUnique","path","qs","createPathWithParams","childLinkProps","doc","find","r","_id","_type","console","warn","backLinkProps","ref_0","childLinkProps_0","ref_1","options","version","groupIndex","siblingIndex","payload","hasGroupSiblings","groupLength","routerPanesState","ParameterizedLink","closeCurrentAndAfter","handleEditReference","replaceCurrent","closeCurrent","_temp4","duplicateCurrent","_temp5","setView","_temp6","setParams","setPayload","_temp7","navigateIntent","_temp8","PaneRouterContext","intentName","intentParams","options_0","viewId","pane_0","pane","RootLayout","PaneLayout","WrappedCode","Code","DocumentListPane","mainDocumentState","devMode","usePresentationTool","document","ids","schemaTypeName","title","errorParams","setErrorParams","handleRetry","Label","StructureDocumentListPane","ErrorBoundary","StructureToolProvider","r_0","DocumentPane","onFocusPath","templateParams","decodeJsonParams","templateParameters","paneDocumentNode","studioPath","toString","handleFocusPath","height","PresentationSpinner","Suspense","StructureDocumentPane","DocumentPanel","usePreviewState","schemaType","documentPreviewStore","useDocumentPreviewStore","preview","setPreview","perspectiveStack","usePerspective","subscription","getPreviewStateObservable","subscribe","unsubscribe","ContentEditor","schema","useSchema","props_0","MainDocumentLink","previewState","bb0","snapshot","getPreviewValueWithFallback","fallback","SanityDefaultPreview","PreviewCard","WarningOutlineIcon","Translate","usePanelId","uuid","panelId","Resizer","ResizerInner","$disabled","PanelResizer","propId","disabled","isDragging","nativeEvent","onMouseDown","e","onDrag","blur","onDragStop","resetDocumentStyles","bodyStyle","body","documentStyle","documentElement","cursor","userSelect","removeProperty","addEventListener","removeEventListener","PresentationContentWrapper","setDisplayedDocument","getCommentIntent","CommentsIntentProvider","DisplayedDocumentBroadcasterProvider","PresentationContent","documentsOnPage","PresentationNavigateProvider","navigate","_navigate","PresentationNavigateContext","useLocalState","defaultValue","usePresentationNavigator","unstable_navigator","navigatorProvided","component","_navigatorEnabled","setNavigatorEnabled","navigatorEnabled","toggleNavigator","Component","NavigatorComponent","navigatorDisabled","Navigator","PresentationParamsProvider","PresentationParamsContext","PresentationProvider","name","PresentationContext","useAllowPatterns","previewUrlRef","allowPatterns","useSelector","TypeError","allowOrigins","encodeStudioPerspective","studioPerspective","useId","useReactId","startsWith","replace","IFrame","forwardedRef","animate","onLoad","preventClick","src","variants","useImperativeHandle","instance","handleBlur","activeElement","dispatchEvent","MouseEvent","bubbles","cancelable","viewTransitionName","Fragment","IFrameElement","motion","create","iframe","IFrameOverlay","GlobalViewTransition","createGlobalStyle","OpenPreviewButton","openPopup","previewLocationOrigin","previewLocationRoute","perspective","targetOrigin","URL","urlSearchParamPreviewPerspective","pathname","search","openPreviewLink","currentTarget","href","handleOpenPopup","LaunchIcon","Tooltip","useTargetOrigin","previewUrl","origin","PreviewLocationInput","fontSize","onChange","padding","prefix","suffix","basePath","useActiveWorkspace","activeWorkspace","inputRef","sessionValue","setSessionValue","customValidity","setCustomValidity","handleChange","absoluteValue","pattern","test","reportValidity","nextValue","handleKeyDown","nextValue_0","handleClear","icon","ResetIcon","zIndex","TextInput","QRCodeSVG","lazy","QrCodeLogoSize","QrCodeLogoPadding","QrSize","StyledSanityMonogram","SanityMonogram","MotionSpinner","Spinner","MotionText","MotionMonogram","SharePreviewMenu","canToggleSharePreviewAccess","canUseSharedPreviewAccess","initialUrl","push","pushToast","useToast","apiVersion","API_VERSION","client","useClient","currentUser","useCurrentUser","setLoading","enabling","setEnabling","disabling","setDisabling","secret","setSecret","busy","setSecretSearchParams","setError","closable","status","handleUnableToToggle","run","disablePreviewAccessSharing","location","handleDisableSharing","run_0","previewUrlSecret","enablePreviewAccessSharing","handleEnableSharing","run_1","navigator","clipboard","writeText","handleCopyUrl","controller","AbortController","usedTags","fetchShareSecret","lastLiveEventId","signal","result","syncTags","fetch","fetchSharedAccessQuery","filterResponse","tag","aborted","live","events","abort","finally","ShareIcon","Grid","justifyContent","alignItems","gridTemplateColumns","gridTemplateRows","Switch","position","aspectRatio","display","AnimatePresence","opacity","textWrap","textAlign","MenuDivider","MenuItem","CopyIcon","Menu","constrainSize","placement","portal","MenuButton","PreviewHeaderDefault","canSharePreviewAccess","iframeRef","onPathChange","onRefresh","overlaysConnection","presentationRef","setViewport","toggleOverlay","viewport","toggleViewportSize","send","handleRefresh","isLoading","isLoaded","isRefreshing","isReloading","overlaysEnabled","previewURL","withoutSecretSearchParams","perspectiveToggleTooltipId","previewUrlBusy","PanelLeftIcon","content","fallbackPlacements","whiteSpace","Hotkeys","marginTop","marginBottom","lineHeight","borderRadius","margin","t23","t24","t25","t26","t27","t28","t29","RefreshIcon","t30","t31","t32","t33","node","setProperty","t34","t35","t36","t37","t38","t39","MobileDeviceIcon","DesktopIcon","t40","t41","t42","t43","PreviewHeader","renderDefault","HeaderComponent","header","minHeight","matches","state_0","state_1","state_2","state_3","state_4","hasTag","MotionFlex","Preview","loadersConnection","vercelProtectionBypass","stablePerspective","setStablePerspective","urlPerspective","useMemo","urlSearchParamVercelProtectionBypass","urlSearchParamVercelSetBypassCookie","prefersReducedMotion","usePrefersReducedMotion","previewHeader","timedOut","setTimedOut","somethingIsWrong","setSomethingIsWrong","iframeIsBusy","useCallback","continueAnyway","setContinueAnyway","handleContinueAnyway","showOverlaysConnectionStatus","setShowOverlaysConnectionState","MAX_TIME_TO_OVERLAYS_CONNECTION","onIFrameLoad","preventIframeInteraction","canUseViewTransition","useSyncExternalStore","CSS","supports","iframeAnimations","currentViewport","setCurrentViewport","iframeStyle","setIframeStyle","iframeVariants","update","startViewTransition","flushSync","toast","checkOrigin","setCheckOrigin","reportedMismatches","Set","reportMismatchingOrigin","useEffectEvent","reportedOrigin","allow","add","duration","Infinity","usePresentationNavigate","navigateEvent","nextUrl","hash","contentWindow","createController","addTarget","createChannel","heartbeat","connectTo","createConnectionMachine","provide","createCompatibilityActors","stop","start","destroy","interval","setInterval","postMessage","domain","clearInterval","MotionConfig","TooltipDelayGroupProvider","spinnerVariants","inset","backdropFilter","WebkitBackdropFilter","WebkitTransition","sizes","errorVariants","background","displayName","desktop","mobile","exit","boxShadow","scale","active","defineWarnOnce","warned","warnOnceAboutCrossDatasetReference","useDocumentsOnPage","frameStateRef","validateApiPerspective","published","setPublished","previewDrafts","setPreviewDrafts","urlRef","perspective_0","documents","setCache","cache","isEqual","setDocumentsOnPage","keyedCache","uniqueDocuments","cache_0","forEach","sourceDocument","_projectId","fnOrObj","arg","Function","getQueryFromResult","resolver","resolve","getParamsFromResult","getRouteContext","route","routes","absolute","match","decode","decodeURIComponent","cause","useMainDocument","navigationHistory","resolvers","relativeUrl","setMainDocumentState","mainDocumentIdRef","at","handleResponse","url_0","query","then","doc_0","catch","parseId","rawId","segments","split","shift","parsePath","rawPath","urlStringToPath","parseRouterState","pruneObject","exhaustiveTupleOf","array","maintainOnDocumentChange","maintainOnSameDocument","useParams","initialPreviewUrl","routerNavigate","changesInspectorTab","comment","inspect","instruction","pathKey","rev","scheduledDraft","since","view","routerStateRef","setNavigationHistory","type_0","isSameDocument","params_0","current_0","currentState","currentParams","nextState","nextRouterState","usePopups","popups","setPopups","source","open","unsubs","size","source_0","closed","source_1","source_2","POPUP_CHECK_INTERVAL","unsub","usePresentationPerspective","selectedPerspectiveName","selectedReleaseId","useStatus","statusMap","setStatusMap","handshaking","memoStatus","connection","hasConnected_0","hasConnected","status_1","setStatusFromEvent","status_0","LiveQueries","PostMessageDocuments","PostMessageRefreshMutations","PostMessagePerspective","PostMessagePreviewSnapshots","PostMessageSchema","PostMessageTelemetry","PresentationTool","tool","components","DEFAULT_TOOL_NAME","unstable_header","option","hostname","setController","visualEditingComlink","setVisualEditingComlink","useActorRef","projectId","useProjectId","dataset","useDataset","mainDocuments","setOverlaysConnection","setLoadersConnection","previewKitConnection","setPreviewKitConnection","controller_0","handleNavigate","refreshRef","data_0","urlWithoutSearch","searchParams_0","URLSearchParams","data_1","data_2","data_3","data_4","onStatus","comlink_0","data_5","nextPath","handlePreviewPath","handleStructureParams","frameOrigin","previewOrigin","url_1","newUrl","displayedDocument","handleKeyUp","isAltKey","handleKeydown","e_0","isHotkey","boundaryElement","setBoundaryElement","PresentationNavigator","livePreviewEnabled","workspace","useWorkspace","COMMENTS_INSPECTOR_NAME","mode","EDIT_INTENT_MODE","BoundaryElementProvider","t44","t45","t46","t47","t48","t49","t50","t51","previewMode","shareAccess","IS_MAC","platform","MODIFIERS","alt","ctrl","mod","keys","every","toUpperCase","defineCreatePreviewSecretActor","currentUserId","fromPromise","createPreviewSecret","defineReadSharedSecretActor","defineResolveAllowPatternsActor","allowOption","input","URLPattern","maybePatterns","urlPatterns","urlPattern","defineResolveInitialUrlActor","studioBasePath","previewUrlOption","studioPreviewPerspective","previewSearchParam","defineResolvePreviewModeActor","draftMode","enable","defineResolvePreviewModeUrlActor","resolvedPreviewMode","urlSearchParamPreviewSecret","urlSearchParamPreviewPathname","resolveUrlFromPreviewSearchParamActor","previewSearchParamUrl","shareAccessSingletonDocument","schemaIdSingleton","schemaTypeSingleton","previewUrlSecretDocument","previewUrlMachine","log","_","fromObservable","throwError","Promise","reject","has checked permissions","Boolean","previewAccessSharingCreatePermission","previewAccessSharingReadPermission","previewAccessSharingUpdatePermission","previewUrlSecretPermission","search param has new origin","can create preview secret","granted","has preview mode with created secret","has preview mode with share access","has preview mode without permissions","delays","expiredSecret","expiresAt","now","Date","getTime","invoke","checkPermissionName","onError","onSnapshot","checkingPermissions","always","guard","resolvingInitialUrl","onDone","output","resolvingAllowPatterns","resolvingUrlFromPreviewSearchParam","resolvingPreviewMode","reenter","success","readShareAccess","resolvePreviewUrl","after","usePreviewUrlActorRef","grantsStore","useGrantsStore","router","checkDocumentPermission","actorRef","useReportInvalidPreviewSearchParam","currentOrigin","nextOrigin","blockedOrigin","useVercelBypassSecret","vercelProtectionBypassReadyState","ready","useReducer","vercelProtectionBypassSecret","setVercelProtectionBypassSecret","subscribeToVercelProtectionBypass","PresentationToolGrantsCheck"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA,MAAMA,wBAAoDC,CAAAA,UAAA;AAAA,QAAAC,IAAAC,uBAAA,CAAA,GACxD;AAAA,IAAAC,SAAAA;AAAAA,EAAAA,IAAkBH;AAAK,MAAAI,IAAAC;AAAA,SAAAJ,SAAAE,YAEbC,KAAAA,MACDD,SAAOG,GAAI,2BAA2BC,OAI3C,GACDF,KAAA,CAACF,QAAO,GAACF,OAAAE,UAAAF,OAAAG,IAAAH,OAAAI,OAAAD,KAAAH,EAAA,CAAA,GAAAI,KAAAJ,EAAA,CAAA,IANZO,MAAAA,UAAUJ,IAMPC,EAAS,GAEL;AAAI;AAGb,IAAA,sBAAeI,MAAAA,KAAKV,qBAAmB;AAdmB,SAAAQ,UAAA;AAAA,SAIF;AAAA,IAAAG,UACxC;AAAA,MAAAC,YACI;AAAA,IAAA;AAAA,EACd;AACD;ACFE,MAAMC,sBAAsBC,OAAAA,MAAM;AAAA,EACvCC,OAAO,CAAA;AAAA,EAKPC,SAAS;AAAA;AAAA,EAAA;AAAA,EAGTC,QAAQ;AAAA;AAAA,EAAA;AAAA,EAGRC,QAAQ;AAAA;AAAA,EAAA;AAGV,CAAC,EAAEC,cAAc;AAAA;AAAA;AAAA,EAGfC,IAAI;AAAA,EACJC,SAAS;AAAA,IACPC,KAAK;AAAA,IACLC,OAAO;AAAA,IACPC,8BAA8B;AAAA,EAAA;AAAA,EAGhCjB,IAAI;AAAA,IACF,iBAAiB;AAAA,MACfS,SAASS,OAAAA,OAAO;AAAA,QAACH,KAAK;AAAA,MAAA,CAAK;AAAA,MAC3BI,QAAQ;AAAA,IAAA;AAAA,EACV;AAAA,EAGFC,QAAQ;AAAA,IACNJ,OAAO;AAAA,MACLK,aACE;AAAA,MACFC,MAAM,CAAC,OAAO;AAAA,IAAA;AAAA,IAEhBC,SAAS;AAAA,MACPvB,IAAI;AAAA,QACF,iBAAiB;AAAA,UACfmB,QAAQ;AAAA,QAAA;AAAA,MACV;AAAA,MAEFG,MAAM,CAAC,MAAM;AAAA,IAAA;AAAA,IAEfE,QAAQ;AAAA,MACNxB,IAAI;AAAA,QACF,kCAAkC;AAAA,UAChCS,SAASS,OAAAA,OAAO;AAAA,YACdD,8BAA8BA,CAAC;AAAA,cAACQ;AAAAA,YAAAA,MAAWA,MAAMC;AAAAA,UAAAA,CAClD;AAAA,QAAA;AAAA,QAEH,kBAAkB;AAAA,UAChBP,QAAQ;AAAA,QAAA;AAAA,QAEV,iBAAiB;AAAA,UACfA,QAAQ;AAAA,QAAA;AAAA,MACV;AAAA,MAGFC,QAAQ;AAAA,QACNO,MAAM,CAAA;AAAA,QACNC,YAAY;AAAA,UACV5B,IAAI;AAAA,YACF,iBAAiB;AAAA,cACfmB,QAAQ;AAAA,YAAA;AAAA,UACV;AAAA,UAEFG,MAAM,CAAC,MAAM;AAAA,QAAA;AAAA,QAEfO,WAAW;AAAA,UACT7B,IAAI;AAAA,YACF,iBAAiB;AAAA,cACfmB,QAAQ;AAAA,YAAA;AAAA,UACV;AAAA,UAEFG,MAAM,CAAC,MAAM;AAAA,QAAA;AAAA,MACf;AAAA,MAEFQ,SAAS;AAAA,IAAA;AAAA,EACX;AAAA,EAEFA,SAAS;AACX,CAAC,GCpFYC,sBAIT,SAAArC,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GACF;AAAA,IAAAC,SAAAA;AAAAA,IAAAmC;AAAAA,EAAAA,IAA4BtC;AAAK,MAAAI;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEcpC,SAAEH,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAjD,QAAAwC,cAAoBC,MAAAA,OAA2BtC,EAAE;AAAC,MAAAC,IAAAsC;AAAA1C,WAAAE,YAExCE,KAAAA,MACDF,UAAOG,GAAK,+BAA+B,OACzC;AAAA,IAAAsC,OAAQH,YAAWI;AAAAA,EAAAA,EAC3B,GACAF,KAAA,CAACxC,QAAO,GAACF,OAAAE,UAAAF,OAAAI,IAAAJ,OAAA0C,OAAAtC,KAAAJ,EAAA,CAAA,GAAA0C,KAAA1C,EAAA,CAAA,IAJZO,gBAAUH,IAIPsC,EAAS;AAAC,MAAAG;AAAA7C,WAAAE,YAGX2C,KAAAA,CAAAC,KAAAC,UAAA;AACEP,gBAAWI,QAASE,GAAG,IAAIC,OAC3B7C,UAAO8C,KAAO,6BAA6B;AAAA,MAAAF;AAAAA,MAAAC;AAAAA,IAAAA,CAAY;AAAA,EAAC,GACzD/C,OAAAE,UAAAF,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA;AAJH,QAAAiD,WAAiBJ;AAMhB,MAAAK;AAAAlD,WAAAE,YAGCgD,KAAAC,CAAAA,UAAA;AACEjD,IAAAA,UAAO8C,KAAO,6BAA6B;AAAA,MAAAF,KAACA;AAAAA,IAAAA,CAAI,GAChD,OAAON,YAAWI,QAASE,KAAG;AAAA,EAAC,GAChC9C,OAAAE,UAAAF,OAAAkD,MAAAA,KAAAlD,EAAA,CAAA;AAJH,QAAAoD,cAAoBF;AAMnB,MAAAG;AAAArD,IAAA,CAAA,MAAAoD,eAAApD,SAAAiD,YAGQI,KAAA;AAAA,IAAAD;AAAAA,IAAAH;AAAAA,EAAAA,GAAuBjD,OAAAoD,aAAApD,OAAAiD,UAAAjD,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AADhC,QAAAmB,UACSkC;AAER,MAAAC;AAAA,SAAAtD,EAAA,EAAA,MAAAqC,YAAArC,UAAAmB,WAGCmC,KAAAC,2BAAAA,IAAAC,YAAAA,+BAAA,UAAA,EAAgDrC,OAAAA,SAC7CkB,SAAAA,CACH,GAA0CrC,QAAAqC,UAAArC,QAAAmB,SAAAnB,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA,GAF1CsD;AAE0C,GCzCxCG,SAAOC,iBAAAA,OAAOC;AAAAA;AAAAA;AAAAA;AAAAA,GAMPC,QAAuC,SAAAzD,IAAA;AAAA,QAAAH,IAAAC,uBAAA,EAAA,GAAU;AAAA,IAAAoC;AAAAA,IAAAwB,aAAAzD;AAAAA,IAAAc;AAAAA,IAAA4C;AAAAA,IAAAC;AAAAA,IAAAC,OAAAtB;AAAAA,EAAAA,IAAAvC,IAE5D0D,cAAAzD,OAAA6D,SAAA,OAAA7D,IAIA4D,QAAAtB,OAAAuB,SAAA,IAAAvB,IAEAvB,UAAgB+C,MAAAA,WAAWC,YAAAA,yBAAyB;AAEpD,MAAIhD,YAAY;AACd,UAAMiD,MAAM,iEAAiE;AAG/E,QAAA;AAAA,IAAAC;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,EAAAA,IAA4DpD;AAAO,MAAA0B;AAAA7C,IAAA,CAAA,MAAAqE,iBAAArE,SAAAkB,MAErD2B,KAAAwB,cAAcnD,EAAE,GAAClB,OAAAqE,eAAArE,OAAAkB,IAAAlB,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA;AAA/B,QAAAwE,QAAc3B;AAAiB,MAAAK,IAAAG;AAAArD,IAAA,CAAA,MAAA6D,eAAA7D,EAAA,CAAA,MAAAkB,MAAAlB,EAAA,CAAA,MAAA+D,YAAA/D,SAAA8D,YAAA9D,EAAA,CAAA,MAAAgE,SAAAhE,EAAA,CAAA,MAAAsE,mBAAAtE,EAAA,CAAA,MAAAuE,qBAEfrB,KAAAA,OACdoB,gBAAgBpD,IAAI;AAAA,IAAAA;AAAAA,IAAAuD,MAEZ;AAAA,IAAOZ;AAAAA,IAAAE,UAEHA,YAAA;AAAA,IAAgBD,UAChBA,YAAA;AAAA,IAAaE;AAAAA,EAAAA,CAExB,GAEM,MAAA;AACLO,sBAAkBrD,EAAE;AAAA,EAAC,IAEtBmC,KAAA,CAACnC,IAAI2C,aAAaG,OAAOD,UAAUD,UAAUQ,iBAAiBC,iBAAiB,GAACvE,OAAA6D,aAAA7D,OAAAkB,IAAAlB,OAAA+D,UAAA/D,OAAA8D,UAAA9D,OAAAgE,OAAAhE,OAAAsE,iBAAAtE,OAAAuE,mBAAAvE,QAAAkD,IAAAlD,QAAAqD,OAAAH,KAAAlD,EAAA,EAAA,GAAAqD,KAAArD,EAAA,EAAA,IAbnF0E,sBAAgBxB,IAabG,EAAgF;AAAC,MAAAC;AAAA,SAAAtD,EAAA,EAAA,MAAAqC,YAAArC,UAAAwE,SAE7ElB,KAAAC,2BAAAA,IAACE,QAAA,EAAYe,OAAQnC,SAAAA,CAAS,GAAOrC,QAAAqC,UAAArC,QAAAwE,OAAAxE,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA,GAArCsD;AAAqC;ACnDvC,SAASqB,SACdC,IACAC,SACG;AACH,MAAIC;AACJ,SAAQ,IAAIC,SAAwB;AAClCC,iBAAaF,KAAK,GAClBA,QAAQG,WAAW,MAAM;AACvBL,SAAGM,MAAMN,IAAIG,IAAI;AAAA,IACnB,GAAGF,OAAO;AAAA,EACZ;AACF;ACNA,MAAMM,UAAU,uBAIVC,gBAAgBA,MAEbC,KAAKC,MAAMC,aAAaC,QAAQL,OAAO,KAAK,IAAI,GAEnDM,gBAAiBC,CAAAA,SAA4B;AACjDH,eAAaI,QAAQR,SAASE,KAAKO,UAAUF,IAAI,CAAC;AACpD,GAEMG,kBAAmBC,CAAAA,WAChBA,OAAOC,IAAKC,CAAAA,UAAU,CAACA,MAAM9E,IAAI8E,MAAMhC,KAAK,EAAEiC,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAG;AAGnE,SAAAC,mBAAA;AAAA,QAAAlG,IAAAC,qBAAAA,EAAA,CAAA,GAMHkG,MAAYC,UAQZC,MAAYC;AAQX,MAAAnG;AAAA,MAAAH,EAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,GAAA;AAED,UAAAgE,eAAqB5B,SAAS0B,KAAK,GAAG;AAC/BlG,SAAA;AAAA,MAAAgG;AAAAA,MAAAE;AAAAA,MAAAE;AAAAA,IAAAA,GAINvG,OAAAG;AAAAA,EAAA;AAAAA,SAAAH,EAAA,CAAA;AAAA,SAJDG;AAIC;AA7BE,SAAAmG,SAAAE,UAAAC,QAAA;AAeD,QAAAC,WAAetB,iBACfjC,QAAY0C,gBAAgBC,QAAM,GAClCJ,OAAa;AAAA,IAAA,GACRiB;AAAAA,IAAM,CACR7D,KAAG,GAAG2D;AAAAA,EAAAA;AAEThB,gBAAcC,IAAI;AAAC;AArBlB,SAAAU,SAAAN,QAAA;AAOD,QAAAa,SAAevB,cAAAA,GACftC,MAAY+C,gBAAgBC,MAAM;AAAC,SAC5Bc,MAAKC,QAASF,OAAO7D,GAAG,CAA4C,KAAtC6D,OAAO7D,GAAG,EAACgE,KAAMxG,OAAqB,IAApE2D,SAEH0C,OAAO7D,GAAG;AAAC;AAXd,SAAAxC,QAAAyG,KAAA;AAAA,SAS8DA,QAAQ;AAAI;ACrBjF,SAASC,aAAahB,OAAqBiB,WAAmBC,gBAAwB;AACpF,QAAM;AAAA,IAACnD,UAAUoD;AAAAA,IAAYrD,UAAUsD;AAAAA,EAAAA,IAAcpB,OAC/CjC,WAAWoD,cAAc,OAAO,MAAOA,aAAaD,iBAAkB,KACtEpD,WAAYsD,aAAaF,iBAAkB;AACjD,SAAOG,KAAKC,IAAIvD,UAAUsD,KAAKE,IAAIzD,UAAUmD,SAAS,CAAC;AACzD;AAGO,SAASO,cACdC,OACAP,gBACAQ,aACAC,YACAC,aACAC,kBACU;AACV,QAAM;AAAA,IAAC/B;AAAAA,IAAQW,QAAQqB;AAAAA,EAAAA,IAAcF,aAC/B;AAAA,IAACnB,QAAQsB;AAAAA,EAAAA,IAAiBF,kBAE1BpB,SAASsB,iBAAiBD,YAC1BE,aAAa,CAAC,GAAGvB,MAAM;AAE7B;AACE,UAAMwB,cAAaR,QAAQ,IAAIE,aAAaD,aACtCQ,SAAQpC,OAAOqC,UAAWnC,CAAAA,UAAUA,MAAM9E,OAAO+G,YAAW/G,EAAE,GAC9DkH,QAAQ3B,OAAOyB,MAAK,GACpBjB,YAAYD,aAAaiB,aAAYG,QAAQf,KAAKgB,IAAIZ,KAAK,GAAGP,cAAc;AAClF,QAAIkB,UAAUnB;AACZ,aAAOR;AAETgB,YAAQA,QAAQ,IAAIW,QAAQnB,YAAYA,YAAYmB;AAAAA,EACtD;AAEA,MAAIE,eAAe,GACfL,aAAaR,QAAQ,IAAIC,cAAcC,YACvCO,QAAQpC,OAAOqC,UAAWnC,CAAAA,UAAUA,MAAM9E,OAAO+G,WAAW/G,EAAE;AAElE,aAAa;AACX,UAAM8E,QAAQF,OAAOoC,KAAK,GACpBE,QAAQ3B,OAAOyB,KAAK,GAEpBK,iBAAiBlB,KAAKgB,IAAIZ,KAAK,IAAIJ,KAAKgB,IAAIC,YAAY,GAExDrB,YAAYD,aAAahB,OAAOoC,QAAQG,gBAAgBrB,cAAc;AAE5E,QAAIkB,UAAUnB,cACZqB,gBAAgBF,QAAQnB,WACxBe,WAAWE,KAAK,IAAIjB,WAGlBqB,aAAaE,YAAY,EAAE,EAAEC,cAAcpB,KAAKgB,IAAIZ,KAAK,EAAEe,YAAY,EAAE,GAAGvE,QAAW;AAAA,MACrFyE,SAAS;AAAA,IAAA,CACV,KAAK;AAEN;AAIJ,QAAIjB,QAAQ;AACV,UAAI,EAAES,QAAQ;AACZ;AAAA,eAEO,EAAEA,SAASpC,OAAO6C;AAC3B;AAAA,EAEJ;AAEA,SAAIL,iBAAiB,IACZ7B,UAGTwB,aAAaR,QAAQ,IAAIE,aAAaD,aACtCQ,QAAQpC,OAAOqC,UAAWnC,WAAUA,MAAM9E,OAAO+G,WAAW/G,EAAE,GAC9D8G,WAAWE,KAAK,IAAIzB,OAAOyB,KAAK,IAAII,cAE7BN;AACT;AAEO,SAASY,cAAc9C,QAAwB5E,IAAYuF,QAA0B;AAC1F,MAAIX,OAAO6C,WAAW,EAAG,QAAO;AAEhC,QAAMT,QAAQpC,OAAOqC,UAAWnC,CAAAA,UAAUA,MAAM9E,OAAOA,EAAE,GACnDkH,QAAQ3B,OAAOyB,KAAK;AAE1B,SAAIE,SAAS,OAAa,MAEnBA,MAAMI,YAAY,EAAE;AAC7B;AAEO,SAASK,UACd/G,OACAgH,eACAC,gBAAwB,GACxBC,2BAA2C,MACnC;AACR,QAAMC,gBAAgBnH,MAAMoH,SAGtBC,iBADOH,4BAA4BF,cAAcM,yBAC5BC;AAE3B,SAAOJ,gBAAgBE,gBAAgBJ;AACzC;AAEO,SAASO,QAAQC,SAAiE;AACvF,SAAOA,QAAQ9E,SAAS;AAC1B;AAEO,SAAS+E,UAAUD,SAAmE;AAC3F,SAAOA,QAAQ9E,SAAS;AAC1B;AAEO,SAASgF,kBAAkBC,UAA4D;AAC5F,SAAO9C,MAAM+C,KAAKD,SAASE,QAAQ,EAAEC,KAAK,CAAC;AAAA,IAAC7F,OAAO8F;AAAAA,EAAAA,GAAI;AAAA,IAAC9F,OAAO+F;AAAAA,EAAAA,MACzDD,KAAK,QAAQC,KAAK,OAAa,IAC/BD,KAAK,OAAa,KAClBC,KAAK,OAAa,IACfD,IAAIC,CACZ;AACH;AAEO,SAASC,eACdlE,QACAmE,kBACA/C,gBACU;AAEV,QAAMgD,QAAQD,iBAAiBE,OAAO,CAACD,QAAO9B,UAAU8B,SAAQ9B,OAAO,CAAC,GAClE3B,SAAS,CAAC,GAAGwD,gBAAgB,EAAElE,IAAKqC,CAAAA,UAAWA,QAAQ8B,QAAS,GAAG;AAEzE,MAAIE,iBAAiB;AAErB,WAASlC,QAAQ,GAAGA,QAAQpC,OAAO6C,QAAQT,SAAS;AAClD,UAAMlC,QAAQF,OAAOoC,KAAK,GACpBE,QAAQ3B,OAAOyB,KAAK,GACpBjB,YAAYD,aAAahB,OAAOoC,OAAOlB,cAAc;AACvDkB,aAASnB,cACXmD,kBAAkBhC,QAAQnB,WAC1BR,OAAOyB,KAAK,IAAIjB;AAAAA,EAEpB;AAEA,MAAImD,eAAeC,QAAQ,CAAC,MAAM;AAChC,aAASnC,QAAQ,GAAGA,QAAQpC,OAAO6C,QAAQT,SAAS;AAClD,YAAMlC,QAAQF,OAAOoC,KAAK;AAE1B,UAAI;AAAA,QAACnE;AAAAA,QAAUD;AAAAA,MAAAA,IAAYkC;AAE3BlC,iBAAYA,WAAWoD,iBAAkB,KACrCnD,YAAY,SACdA,WAAYA,WAAWmD,iBAAkB;AAG3C,YAAMkB,QAAQf,KAAKC;AAAAA;AAAAA,QAEjBvD,YAA8B;AAAA,QAC9BsD,KAAKE,IAAIzD,UAAU2C,OAAOyB,KAAK,IAAIkC,cAAc;AAAA,MAAA;AAGnD,UAAIhC,UAAU3B,OAAOyB,KAAK,MACxBkC,kBAAkBhC,QAAQ3B,OAAOyB,KAAK,GACtCzB,OAAOyB,KAAK,IAAIE,OAEZf,KAAKgB,IAAI+B,cAAc,EAAEC,QAAQ,CAAC,MAAM;AAC1C;AAAA,IAGN;AAGF,SAAO5D;AACT;AAEO,SAAS6D,iBAAiBxE,QAAkC;AACjE,MAAIyE,qBAAqBzE,OAAO6C,QAC5B6B,sBAAsB;AAE1B,QAAMC,kBAAkB3E,OAAOC,IAAKC,CAAAA,UAC9BA,MAAMnC,eACR2G,uBAAuBxE,MAAMnC,aAC7B0G,sBAAsB,GACfvE,MAAMnC,eAER,IACR,GAEK6G,eAAeF,sBAAsBD;AAM3C,SALeE,gBAAgB1E,IAAKqC,CAAAA,UAC9BA,UAAU,OAAasC,eACpBtC,KACR;AAGH;ACrKA,MAAMuC,gBAAgBjH,iBAAAA,OAAOC;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,GAQhBiH,SAA+C,SAAAzK,IAAA;AAAA,QAAAH,IAAAC,uBAAA,EAAA,GAAU;AAAA,IAAAoC;AAAAA,EAAAA,IAAAlC,IACpE0K,WAAiBpI,MAAAA,OAA8B,IAAI;AAAC,MAAArC;AAAAJ,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAECnC,KAAA,oBAAI0K,IAAAA,GAAK9K,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAA9D,QAAA,CAAA0J,UAAAqB,WAAA,IAAgCC,MAAAA,SAAqB5K,EAAS;AAAC,MAAAsC;AAAA1C,WAAA0J,YAElChH,KAAA+G,kBAAkBC,QAAQ,EAACuB,OAAQ3B,OAAO,GAACtJ,OAAA0J,UAAA1J,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAAxE,QAAA8F,SAA6BpD;AAAwD,MAAAG;AAAA7C,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEtCM,KAAA,CAAA,GAAE7C,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA;AAAjD,QAAA,CAAAyG,QAAAyE,SAAA,IAA4BF,eAAmBnI,EAAE,GACjD,CAAAsI,eAAAC,gBAAA,IAA0CJ,MAAAA,SAAwB,IAAI;AAAC,MAAA9H;AAAAlD,IAAA,CAAA,MAAA0J,YAAA1J,SAAA8F,UAAA9F,EAAA,CAAA,MAAAyG,UAEjCvD,KAAA;AAAA,IAAAwG;AAAAA,IAAA5D;AAAAA,IAAAW;AAAAA,EAAAA,GAIrCzG,OAAA0J,UAAA1J,OAAA8F,QAAA9F,OAAAyG,QAAAzG,OAAAkD,MAAAA,KAAAlD,EAAA,CAAA;AAJD,QAAAqL,YAAkB5I,MAAAA,OAAoBS,EAIrC;AAAC,MAAAG;AAAArD,IAAA,CAAA,MAAAmL,iBAAAnL,SAAA8F,UAAA9F,EAAA,EAAA,MAAAyG,UAGApD,KAAAnC,CAAAA,QACS;AAAA,IAAAoK,UACK1C,cAAc9C,QAAQ5E,IAAIuF,MAAM;AAAA,IAAC8E,eAC5BJ,kBAAkB,OAAlBlH,SAAA;AAAA,EAAA,IAElBjE,OAAAmL,eAAAnL,OAAA8F,QAAA9F,QAAAyG,QAAAzG,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AANH,QAAAqE,gBAAsBhB;AAQrB,MAAAC;AAAAtD,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEmCe,KAAAA,CAAAkI,MAAA9F,SAAA;AAClCqF,gBAAYU,CAAAA,SAAA;AACV,UAAIA,KAAIC,IAAKxK,IAAE;AAAC,eAASuK;AACzB,YAAAE,OAAa,IAAIb,IAAIW,IAAI;AACzBE,aAAAA,KAAItF,IAAKnF,MAAIwE,IAAI,GACViG;AAAAA,IAAI,CACZ;AAAA,EAAC,GACH3L,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA;AAPD,QAAAsE,kBAAwBhB;AAOlB,MAAAsI;AAAA5L,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KACgCqJ,KAAAC,CAAAA,SAAA;AACpCd,gBAAYe,CAAAA,WAAA;AACV,UAAI,CAACL,OAAIC,IAAKxK,IAAE;AAAC,eAASuK;AAC1B,YAAAM,SAAa,IAAIjB,IAAIW,MAAI;AACzBE,aAAAA,OAAIK,OAAQ9K,IAAE,GACPyK;AAAAA,IAAI,CACZ;AAAA,EAAC,GACH3L,QAAA4L,MAAAA,KAAA5L,EAAA,EAAA;AAPD,QAAAuE,oBAA0BqH;AAOpB,MAAAK;AAAAjM,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEmC0J,KAAA;AAAA,IAAA/E,gBACvBgF,OAAMC;AAAAA,IAAWC,YACrB;AAAA,IAACzE,YACD;AAAA,IAAID,aACH;AAAA,IAAI2E,cACH;AAAA,IAAEC,aACH;AAAA,IAAIC,QACT;AAAA,IAAC9F,QACD,CAAA;AAAA,EAAA,GACTzG,QAAAiM,MAAAA,KAAAjM,EAAA,EAAA;AATD,QAAAwM,UAAgB/J,MAAAA,OAAyBwJ,EASxC;AAAC,MAAAQ;AAAAzM,YAAA0J,YAGA+C,KAAAA,CAAAC,MAAA5K,UAAA;AACE,UAAA6K,cAAoBlD,kBAAkBC,QAAQ,GAC9CxB,QAAcyE,YAAWxE,UAAWyE,CAAAA,OAAQA,GAAE1L,OAAQA,IAAE,GAExD2L,UAAgBnD,SAAQvD,IAAKjF,IAAE;AAC/B,QAAI,CAAC2L,WAAD,CAAarD,UAAUqD,OAAO;AAAC;AACnC,UAAAC,gBAAsBD,QAAOD,GAAGhK;AAC3BkK,sBAELN,QAAO5J,UAAW;AAAA,MAAAyJ,cACFnE;AAAAA,MAAKR,aACNiF,YAAWxC,OACtB,CAAA4C,KAAAC,MAAAC,MAAiB3D,QAAQsD,IAAe,KAARK,IAAI/E,QAAnB8E,OAAAD,KACjB,IACF;AAAA,MAACpF,YACWgF,YAAWxC,OACrB,CAAA+C,OAAAC,MAAAC,QAAiBL,UAAQ,QAAQzD,QAAQsD,IAAE,KAAKK,MAAI/E,QAAnCiF,OAAAD,OACjB,IACF;AAAA,MAAChG,gBACegF,OAAMC;AAAAA,MAAWI,QACzBzK,MAAKuL;AAAAA,MAAMjB,YACPvD,UAAU/G,OAAOgL,aAAa;AAAA,MAACR,aAC9BQ,cAAa1D,sBAAAA;AAAAA,MAAwB3C,QAC1C4E,UAASzI,QAAQ6D;AAAAA,IAAAA,GAG3B2E,iBAAiBlK,IAAE;AAAA,EAAC,GACrBlB,QAAA0J,UAAA1J,QAAAyM,MAAAA,KAAAzM,EAAA,EAAA;AA5BH,QAAAsN,gBAAsBb;AA8BrB,MAAAc;AAAAvN,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEgCgL,MAAAA,MAAA;AAC/BnC,qBAAiB,IAAI;AAAA,EAAC,GACvBpL,QAAAuN,OAAAA,MAAAvN,EAAA,EAAA;AAFD,QAAAwN,eAAqBD;AAEf,MAAAE;AAAAzN,YAAA0J,YAGJ+D,MAAAA,CAAAC,MAAAC,YAAA;AACE7L,YAAK8L,eAAAA,GACL9L,QAAK+L,gBAAAA;AAEL,UAAA;AAAA,MAAA3G;AAAAA,MAAAkF;AAAAA,MAAA1E;AAAAA,MAAAC;AAAAA,MAAA2E;AAAAA,IAAAA,IAA2EE,QAAO5J;AAGlF,QAAI8E,eAAe,QAAQC,cAAc;AAAI;AAI7C,UAAAmG,YAAgBpE,SAAQvD,IAAKjF,IAAE;AAC/B,QAAI,CAAC2L,aAAD,CAAarD,UAAUqD,SAAO;AAAC;AACnC,UAAAkB,kBAAsBlB,UAAOD,GAAGhK;AAChC,QAAI,CAACkK;AAAa;AAElB,UAAAkB,SAAenF,UAAU/G,SAAOgL,iBAAeV,YAAYE,WAAW;AAEtE,QAAI0B,WAAW;AAAC;AAIhB,UAAA;AAAA,MAAAvH,QAAAqB;AAAAA,IAAAA,IAA6BuD,UAASzI,SACtCqL,OAAapD,SAAQjI,QAAQwG,yBAC7B3B,QAAeuG,SAASC,KAAI7F,QAAU,KAEtCJ,aAAmBR,cACjBC,OACAP,gBACAQ,aACAC,YACA0D,UAASzI,SACT4J,QAAO5J,OACT;AAEsBkF,eAAUhB,KAAM,CAAAoH,WAAAC,QAAkBD,cAAclG,WAAWiF,GAAC,CAAC,KAGjF/B,UAAUlD,UAAU;AAAA,EACrB,GACFhI,QAAA0J,UAAA1J,QAAAyN,OAAAA,MAAAzN,EAAA,EAAA;AAzCH,QAAAoO,OAAaX;AA2CZ,MAAAY,KAAAC;AAAAtO,IAAA,EAAA,MAAA0J,YAAA1J,UAAA8F,UAAA9F,EAAA,EAAA,MAAAyG,UAGe4H,MAAAA,MAAA;AACdhD,cAASzI,QAAQ8G,WAAYA,UAC7B2B,UAASzI,QAAQkD,SAAUA,QAC3BuF,UAASzI,QAAQ6D,SAAUA;AAAAA,EAAH,GACvB6H,OAAC5E,UAAU5D,QAAQW,MAAM,GAACzG,QAAA0J,UAAA1J,QAAA8F,QAAA9F,QAAAyG,QAAAzG,QAAAqO,KAAArO,QAAAsO,QAAAD,MAAArO,EAAA,EAAA,GAAAsO,MAAAtO,EAAA,EAAA,IAJ7B0E,MAAAA,gBAAgB2J,KAIbC,GAA0B;AAE7B,QAAAC,UAAgBrI,iBAAAA;AAAkB,MAAAsI,KAAAC;AAAAzO,IAAA,EAAA,MAAA8F,UAAA9F,UAAAuO,WAGlBC,MAAAA,MAAA;AAEd,UAAA;AAAA,MAAA/H,QAAAiI;AAAAA,IAAAA,IAAiBrD,UAASzI;AAE1B,QAAI6D,SAAMkC,WAAY7C,OAAM6C;AAAO;AAInC,UAAAgG,eAAqBJ,QAAOpI,IAAKL,MAAM;AAEvC,QAAI6I,cAAY;AACd,YAAAC,wBAA8B5E,eAAelE,QAAQ6I,cAAczC,OAAMC,UAAW;AACpFjB,gBAAU0D,qBAAqB;AAAC;AAAA,IAAA;AAIlC,UAAAC,gBAAsBvE,iBAAiBxE,MAAM;AAC7CoF,cAAU2D,aAAa;AAAA,EAAC,GACvBJ,MAAA,CAACF,SAASzI,MAAM,GAAC9F,QAAA8F,QAAA9F,QAAAuO,SAAAvO,QAAAwO,KAAAxO,QAAAyO,QAAAD,MAAAxO,EAAA,EAAA,GAAAyO,MAAAzO,EAAA,EAAA,IAlBpB0E,MAAAA,gBAAgB8J,KAkBbC,GAAiB;AAAC,MAAAK,KAAAC;AAAA/O,IAAA,EAAA,MAAA8F,UAAA9F,UAAAuO,WAAAvO,EAAA,EAAA,MAAAyG,UAGXqI,MAAAA,MAAA;AACHrI,WAAMkC,UACX4F,QAAOhI,aAAcT,QAAQW,MAAM;AAAA,EAAC,GACnCsI,OAACR,SAASzI,QAAQW,MAAM,GAACzG,QAAA8F,QAAA9F,QAAAuO,SAAAvO,QAAAyG,QAAAzG,QAAA8O,KAAA9O,QAAA+O,QAAAD,MAAA9O,EAAA,EAAA,GAAA+O,MAAA/O,EAAA,EAAA,IAH5BO,MAAAA,UAAUuO,KAGPC,GAAyB;AAAC,MAAAC,KAAAC;AAAAjP,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEbyM,MAAAA,MAAA;AACd,UAAAE,iBAAuB,IAAIC,eAAe,MAAA;AAExC,YAAA;AAAA,QAAArJ,QAAAU;AAAAA,QAAAC,QAAA2I;AAAAA,MAAAA,IAAqC/D,UAASzI,SAE9CyM,eAAmBrF,eAAelE,UAAQgC,cAAYoE,OAAMC,UAAW;AAEjDrE,mBAAUhB,KAAM,CAAAwI,aAAAC,QAAkBrB,gBAAclG,aAAWiF,GAAC,CAAC,KAEjF/B,UAAUlD,YAAU;AAAA,IACrB,CACF;AAEDkH,WAAAA,eAAcM,QAAS3E,SAAQjI,OAAS,GAEjC,MAAA;AACLsM,qBAAcO,WAAAA;AAAAA,IAAa;AAAA,EAC5B,GACAR,MAAA,CAAA,GAAEjP,QAAAgP,KAAAhP,QAAAiP,QAAAD,MAAAhP,EAAA,EAAA,GAAAiP,MAAAjP,EAAA,EAAA,IAlBL0E,MAAAA,gBAAgBsK,KAkBbC,GAAE;AAAC,MAAAS;AAAA1P,IAAA,EAAA,MAAAmL,iBAAAnL,EAAA,EAAA,MAAAoO,QAAApO,EAAA,EAAA,MAAAqE,iBAAArE,UAAAsN,iBAGGoC,MAAA;AAAA,IAAAvE;AAAAA,IAAAiD;AAAAA,IAAA/J;AAAAA,IAAAC;AAAAA,IAAAgJ;AAAAA,IAAAE;AAAAA,IAAAjJ;AAAAA,EAAAA,GAQNvE,QAAAmL,eAAAnL,QAAAoO,MAAApO,QAAAqE,eAAArE,QAAAsN,eAAAtN,QAAA0P,OAAAA,MAAA1P,EAAA,EAAA;AATH,QAAAmB,UACSuO;AAkBR,MAAAC;AAAA3P,YAAAqC,YAIGsN,MAAApM,2BAAAA,IAAC,eAAA,EAAmBsH,KAAAA,UAAWxI,SAAAA,CAAS,GAAgBrC,QAAAqC,UAAArC,QAAA2P,OAAAA,MAAA3P,EAAA,EAAA;AAAA,MAAA4P;AAAA,SAAA5P,EAAA,EAAA,MAAAmB,WAAAnB,UAAA2P,OAD1DC,MAAArM,2BAAAA,IAAAY,YAAAA,0BAAA,UAAA,EAA2ChD,OAAAA,SACzCwO,UAAAA,IAAAA,CACF,GAAqC3P,QAAAmB,SAAAnB,QAAA2P,KAAA3P,QAAA4P,OAAAA,MAAA5P,EAAA,EAAA,GAFrC4P;AAEqC;AC5PlC,SAAAC,UAAA9P,OAAA;AAAA,QAAAC,IAAAC,qBAAAA,EAAA,EAAA;AAAA,MAAAoC,UAAAyN,SAAAC,kBAAAC,SAAAC;AAAAjQ,WAAAD,SAQL;AAAA,IAAAsC;AAAAA,IAAAyN;AAAAA,IAAAE;AAAAA,IAAAD;AAAAA,IAAA,GAAAE;AAAAA,EAAAA,IAAqElQ,OAAKC,OAAAD,OAAAC,OAAAqC,UAAArC,OAAA8P,SAAA9P,OAAA+P,kBAAA/P,OAAAgQ,SAAAhQ,OAAAiQ,cAAA5N,WAAArC,EAAA,CAAA,GAAA8P,UAAA9P,EAAA,CAAA,GAAA+P,mBAAA/P,EAAA,CAAA,GAAAgQ,UAAAhQ,EAAA,CAAA,GAAAiQ,YAAAjQ,EAAA,CAAA;AAE1E,QAAA;AAAA,IAAAkQ;AAAAA,EAAAA,IAAYC,OAAAA,eAAeC,aAAAA,2BAA2B;AAAC,MAAAjQ;AAAAH,WAAAkQ,KAGR/P,KAAA+P,EAAE,8BAA8B,GAAClQ,OAAAkQ,GAAAlQ,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAA,MAAAI;AAAAJ,IAAA,CAAA,MAAAgQ,WAAAhQ,SAAAG,MAA9EC,oCAACiQ,0BAAAA,QAAA,EAAY,MAAA,SAAiBL,SAAAA,SAAe,MAAA7P,GAAAA,CAAiC,GAAIH,OAAAgQ,SAAAhQ,OAAAG,IAAAH,QAAAI,MAAAA,KAAAJ,EAAA,EAAA;AADpF,QAAAsQ,cACElQ;AACD,MAAAsC;AAAA1C,YAAAkQ,KAMSxN,KAAAwN,EAAE,iCAAiC,GAAClQ,QAAAkQ,GAAAlQ,QAAA0C,MAAAA,KAAA1C,EAAA,EAAA;AAAA,MAAA6C;AAAA7C,IAAA,EAAA,MAAA+P,oBAAA/P,UAAA0C,MAJ5CG,oCAACwN,0BAAAA,QAAA,EACM,MAAA,SACA,MAAA,YACIN,2BACH,MAAArN,GAAAA,CAAoC,GAC1C1C,QAAA+P,kBAAA/P,QAAA0C,IAAA1C,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA;AANJ,QAAAuQ,uBACE1N;AAMD,MAAAK;AAAAlD,YAAAkQ,KASchN,KAAAgN,EAAE,kBAAkB,GAAClQ,QAAAkQ,GAAAlQ,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAAA,MAAAqD;AAAArD,YAAAkD,MADxBG,oCAACmN,GAAAA,MAAA,EAAW,SAAU,QAAA,YACnBtN,cACH,GAAOlD,QAAAkD,IAAAlD,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAAA,MAAAsD;AAAAtD,YAAA8P,WACPxM,oCAACkN,GAAAA,MAAA,EAAK,WAAY,SACfV,mBACH,GAAO9P,QAAA8P,SAAA9P,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA;AAAA,MAAA4L;AAAA5L,IAAA,EAAA,MAAAqD,MAAArD,UAAAsD,MANTsI,KAAA6E,2BAAAA,KAACC,GAAAA,OAAA,EAAa,OAAA,GACZrN,UAAAA;AAAAA,IAAAA;AAAAA,IAGAC;AAAAA,EAAAA,EAAAA,CAGF,GAAQtD,QAAAqD,IAAArD,QAAAsD,IAAAtD,QAAA4L,MAAAA,KAAA5L,EAAA,EAAA;AAAA,MAAAiM;AAAAjM,IAAA,EAAA,MAAAuQ,wBAAAvQ,EAAA,EAAA,MAAA+P,oBAAA/P,EAAA,EAAA,MAAAgQ,WAAAhQ,UAAAsQ,eAIPrE,KAAA+D,WAAAD,mBACCU,gCAACE,GAAAA,QAAA,EAAc,OAAA;;IAEZJ;AAAAA,EAAAA,EAAAA,CACH,IACEP,UACFzM,2BAAAA,IAACqN,GAAAA,KAAA,EAAKN,uBAAY,IAChBP,mBACFxM,2BAAAA,IAACqN,GAAAA,KAAA,EAAKL,gCAAqB,IADzB,MAEIvQ,QAAAuQ,sBAAAvQ,QAAA+P,kBAAA/P,QAAAgQ,SAAAhQ,QAAAsQ,aAAAtQ,QAAAiM,MAAAA,KAAAjM,EAAA,EAAA;AAAA,MAAAyM;AAAAzM,IAAA,EAAA,MAAAqC,YAAArC,UAAA4L,MAAA5L,EAAA,EAAA,MAAAiM,MAvBdQ,oCAACoE,GAAAA,MAAA,EAAW,OAAA,UAAgB,QAAA,QAAe,SAAA,UACzC,UAAAtN,2BAAAA,IAACuN,GAAAA,aAAmB,SAAA,GAAU,QAAA,UAAgB,OAAA,GAC5C,UAAAL,2BAAAA,KAACC,GAAAA,OAAA,EAAa,OAAA,GACZ9E,UAAAA;AAAAA,IAAAA;AAAAA;IAWCK;AAAAA,EAAAA,GAUH,EAAA,CACF,GACF,GAAOjM,QAAAqC,UAAArC,QAAA4L,IAAA5L,QAAAiM,IAAAjM,QAAAyM,MAAAA,KAAAzM,EAAA,EAAA;AAAA,MAAAuN;AAAA,SAAAvN,EAAA,EAAA,MAAAiQ,aAAAjQ,UAAAyM,MA3BTc,MAAAhK,2BAAAA,IAACwN,GAAAA,MAAA,EAAY,QAAA,QAAM,GAAKd,WACtBxD,UAAAA,GAAAA,CA2BF,GAAOzM,QAAAiQ,WAAAjQ,QAAAyM,IAAAzM,QAAAuN,OAAAA,MAAAvN,EAAA,EAAA,GA5BPuN;AA4BO;ACtDJ,MAAMyD,YAAYC,MAAAA,WAAW,SAAAlR,OAAAmR,KAAA;AAAA,QAAAlR,IAAAC,qBAAAA,EAAA,EAAA;AAAA,MAAAkR,SAAAC,iBAAAC,WAAAC,MAAAC;AAAA,MAAAvR,SAAAD,OAAA;AAOlC,UAAA;AAAA,MAAAoR,SAAAhR;AAAAA,MAAAkR,WAAAjR;AAAAA,MAAAoR;AAAAA,MAAAJ,iBAAA1O;AAAAA,MAAA6O,cAAA1O;AAAAA,MAAA,GAAAK;AAAAA,IAAAA,IAAmFnD;AAAnFoR,cAAAhR,KAAAkR,YAAAjR,KAAAgR,kBAAA1O,KAAA6O,eAAA1O,IAAAyO,OAAApO,IAAwFlD,OAAAD,OAAAC,OAAAmR,SAAAnR,OAAAoR,iBAAApR,OAAAqR,WAAArR,OAAAsR,MAAAtR,OAAAuR;AAAAA,EAAA;AAAAJ,cAAAnR,EAAA,CAAA,GAAAoR,kBAAApR,EAAA,CAAA,GAAAqR,YAAArR,EAAA,CAAA,GAAAsR,OAAAtR,EAAA,CAAA,GAAAuR,eAAAvR,EAAA,CAAA;AAAA,MAAAG;AAAAH,IAAA,CAAA,MAAAoR,mBAAApR,SAAAuR,gBASnEpR,KAAAsR,OAAMC,QAAS;AAAA,IAAA,GAAIH;AAAAA,IAAY,GAAKH;AAAAA,EAAAA,CAAgB,GAACpR,OAAAoR,iBAAApR,OAAAuR,cAAAvR,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAA,MAAAI;AAAAJ,IAAA,CAAA,MAAAmR,WAAAnR,UAAAqR,aAAArR,EAAA,EAAA,MAAAG,MAH/DC,KAAA;AAAA,IAAAc,IACDiQ;AAAAA,IAAO1M,MACL4M;AAAAA,IAASM,eACAxR;AAAAA,EAAAA,GAChBH,OAAAmR,SAAAnR,QAAAqR,WAAArR,QAAAG,IAAAH,QAAAI,MAAAA,KAAAJ,EAAA,EAAA;AAAA,MAAA0C;AAAA,SAAA1C,EAAA,EAAA,MAAAkR,OAAAlR,UAAAsR,QAAAtR,EAAA,EAAA,MAAAI,MAPHsC,KAAAa,+BAACqO,OAAAA,aAAS,GACJN,MACCJ,KACE,OAAA9Q,GAAAA,CAIN,GACDJ,QAAAkR,KAAAlR,QAAAsR,MAAAtR,QAAAI,IAAAJ,QAAA0C,MAAAA,KAAA1C,EAAA,EAAA,GARF0C;AAQE,CAEL,GCnBYmP,qBAAqBZ,MAAAA,WAAW,SAAAlR,OAAAmR,KAAA;AAAA,QAAAlR,IAAAC,qBAAAA,EAAA,EAAA;AAAA,MAAA6R,YAAAC,cAAAC,eAAAV,MAAAC,cAAAU;AAAAjS,WAAAD,SAI3C;AAAA,IAAA+R;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,IAAAV;AAAAA,IAAA,GAAAD;AAAAA,EAAAA,IAAmFvR,OAAKC,OAAAD,OAAAC,OAAA8R,YAAA9R,OAAA+R,cAAA/R,OAAAgS,eAAAhS,OAAAsR,MAAAtR,OAAAuR,cAAAvR,OAAAiS,aAAAH,aAAA9R,EAAA,CAAA,GAAA+R,eAAA/R,EAAA,CAAA,GAAAgS,gBAAAhS,EAAA,CAAA,GAAAsR,OAAAtR,EAAA,CAAA,GAAAuR,eAAAvR,EAAA,CAAA,GAAAiS,WAAAjS,EAAA,CAAA;AAAA,MAAAG;AAAAH,WAAA8R,cAM3E3R,KAAA+R,OAAAA,eAAeJ,UAAU,GAAC9R,OAAA8R,YAAA9R,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAErB,QAAAI,KAAA6R,UAAQE;AAAQ,MAAAzP;AAAA1C,WAAAgS,iBAEbtP,KAAA0P,OAAAA,aAAaJ,aAAa,GAAChS,OAAAgS,eAAAhS,QAAA0C,MAAAA,KAAA1C,EAAA,EAAA;AAAA,MAAA6C;AAAA7C,YAAAiS,YACtCpP,KAAAoP,YAAA;AAAA,IAAAA,UAAuBA,UAAQ/Q;AAAAA,EAAAA,GAAKlB,QAAAiS,UAAAjS,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA;AAAA,MAAAkD;AAAAlD,IAAA,EAAA,MAAA0C,MAAA1C,UAAA6C,MAFzBK,KAAA;AAAA,IAAA8O,eACAtP;AAAAA,IAA2B,GACtCG;AAAAA,EAAAA,GACL7C,QAAA0C,IAAA1C,QAAA6C,IAAA7C,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAAA,MAAAqD;AAAA,SAAArD,EAAA,EAAA,MAAA+R,gBAAA/R,EAAA,EAAA,MAAAkR,OAAAlR,EAAA,EAAA,MAAAsR,QAAAtR,UAAAuR,gBAAAvR,EAAA,EAAA,MAAAG,MAAAH,EAAA,EAAA,MAAAI,MAAAJ,EAAA,EAAA,MAAAkD,MATHG,oCAAC,aAAS,GACJiO,MACCJ,KACI,SAAA/Q,IACE4R,WAAAA,cACG,cAAA3R,IACG,iBAAA8C,IAIHqO,aAAAA,CAAY,GAC1BvR,QAAA+R,cAAA/R,QAAAkR,KAAAlR,QAAAsR,MAAAtR,QAAAuR,cAAAvR,QAAAG,IAAAH,QAAAI,IAAAJ,QAAAkD,IAAAlD,QAAAqD,MAAAA,KAAArD,EAAA,EAAA,GAXFqD;AAWE,CAEL;ACND,SAASgP,kBAAkBF,SAAkC,IAAY;AACvE,QAAMG,QAAQb,OAAOC,QAAQS,MAAM,EAChCpM,IAAI,CAAC,CAACjD,KAAKC,KAAK,MAAM,GAAGD,GAAG,IAAIC,KAAK,EAAE,EACvCkD,KAAK,GAAG;AAEX,SAAOqM,MAAM3J,SAAS,IAAI2J,KAAK,KAAK;AACtC;AAEA,SAASC,6BAA6BC,YAAgD;AACpF,QAAMC,UAAU,CACd,WACA,WACA,eACA,WACA,OACA,SACA,YACA,MAAM,GAGFC,iBAAiBjB,OAAOC,QAAQc,UAAU,EAC7CvH,OAAO,CAAC,CAACnI,GAAG,MAAM2P,QAAQE,SAAS7P,GAAG,CAAC,EACvCqH,OAAO,CAACyI,KAAK,CAAC9P,KAAKC,KAAK,MACnBA,SAASkB,OAAkB2O,MACxB;AAAA,IAAC,GAAGA;AAAAA,IAAK,CAAC9P,GAAG,GAAGC;AAAAA,EAAAA,GACtB,EAAE;AAEP,SAAOsP,kBAAkBK,cAAc;AACzC;AAEA,MAAMG,WAAW5B,MAAAA,WAAW,SAAAlR,OAAAmR,KAAA;AAAA,QAAAlR,IAAAC,qBAAAA,EAAA,CAAA;AAAA,MAAAgQ,WAAAsB;AAAAvR,WAAAD,SAI1B;AAAA,IAAAwR;AAAAA,IAAA,GAAAtB;AAAAA,EAAAA,IAAqClQ,OAAKC,OAAAD,OAAAC,OAAAiQ,WAAAjQ,OAAAuR,iBAAAtB,YAAAjQ,EAAA,CAAA,GAAAuR,eAAAvR,EAAA,CAAA;AAAA,MAAAG;AAAAH,WAAAuR,gBAK/BpR,KAAA;AAAA,IAAAsE,MACCR;AAAAA,IAAS0N,eACAF,OAAMC,QAASH,YAAY;AAAA,EAAA,GAC3CvR,OAAAuR,cAAAvR,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAA,MAAAI;AAAA,SAAAJ,EAAA,CAAA,MAAAkR,OAAAlR,SAAAiQ,aAAAjQ,EAAA,CAAA,MAAAG,MANHC,KAAAmD,2BAAAA,IAACqO,OAAAA,WAAA,EAAS,GACJ3B,WACCiB,KACE,OAAA/Q,IAIA8D,OAAAA,QAAS,GAChBjE,OAAAkR,KAAAlR,OAAAiQ,WAAAjQ,OAAAG,IAAAH,OAAAI,MAAAA,KAAAJ,EAAA,CAAA,GARFI;AAQE,CAEL;AAUM,SAAA0S,+BAAA/S,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GAGL;AAAA,IAAAoC;AAAAA,IAAA0Q;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,IAAA1B;AAAAA,IAAA2B;AAAAA,EAAAA,IAA4FnT,OAE5F;AAAA,IAAA4C,OAAAwQ;AAAAA,IAAAC;AAAAA,EAAAA,IAAmDC,iBAAAA;AAAW,MAAAlT;AAAAH,IAAA,CAAA,MAAAmT,YAAAxB,iBAEzBxR,KAAAsR,OAAM6B,YAAaH,YAAWxB,iBAAX,CAAA,CAA+B,GAAC3R,EAAA,CAAA,IAAAmT,YAAAxB,eAAA3R,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAxF,QAAAuT,qBAA2BC,OAAAA,UAAUrT,EAAmD;AAAC,MAAAC;AAAAJ,IAAA,CAAA,MAAAoT,wBAAApT,SAAAuT,sBAAAvT,EAAA,CAAA,MAAAmT,eAGvF/S,KAAAoS,CAAAA,eAAA;AACE,UAAAiB,OAAaL,qBAAqBD,WAAW,GAC7CO,KAAWnB,6BAA6B;AAAA,MAAA,GACnCgB;AAAAA,MAAkB,GAClBf;AAAAA,IAAAA,CACJ;AAAC,WACK,GAAGiB,IAAI,GAAGC,EAAE;AAAA,EAAE,GACtB1T,OAAAoT,sBAAApT,OAAAuT,oBAAAvT,OAAAmT,aAAAnT,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AARH,QAAA2T,uBAA6EvT;AAU5E,MAAAsC;AAAA1C,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAOYG,SAAE1C,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAEH,QAAA6C,KAAAoQ;AAAsB,MAAA/P;AAAAlD,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAGZW,KAAA,CAAA,GAAElD,OAAAkD,MAAAA,KAAAlD,EAAA,CAAA;AAAA,MAAAqD;AAAArD,IAAA,CAAA,MAAAkT,QAAAlT,SAAAuR,gBACTlO,KAAA4N,MAAAA,WACT,SAAA2C,gBAAA1C,KAAA;AACE,UAAA;AAAA,MAAAC;AAAAA,MAAA,GAAAG;AAAAA,IAAAA,IAA2BsC,gBAC3BC,MAAYX,MAAIY,KAAOC,CAAAA,MAAOA,EAACC,QAAS7C,WAAWe,OAAAA,eAAe6B,EAACC,GAAI,MAAM7C,OAAO;AAEpF,WAAK0C,MAMHtQ,2BAAAA,IAAC,WAAA,EAAS,GACJ+N,MACCJ,KACIC,SACE,WAAA0C,IAAGI,OACA1C,cAAY,KAV5B2C,QAAOC,KAAM,6CAA6ChD,OAAO,GAAG,GAC7D;AAAA,EAUL,CAGR,GAACnR,OAAAkT,MAAAlT,OAAAuR,cAAAvR,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAAA,MAAAsD;AAAAtD,YAAAuR,gBACSjO,KAAA2N,iBACR,SAAAmD,eAAAC,OAAA;AAAA,0CACU,UAAA,EAAQ,GAAKD,eAAoBlD,KAAAA,OAAmBK,cAAY;AAAA,EAAI,CAEhF,GAACvR,QAAAuR,cAAAvR,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA;AAAA,MAAA4L;AAAA5L,YAAAuR,gBACmB3F,KAAAqF,iBAClB,SAAAqD,kBAAAC,OAAA;AAAA,0CACU,oBAAA,EAAkB,GAAKX,kBAAqB1C,KAAAA,OAAmBK,cAAY;AAAA,EAAI,CAE3F,GAACvR,QAAAuR,cAAAvR,QAAA4L,MAAAA,KAAA5L,EAAA,EAAA;AAAA,MAAAiM;AAAAjM,YAAA+S,mBAOoB9G,KAAAuI,CAAAA,YAAA;AACnB,UAAA;AAAA,MAAAtT;AAAAA,MAAA+Q;AAAAA,MAAAxN;AAAAA,MAAAuN;AAAAA,MAAAyC;AAAAA,IAAAA,IAAqDD;AACrDzB,oBAAgB;AAAA,MAAApQ,OACP;AAAA,QAAAzB;AAAAA,QAAAuD;AAAAA,MAAAA;AAAAA,MAAU0N,QACT;AAAA,QAAAF,UACIA,SAAQ/Q;AAAAA,QAAG8Q,eACNI,UAAAA,SAAaJ,aAAa;AAAA,QAACyC;AAAAA,MAAAA;AAAAA,IAE5C,CACD;AAAA,EAAC,GACHzU,QAAA+S,iBAAA/S,QAAAiM,MAAAA,KAAAjM,EAAA,EAAA;AAAA,MAAAyM;AAAAzM,IAAA,EAAA,MAAA2T,wBAAA3T,EAAA,EAAA,MAAAgT,qBAAAhT,EAAA,EAAA,MAAA6C,MAAA7C,UAAAqD,MAAArD,EAAA,EAAA,MAAAsD,MAAAtD,EAAA,EAAA,MAAA4L,MAAA5L,EAAA,EAAA,MAAAiM,MAzDIQ,KAAA;AAAA,IAAAvE,OACE;AAAA,IAACwM,YACI;AAAA,IAACC,cACC;AAAA,IAACC,SACNlS;AAAAA,IAAEyP,QAEHtP;AAAAA,IAAsBgS,kBACZ;AAAA,IAAKC,aACV;AAAA,IAACC,kBACI7R;AAAAA,IAAE8N,WACT3N;AAAAA,IAoBVwP,UACSvP;AAAAA,IAITuO,oBACmBjG;AAAAA,IAInBoJ,mBACkB1U;AAAAA,IAElB2U,sBACqB7O;AAAAA,IAErB8O,qBACoBjJ;AAAAA,IAUpBkJ,gBACe7O;AAAAA,IAEf8O,cACaC;AAAAA,IAEbC,kBACiBC;AAAAA,IAEjBC,SACQC;AAAAA,IAERC,WACU1C;AAAAA,IAAiB2C,YAChBC;AAAAA,IAEXC,gBACeC;AAAAA,IAEfnC;AAAAA,EAAAA,GAEF3T,QAAA2T,sBAAA3T,QAAAgT,mBAAAhT,QAAA6C,IAAA7C,QAAAqD,IAAArD,QAAAsD,IAAAtD,QAAA4L,IAAA5L,QAAAiM,IAAAjM,QAAAyM,MAAAA,KAAAzM,EAAA,EAAA;AA/EH,QAAAmB,UACEsL;AAsFA,MAAAc;AAAA,SAAAvN,EAAA,EAAA,MAAAqC,YAAArC,UAAAmB,WAEKoM,MAAAhK,2BAAAA,IAAAwS,UAAAA,kBAAA,UAAA,EAAmC5U,OAAAA,SAAUkB,SAAAA,CAAS,GAA6BrC,QAAAqC,UAAArC,QAAAmB,SAAAnB,QAAAuN,OAAAA,MAAAvN,EAAA,EAAA,GAAnFuN;AAAmF;AA9GrF,SAAAuI,OAAAE,YAAAC,cAAAC,WAAA;AAiGChC,UAAOC,KAAM,kBAAkB6B,YAAYC,cAAczB,SAAO;AAAC;AAjGlE,SAAAoB,SAAAhB,SAAA;AA8FCV,UAAOC,KAAM,cAAcS,OAAO;AAAC;AA9FpC,SAAAa,SAAAU,QAAA;AA0FCjC,UAAOC,KAAM,WAAWgC,MAAM;AAAC;AA1FhC,SAAAZ,SAAAa,QAAA;AAuFClC,UAAOC,KAAM,oBAAoBkC,MAAI;AAAC;AAvFvC,SAAAhB,WAAA;AAoFCnB,UAAOC,KAAM,cAAc;AAAC;AApF7B,SAAA7N,SAAA+P,MAAA;AAiFCnC,UAAOC,KAAM,kBAAkBkC,IAAI;AAAC;AAjFrC,SAAAjQ,WAAA;AAmEC8N,UAAOC,KAAM,sBAAsB;AAAC;AAnErC,SAAA7T,UAAA;AAgEC,QAAM,IAAI8D,MAAM,mCAAmC;AAAC;ACtH5D,MAAMkS,aAAa5S,iBAAAA,OAAO6S,oBAAU;AAAA;AAAA,GAI9B9S,OAAOC,iBAAAA,OAAOmN,OAAI;AAAA;AAAA;AAAA;AAAA;AAAA,GAOlB2F,gBAAc9S,iBAAAA,OAAO+S,OAAI;AAAA;AAAA;AAIxB,SAAAC,iBAAA3W,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GAOL;AAAA,IAAA0W;AAAAA,IAAA5D;AAAAA,IAAAC;AAAAA,IAAAzB;AAAAA,IAAA2B;AAAAA,EAAAA,IAAoFnT,OAEpF;AAAA,IAAAmQ;AAAAA,EAAAA,IAAYC,OAAAA,eAAeC,aAAAA,2BAA2B,GACtD;AAAA,IAAAwG;AAAAA,EAAAA,IAAkBC,iCAAAA;AAAqB,MAAA1W;AAAA,MAAAH,EAAA,CAAA,MAAA2W,mBAAAG,UAAA9C,OAAAhU,EAAA,CAAA,MAAAkT,MAAA;AAAA,QAAA9S;AAAAJ,MAAA,CAAA,MAAA2W,mBAAAG,UAAA9C,OAKzB5T,MAAA2T,CAAAA,MAAO7B,OAAAA,eAAe6B,EAACC,GAAI,MAAM2C,mBAAiBG,UAAe9C,KAAAhU,EAAA,CAAA,IAAA2W,mBAAAG,UAAA9C,KAAAhU,OAAAI,OAAAA,MAAAJ,EAAA,CAAA,GAD3EG,KAAA+S,KAAIjI,OACM7K,GAAiE,EAAC2F,IACrEzF,OAA4B,GAACN,EAAA,CAAA,IAAA2W,mBAAAG,UAAA9C,KAAAhU,OAAAkT,MAAAlT,OAAAG;AAAAA,EAAA;AAAAA,SAAAH,EAAA,CAAA;AAJxC,QAAA+W,MAEI5W;AAIH,MAAAC;AAAAJ,WAAA+W,OAKY3W,KAAA;AAAA,IAAA6K,QACC;AAAA,IAAakH,QACb;AAAA,MAAA4E;AAAAA,IAAAA;AAAAA,EAAI,GAEb/W,OAAA+W,KAAA/W,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAA,MAAA0C;AAAA1C,WAAAkQ,KAEMxN,KAAAwN,EAAE,wCAAwC,GAAClQ,OAAAkQ,GAAAlQ,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAAA,MAAA6C;AAAA7C,IAAA,CAAA,MAAAI,MAAAJ,UAAA0C,MAR7CG,KAAA;AAAA,IAAA3B,IACD;AAAA,IAAOsT,SACFpU;AAAAA,IAIR4W,gBACe;AAAA,IAAEC,OACXvU;AAAAA,IAA2C+B,MAC5C;AAAA,EAAA,GACPzE,OAAAI,IAAAJ,QAAA0C,IAAA1C,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA;AAXH,QAAAqW,OACSxT,IAcT,CAAAqU,aAAAC,cAAA,IAAsCnM,MAAAA,SAG5B,IAAI;AAAC,MAAA9H;AAAAlD,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEiBW,KAAAA,MAAMiU,eAAe,IAAI,GAACnX,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAA1D,QAAAoX,cAAoBlU,IAEpB,CAAA+P,eAAA,IAA0BjI,MAAAA,SAAS5E,QAAU;AAAC,MAAA/C;AAAArD,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAGpCc,KAAAA,MAAM8T,eAAe,IAAI,GAACnX,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAAA,MAAAsD;AAEpC,MAFoCtD,UAAAkT,QAAE5P,KAAA,CAAC4P,IAAI,GAAClT,QAAAkT,MAAAlT,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA,GAA5CO,MAAAA,UAAU8C,IAA4BC,EAAM,GAExC4T,aAAW;AAAA,QAAAtL;AAAA5L,cAAAkQ,KAEkBtE,MAAAsE,EAAE,+BAA+B,GAAClQ,QAAAkQ,GAAAlQ,QAAA4L,OAAAA,MAAA5L,EAAA,EAAA;AAAA,QAAAiM;AAAAjM,MAAA,EAAA,MAAA4W,WAAA5W,UAAAkX,eAAAlX,EAAA,EAAA,MAAAkQ,KAC5DjE,MAAA2K,WAECrT,2BAAAA,IAACwN,GAAAA,MAAA,EAAc,UAAA,QAAgB,SAAA,GAAW,QAAA,GAAQ,MAAA,YAChD,UAAAN,2BAAAA,KAACC,GAAAA,OAAA,EAAa,UACZ,UAAA;AAAA,MAAAnN,2BAAAA,IAAC8T,GAAAA,SAAM,OAAA,IAAY,MAAA,GAChBnH,UAAAA,EAAE,0BAA0B,GAC/B;AAAA,qCACCsG,eAAA,EAAkB,MAAA,GAAIU,UAAAA,YAAW7V,MAAMyO,QAAAA,CAAS;AAAA,IAAA,GACnD,EAAA,CACF,GACD9P,QAAA4W,SAAA5W,QAAAkX,aAAAlX,QAAAkQ,GAAAlQ,QAAAiM,OAAAA,MAAAjM,EAAA,EAAA;AAAA,QAAAyM;AAAA,WAAAzM,EAAA,EAAA,MAAA4L,OAAA5L,UAAAiM,OAXHQ,oCAAC,WAAA,EAAgB,MAAA,GAAY,SAAAb,KAA6CwL,SAAAA,aACvEnL,UAAAA,IAAAA,CAWH,GAAYjM,QAAA4L,KAAA5L,QAAAiM,KAAAjM,QAAAyM,MAAAA,KAAAzM,EAAA,EAAA,GAZZyM;AAAAA,EAYY;AAEf,MAAAb;AAAA5L,YAAAqW,QAaSzK,KAAArI,2BAAAA,IAAC,MAAA,EAAe,WAAA,UAAe,MAAA,GAC7B,UAAAA,2BAAAA,IAAC+T,UAAAA,kBAAA,EACQ,OAAA,GACA,QAAA,SACDjB,MAEE,SAAA,QAAA,CAAO,EAAA,CAEnB,GAAOrW,QAAAqW,MAAArW,QAAA4L,MAAAA,KAAA5L,EAAA,EAAA;AAAA,MAAAiM;AAAA,SAAAjM,UAAA+S,mBAAA/S,EAAA,EAAA,MAAAgT,qBAAAhT,EAAA,EAAA,MAAAkT,QAAAlT,EAAA,EAAA,MAAAuR,gBAAAvR,UAAAiT,mBAAAjT,EAAA,EAAA,MAAA4L,MAlBfK,oCAACsL,0BAAAA,eAAA,EAAuBJ,SAAAA,gBACtB,UAAA5T,2BAAAA,IAAC,cACC,UAAAA,+BAACiU,UAAAA,uBAAA,EACC,UAAAjU,2BAAAA,IAAC,gCAAA,EACkBwP,iBACEC,mBACFC,iBACH1B,cACR2B,MAENtH,cASF,EAAA,CACF,GACF,EAAA,CACF,GAAgB5L,QAAA+S,iBAAA/S,QAAAgT,mBAAAhT,QAAAkT,MAAAlT,QAAAuR,cAAAvR,QAAAiT,iBAAAjT,QAAA4L,IAAA5L,QAAAiM,MAAAA,KAAAjM,EAAA,EAAA,GAtBhBiM;AAsBgB;AAxFb,SAAA7F,WAAA;AAAA,SA0CqC,CAAA;AAAE;AA1CvC,SAAA9F,QAAAmX,KAAA;AAAA,SAgBavF,OAAAA,eAAe6B,IAACC,GAAI;AAAC;AC7BzC,MAAMwC,cAAc9S,iBAAAA,OAAO+S,OAAI;AAAA;AAAA;AAIxB,SAAAiB,aAAA3X,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GASL;AAAA,IAAA6R;AAAAA,IAAAC;AAAAA,IAAA4F;AAAAA,IAAA5E;AAAAA,IAAAC;AAAAA,IAAAzB;AAAAA,IAAA0B;AAAAA,EAAAA,IAQIlT,OACJ;AAAA,IAAAkS;AAAAA,IAAA2F;AAAAA,EAAAA,IAAmC3E,iBAEnC;AAAA,IAAA/C;AAAAA,EAAAA,IAAYC,OAAAA,eAAeC,aAAAA,2BAA2B,GACtD;AAAA,IAAAwG;AAAAA,EAAAA,IAAkBC,iCAAAA;AAAqB,MAAA1W;AAAAH,WAAA4X,kBASbzX,KAAA0X,OAAAA,iBAAiBD,cAAc,GAAC5X,OAAA4X,gBAAA5X,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAA,MAAAI;AAAAJ,IAAA,CAAA,MAAA8R,cAAA9R,EAAA,CAAA,MAAA+R,gBAAA/R,EAAA,CAAA,MAAAG,MAAAH,SAAAiS,YAJ7C7R,KAAA;AAAA,IAAAc,IACH4Q;AAAAA,IAAUrN,MACRsN;AAAAA,IAAYE;AAAAA,IAAA6F,oBAEE3X;AAAAA,EAAAA,GACrBH,OAAA8R,YAAA9R,OAAA+R,cAAA/R,OAAAG,IAAAH,OAAAiS,UAAAjS,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAA,MAAA0C;AAAA1C,IAAA,CAAA,MAAA8R,cAAA9R,SAAAI,MAPIsC,KAAA;AAAA,IAAAxB,IACD4Q;AAAAA,IAAU0C,SACLpU;AAAAA,IAKR6W,OACM;AAAA,IAAExS,MACH;AAAA,EAAA,GACPzE,OAAA8R,YAAA9R,OAAAI,IAAAJ,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAXH,QAAA+X,mBACSrV;AAYR,MAAAG;AAAA7C,IAAA,EAAA,MAAA8R,cAAA9R,UAAA+R,gBAAA/R,EAAA,EAAA,MAAA2X,eAGC9U,KAAA4Q,UACSkE,YAAY;AAAA,IAAAzW,IACb4Q;AAAAA,IAAUrN,MACRsN;AAAAA,IAAY0B,MACZuE,IAAAA,WAAUC,SAAUxE,IAAI;AAAA,EAAA,CAC/B,GACFzT,QAAA8R,YAAA9R,QAAA+R,cAAA/R,QAAA2X,aAAA3X,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA;AAPH,QAAAkY,kBAAwBrV,IAWxB,CAAAqU,aAAAC,cAAA,IAAsCnM,MAAAA,SAG5B,IAAI;AAAC,MAAA9H;AAAAlD,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEiBW,KAAAA,MAAMiU,eAAe,IAAI,GAACnX,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAA1D,QAAAoX,cAAoBlU;AAA2C,MAAAG;AAAArD,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAGrDc,KAAAA,MAAA;AACR8T,mBAAe,IAAI;AAAA,EAAC,GACrBnX,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAAA,MAAAsD;AAED,MAFCtD,EAAA,EAAA,MAAA8R,cAAA9R,UAAA+R,gBAAA/R,EAAA,EAAA,MAAAiT,mBAAE3P,MAACwO,YAAYC,cAAckB,eAAe,GAACjT,QAAA8R,YAAA9R,QAAA+R,cAAA/R,QAAAiT,iBAAAjT,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA,GAF9CO,MAAAA,UAAU8C,IAEPC,EAA2C,GAE1C4T,aAAW;AAAA,QAAAtL;AAAA5L,cAAAkQ,KAEkBtE,MAAAsE,EAAE,0BAA0B,GAAClQ,QAAAkQ,GAAAlQ,QAAA4L,OAAAA,MAAA5L,EAAA,EAAA;AAAA,QAAAiM;AAAAjM,MAAA,EAAA,MAAA4W,WAAA5W,UAAAkX,eAAAlX,EAAA,EAAA,MAAAkQ,KACvDjE,MAAA2K,WAECrT,2BAAAA,IAACwN,GAAAA,MAAA,EAAc,UAAA,QAAgB,SAAA,GAAW,QAAA,GAAQ,MAAA,YAChD,UAAAN,2BAAAA,KAACC,GAAAA,OAAA,EAAa,UACZ,UAAA;AAAA,MAAAnN,2BAAAA,IAAC8T,GAAAA,SAAM,OAAA,IAAY,MAAA,GAChBnH,UAAAA,EAAE,0BAA0B,GAC/B;AAAA,qCACC,aAAA,EAAkB,MAAA,GAAIgH,UAAAA,YAAW7V,MAAMyO,QAAAA,CAAS;AAAA,IAAA,GACnD,EAAA,CACF,GACD9P,QAAA4W,SAAA5W,QAAAkX,aAAAlX,QAAAkQ,GAAAlQ,QAAAiM,OAAAA,MAAAjM,EAAA,EAAA;AAAA,QAAAyM;AAAA,WAAAzM,EAAA,EAAA,MAAA4L,OAAA5L,UAAAiM,OAXHQ,qCAAC,WAAA,EAAgB,MAAA,GAAY,SAAAb,KAAwCwL,SAAAA,aAClEnL,UAAAA,IAAAA,CAWH,GAAYjM,QAAA4L,KAAA5L,QAAAiM,KAAAjM,QAAAyM,OAAAA,MAAAzM,EAAA,EAAA,GAZZyM;AAAAA,EAYY;AAEf,MAAAb;AAAA5L,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAIsBqJ,KAAA;AAAA,IAAAuM,QAAS;AAAA,EAAA,GAAOnY,QAAA4L,MAAAA,KAAA5L,EAAA,EAAA;AAAA,MAAAiM;AAAAjM,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAOX0J,KAAA1I,2BAAAA,IAAC6U,aAAAA,qBAAA,CAAA,CAAmB,GAAGpY,QAAAiM,MAAAA,KAAAjM,EAAA,EAAA;AAAA,MAAAyM;AAAAzM,IAAA,EAAA,MAAAkY,mBAAAlY,UAAA+X,oBAA3CtL,oCAAC4L,MAAAA,UAAA,EAAmB,UAAApM,IAClB,UAAA1I,+BAAC+U,UAAAA,gBAES,SAAA,YACD,OAAA,GACA,QAAA,YACDP,MAAAA,kBACOG,aAAAA,gBAAAA,CAAe,GAEhC,GAAWlY,QAAAkY,iBAAAlY,QAAA+X,kBAAA/X,QAAAyM,MAAAA,KAAAzM,EAAA,EAAA;AAAA,MAAAuN;AAAA,SAAAvN,EAAA,EAAA,MAAA+S,mBAAA/S,EAAA,EAAA,MAAAgT,qBAAAhT,EAAA,EAAA,MAAAuR,gBAAAvR,EAAA,EAAA,MAAAiT,mBAAAjT,UAAAyM,MAjBjBc,qCAACgK,0BAAAA,eAAA,EAAuBJ,SAAAA,gBACtB,UAAA5T,2BAAAA,IAACgT,UAAAA,YAAA,EAAkB,OAAA3K,IACjB,UAAArI,2BAAAA,IAAC,kCACegO,cACGwB,iBACEC,mBACFC,iBAEjBxG,UAAAA,GAAAA,CAUF,EAAA,CACF,GACF,GAAgBzM,QAAA+S,iBAAA/S,QAAAgT,mBAAAhT,QAAAuR,cAAAvR,QAAAiT,iBAAAjT,QAAAyM,IAAAzM,QAAAuN,OAAAA,MAAAvN,EAAA,EAAA,GApBhBuN;AAoBgB;ACxHb,SAAAgL,cAAAxY,OAAA;AAAA,QAAAC,IAAAC,uBAAA,CAAA,GASL;AAAA,IAAA6R;AAAAA,IAAAC;AAAAA,IAAA4F;AAAAA,IAAA5E;AAAAA,IAAAC;AAAAA,IAAAzB;AAAAA,IAAA0B;AAAAA,EAAAA,IAQIlT;AAAK,MAAAI;AAAA,SAAAH,EAAA,CAAA,MAAA8R,cAAA9R,EAAA,CAAA,MAAA+R,gBAAA/R,EAAA,CAAA,MAAA+S,mBAAA/S,SAAA2X,eAAA3X,EAAA,CAAA,MAAAgT,qBAAAhT,EAAA,CAAA,MAAAuR,gBAAAvR,EAAA,CAAA,MAAAiT,mBAEP9S,oCAACqX,sBAAAA,yBACC,UAAAjU,+BAAC,cAAA,EACauO,YACEC,cACGgB,iBACJ4E,aACM3E,mBACLzB,cACG0B,gBAAAA,CAAe,GAEpC,GAAwBjT,OAAA8R,YAAA9R,OAAA+R,cAAA/R,OAAA+S,iBAAA/S,OAAA2X,aAAA3X,OAAAgT,mBAAAhT,OAAAuR,cAAAvR,OAAAiT,iBAAAjT,OAAAG,MAAAA,KAAAH,EAAA,CAAA,GAVxBG;AAUwB;ACvB5B,SAAeqY,gBAAA1G,YAAA2G,YAAA;AAAA,QAAAzY,IAAAC,qBAAAA,EAAA,CAAA,GACbyY,uBAA6BC,OAAAA,wBAAAA;AAAyB,MAAAxY;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KACDpC,SAAEH,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAvD,QAAA,CAAA4Y,SAAAC,UAAA,IAA8B7N,MAAAA,SAAuB7K,EAAE,GACvD;AAAA,IAAA2Y;AAAAA,EAAAA,IAA2BC,sBAAAA;AAAgB,MAAA3Y,IAAAsC;AAAA,SAAA1C,EAAA,CAAA,MAAA8R,cAAA9R,EAAA,CAAA,MAAA0Y,wBAAA1Y,EAAA,CAAA,MAAA8Y,oBAAA9Y,SAAAyY,cACjCrY,KAAAA,MAAA;AACR,QAAI,CAACqY;AAAU;AAGf,UAAAO,eAAqBC,iCACnBP,sBACAD,YACA3G,YACAgH,gBACF,EAACI,UAAWvW,CAAAA,UAAA;AACVkW,iBAAWlW,KAAK;AAAA,IAAC,CAClB;AAAC,WAEK,MAAA;AACLqW,oBAAYG,YAAAA;AAAAA,IAAe;AAAA,EAC5B,GACAzW,KAAA,CAACgW,sBAAsBD,YAAY3G,YAAYgH,gBAAgB,GAAC9Y,OAAA8R,YAAA9R,OAAA0Y,sBAAA1Y,OAAA8Y,kBAAA9Y,OAAAyY,YAAAzY,OAAAI,IAAAJ,OAAA0C,OAAAtC,KAAAJ,EAAA,CAAA,GAAA0C,KAAA1C,EAAA,CAAA,IAhBnEO,gBAAUH,IAgBPsC,EAAgE,GAE5DkW;AAAO;ACZT,SAAAQ,cAAArZ,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GAWL;AAAA,IAAA6R;AAAAA,IAAAC;AAAAA,IAAA4E;AAAAA,IAAA5D;AAAAA,IAAA4E;AAAAA,IAAA3E;AAAAA,IAAAE;AAAAA,IAAA3B;AAAAA,IAAA0B;AAAAA,EAAAA,IAUIlT,OAEJ;AAAA,IAAAmQ;AAAAA,EAAAA,IAAYC,sBAAeC,aAAAA,2BAA2B,GACtDiJ,SAAeC,OAAAA,UAAAA;AAAW,MAAAnZ;AAAAH,IAAA,CAAA,MAAA2W,mBAAAG,UAAA9C,OAAAhU,EAAA,CAAA,MAAA2W,mBAAAG,UAAA7C,SAAAjU,SAAAuR,gBAIxBpR,KAAAoZ,aAEIhW,2BAAAA,IAACqO,kBAAA,EAAS,GACJ7R,SACG,OAAA;AAAA,IAAAmB,IACDyV,mBAAiBG,UAAe9C;AAAAA,IAAAvP,MAC9BkS,mBAAiBG,UAAiB7C;AAAAA,IAAAtC,eACzBF,OAAMC,QAASH,YAAY;AAAA,EAAA,EAC5C,CAAC,GAGNvR,EAAA,CAAA,IAAA2W,mBAAAG,UAAA9C,KAAAhU,EAAA,CAAA,IAAA2W,mBAAAG,UAAA7C,OAAAjU,OAAAuR,cAAAvR,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAbH,QAAAwZ,mBAAyBrZ;AAexB,MAAAC;AAAAJ,IAAA,CAAA,MAAA2W,mBAAAG,UAAA7C,SAAAjU,EAAA,CAAA,MAAAqZ,UAGOjZ,KAAAiZ,OAAMlT,IAAKwQ,mBAAiBG,UAAiB7C,SAAlC,MAA4C,GAACjU,EAAA,CAAA,IAAA2W,mBAAAG,UAAA7C,OAAAjU,OAAAqZ,QAAArZ,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AADhE,QAAAyY,aACQrY,IAIRqZ,eAAqBjB,gBAAgB7B,mBAAiBG,UAAe9C,OAAhC,IAAwCyE,UAAU;AAAC,MAAA/V;AAAAgX,OAAA;AAGtF,QAAI,CAAC/C,mBAAiBG,UAAU;AAAEpU,WAAO;AAAP,YAAAgX;AAAAA,IAAW;AAAA,QAAA7W;AAAA7C,MAAA,CAAA,MAAA2W,kBAAAG,YAAA9W,EAAA,CAAA,MAAAyZ,aAAAE,YAIrC9W,MAAA+W,OAAAA,4BAA4B;AAAA,MAAAD,UACpBF,aAAYE;AAAAA,MAASE,UACrBlD,kBAAiBG;AAAAA,IAAAA,CAC5B,GAAC9W,EAAA,CAAA,IAAA2W,kBAAAG,UAAA9W,EAAA,CAAA,IAAAyZ,aAAAE,UAAA3Z,OAAA6C,OAAAA,MAAA7C,EAAA,CAAA;AAAA,QAAAkD;AAAAlD,cAAAkQ,KAKKhN,MAAAgN,EAAE,qBAAqB,GAAClQ,QAAAkQ,GAAAlQ,QAAAkD,OAAAA,MAAAlD,EAAA,EAAA;AAAA,QAAAqD;AAAArD,cAAAkD,OAF7BG,qCAAC0N,GAAAA,MAAA,EAAc,YAAW,QAAA,GAAW,WACnC,UAAAxN,+BAACiN,GAAAA,QAAK,OAAA,IAAY,MAAA,GAAU,QAAA,UACzBtN,UAAAA,IAAAA,CACH,EAAA,CACF,GAAOlD,QAAAkD,KAAAlD,QAAAqD,OAAAA,MAAArD,EAAA,EAAA;AAAA,QAAAsD;AAAAtD,MAAA,EAAA,MAAAyY,cAAAzY,UAAA6C,OAAA7C,EAAA,EAAA,MAAAqD,OAXXC,KAAAC,2BAAAA,IAACuW,+BAAoB,GACfjX,KAIQ4V,YAEV,QAAApV,IAAAA,CAIO,GAETrD,QAAAyY,YAAAzY,QAAA6C,KAAA7C,QAAAqD,KAAArD,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA,GAdJ0C,KACEY;AAAAA,EAcD;AAlBH,QAAAsV,UAAgBlW;AAqBhB,MAAIoP,cAAAC,cAA0B;AAAA,QAAAlP;AAAA,WAAA7C,EAAA,EAAA,MAAA8R,cAAA9R,EAAA,EAAA,MAAA+R,gBAAA/R,EAAA,EAAA,MAAA+S,mBAAA/S,UAAA2X,eAAA3X,EAAA,EAAA,MAAAgT,qBAAAhT,EAAA,EAAA,MAAAuR,gBAAAvR,EAAA,EAAA,MAAAiT,mBAE1BpQ,qCAAC,eAAA,EACaiP,YACEC,cACGgB,iBACJ4E,aACM3E,mBACLzB,cACG0B,gBAAAA,CAAe,GAChCjT,QAAA8R,YAAA9R,QAAA+R,cAAA/R,QAAA+S,iBAAA/S,QAAA2X,aAAA3X,QAAAgT,mBAAAhT,QAAAuR,cAAAvR,QAAAiT,iBAAAjT,QAAA6C,OAAAA,MAAA7C,EAAA,EAAA,GARF6C;AAAAA,EAQE;AAEL,MAAAA;AAAA7C,IAAA,EAAA,MAAAwZ,oBAAAxZ,EAAA,EAAA,MAAA2W,qBAAA3W,EAAA,EAAA,MAAA4Y,WAAA5Y,UAAAkQ,KAIIrN,KAAA8T,qBACCpT,2BAAAA,IAACwN,GAAAA,MAAA,EAAc,SAAA,GAAS,MAAA4F,kBAAiBG,WAAjB,YAAA,WACrBH,UAAAA,kBAAiBG,WAChBvT,2BAAAA,IAACwW,OAAAA,aAAA,EACC,sBAAA,IAEI,IAAAP,kBACI,WAAA,KACA,QAAA,GACD,QAAA,UACF,MAAA,WAEJZ,mBACH,IAEArV,2BAAAA,IAACwN,GAAAA,MAAA,EAAc,SAAA,GAAW,QAAA,GAAQ,MAAA,WAChC,UAAAN,2BAAAA,KAACI,GAAAA,MAAA,EAAU,KAAA,GACT,UAAA;AAAA,IAAAtN,2BAAAA,IAACqN,GAAAA,KAAA,EAAS,MAAA,QACR,UAAArN,2BAAAA,IAACiN,GAAAA,MAAA,EAAW,MAAA,GACV,UAAAjN,2BAAAA,IAACyW,MAAAA,oBAAA,CAAA,CAAkB,EAAA,CACrB,GACF;AAAA,IACAzW,2BAAAA,IAACqN,GAAAA,KAAA,EAAU,MAAA,GACT,UAAArN,2BAAAA,IAACiN,GAAAA,MAAA,EAAW,MAAA,GACV,UAAAjN,2BAAAA,IAAC0W,OAAAA,WAAA,EACI/J,GACK,SAAA,8BACI,YAAA;AAAA,MAAAuG,MAAO;AAAA,IAAA,GACX,QAAA;AAAA,MAAAhD,MAAOkD,kBAAiBlD;AAAAA,IAAAA,EAAK,IAEzC,EAAA,CACF;AAAA,EAAA,EAAA,CACF,EAAA,CACF,GAEJ,GACDzT,QAAAwZ,kBAAAxZ,QAAA2W,mBAAA3W,QAAA4Y,SAAA5Y,QAAAkQ,GAAAlQ,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA;AAAA,MAAAkD;AAAAlD,IAAA,EAAA,MAAA2W,qBAAA3W,EAAA,EAAA,MAAA+S,mBAAA/S,EAAA,EAAA,MAAAgT,qBAAAhT,EAAA,EAAA,MAAAkT,QAAAlT,UAAAuR,gBAEDrO,KAAAK,+BAAC,kBAAA,EACoBoT,mBACF5D,iBACEC,mBACLzB,cACR2B,MAAI,GACVlT,QAAA2W,mBAAA3W,QAAA+S,iBAAA/S,QAAAgT,mBAAAhT,QAAAkT,MAAAlT,QAAAuR,cAAAvR,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAAA,MAAAqD;AAAA,SAAArD,EAAA,EAAA,MAAA6C,MAAA7C,UAAAkD,MA7CJG,KAAAoN,2BAAAA,KAACI,WAAe,WAAA,UAAe,MAAA,GAAU,QAAA,QACtChO,UAAAA;AAAAA,IAAAA;AAAAA,IAsCDK;AAAAA,EAAAA,EAAAA,CAOF,GAAOlD,QAAA6C,IAAA7C,QAAAkD,IAAAlD,QAAAqD,MAAAA,KAAArD,EAAA,EAAA,GA9CPqD;AA8CO;AC1JJ,SAAA6W,WAAAhZ,IAAA;AAAA,QAAAlB,IAAAC,qBAAAA,EAAA,CAAA;AAAA,MAAAE;AAAAH,WAAAkB,MACsBf,KAAAA,MAAMe,MAAMiZ,KAAAA,GAAAA,GAAMna,OAAAkB,IAAAlB,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAA7C,QAAA,CAAAoa,OAAA,IAAkBpP,MAAAA,SAAS7K,EAAkB;AAAC,SACvCia;AAAO;ACShB,MAAMC,UAAU3W,iBAAAA,OAAOC;AAAAA;AAAAA,GAGjB2W,eAAe5W,iBAAAA,OAAOC;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,YAShB,CAAC;AAAA,EAAC4W;AAAS,MAAOA,YAAY,SAAS,WAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAa3D,CAAC;AAAA,EAACA;AAAS,MACX,CAACA,aACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAmBD;AAAA,GAGUC,eAIR,SAAAra,IAAA;AAAA,QAAAH,IAAAC,uBAAA,EAAA,GAAU;AAAA,IAAAiB,IAAAuZ;AAAAA,IAAAzW;AAAAA,IAAA0W,UAAAta;AAAAA,EAAAA,IAAAD,IAAoBua,WAAAta,OAAA6D,SAAA,KAAA7D,IACjCwM,KAAWnK,MAAAA,OAAuB,IAAI,GAEtCtB,UAAgB+C,MAAAA,WAAWC,YAAAA,yBAAyB;AAEpD,MAAIhD,YAAY;AACd,UAAMiD,MAAM,iEAAiE;AAG/E,QAAAlD,KAAWgZ,WAAWO,MAAM,GAE5B;AAAA,IAAAtP;AAAAA,IAAAiD;AAAAA,IAAAd;AAAAA,IAAAE;AAAAA,IAAAlJ;AAAAA,IAAAC;AAAAA,EAAAA,IACEpD,SAEFwZ,aAAmBxP,kBAAkBjK;AAErC,MAAIC,YAAY;AACd,UAAMiD,MAAM,iEAAiE;AAC9E,MAAA1B;AAAA1C,IAAA,CAAA,MAAAkB,MAAAlB,SAAAsN,iBAGC5K,KAAAZ,CAAAA,UAAA;AACEwL,kBAAcpM,IAAIY,MAAK8Y,WAAY;AAAA,EAAC,GACrC5a,OAAAkB,IAAAlB,OAAAsN,eAAAtN,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAHH,QAAA6a,cAAoBnY;AAKnB,MAAAG;AAAA7C,IAAA,CAAA,MAAAoO,QAAApO,SAAAkB,MAGC2B,KAAAiY,CAAAA,MAAA;AACE1M,SAAKlN,IAAI4Z,CAAC;AAAA,EAAC,GACZ9a,OAAAoO,MAAApO,OAAAkB,IAAAlB,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA;AAHH,QAAA+a,SAAelY;AAKd,MAAAK;AAAAlD,WAAAwN,gBAE8BtK,KAAAA,MAAA;AAC7B0J,OAAEhK,QAAQoY,KAAAA,GACVxN,aAAAA;AAAAA,EAAc,GACfxN,OAAAwN,cAAAxN,OAAAkD,MAAAA,KAAAlD,EAAA,CAAA;AAHD,QAAAib,aAAmB/X;AAGD,MAAAG,IAAAC;AAAAtD,IAAA,CAAA,MAAA0a,YAAA1a,EAAA,CAAA,MAAA2a,cAAA3a,EAAA,EAAA,MAAA+a,UAAA/a,UAAAib,cAER5X,KAAAA,MAAA;AACR,QAAI,CAACsX,cAADD;AAAuB;AAwB3B,UAAAQ,kCAnBA;AACE,YAAAC,YAAkBrE,SAAQsE,KAAK5W,OAC/B6W,gBAAsBvE,SAAQwE,gBAAgB9W,OAE9C;AAAA,QAAA+W;AAAAA,MAAAA,IAAiBF,eACjB;AAAA,QAAAG;AAAAA,MAAAA,IAAqBL;AAErBE,aAAAA,cAAaE,SAAU,aACvBJ,UAASK,aAAc,QAEhB,MAAA;AACDD,iBAAQF,cAAaE,SAAUA,SAC9BF,cAAaI,eAAgB,QAAQ,GAEtCD,aAAYL,UAASK,aAAcA,aAClCL,UAASM,eAAgB,aAAa;AAAA,MAAC;AAAA,IAC7C,GAAA;AAIHvP,WAAAA,OAAMwP,iBAAkB,aAAaX,MAAM,GAC3C7O,OAAMwP,iBAAkB,WAAWT,UAAU,GAC7C/O,OAAMwP,iBAAkB,eAAeT,UAAU,GAG1C,MAAA;AACLC,0BAAAA,GACAhP,OAAMyP,oBAAqB,aAAaZ,MAAM,GAC9C7O,OAAMyP,oBAAqB,WAAWV,UAAU,GAChD/O,OAAMyP,oBAAqB,eAAeV,UAAU;AAAA,IAAC;AAAA,EACtD,GACA3X,KAAA,CAACoX,UAAUC,YAAYI,QAAQE,UAAU,GAACjb,OAAA0a,UAAA1a,OAAA2a,YAAA3a,QAAA+a,QAAA/a,QAAAib,YAAAjb,QAAAqD,IAAArD,QAAAsD,OAAAD,KAAArD,EAAA,EAAA,GAAAsD,KAAAtD,EAAA,EAAA,IArC7CO,MAAAA,UAAU8C,IAqCPC,EAA0C;AAAC,MAAAsI,IAAAK;AAAAjM,IAAA,EAAA,MAAAkB,MAAAlB,EAAA,EAAA,MAAAgE,SAAAhE,EAAA,EAAA,MAAAsE,mBAAAtE,UAAAuE,qBAE9BqH,KAAAA,OACdtH,gBAAgBpD,IAAI;AAAA,IAAAA;AAAAA,IAAA8C;AAAAA,IAAAS,MAAkB;AAAA,IAASmI;AAAAA,EAAAA,CAAK,GAE7C,MAAA;AACLrI,sBAAkBrD,EAAE;AAAA,EAAC,IAEtB+K,KAAA,CAAC/K,IAAI8C,OAAOM,iBAAiBC,iBAAiB,GAACvE,QAAAkB,IAAAlB,QAAAgE,OAAAhE,QAAAsE,iBAAAtE,QAAAuE,mBAAAvE,QAAA4L,IAAA5L,QAAAiM,OAAAL,KAAA5L,EAAA,EAAA,GAAAiM,KAAAjM,EAAA,EAAA,IANlD0E,MAAAA,gBAAgBkH,IAMbK,EAA+C;AAAC,MAAAsB,KAAAd;AAAAzM,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAK7CkK,KAAAlJ,2BAAAA,IAAA,QAAA,CAAA,CAAQ,GACRgK,MAAAhK,2BAAAA,IAAA,QAAA,CAAA,CAAQ,GAAAvD,QAAAuN,KAAAvN,QAAAyM,OAAAc,MAAAvN,EAAA,EAAA,GAAAyM,KAAAzM,EAAA,EAAA;AAAA,MAAAyN;AAAAzN,YAAA0a,YAFVjN,sCAAC,cAAA,EAAwBiN,qBACvBjO,UAAAA;AAAAA,IAAAA;AAAAA,IACAc;AAAAA,EAAAA,EAAAA,CACF,GAAevN,QAAA0a,UAAA1a,QAAAyN,OAAAA,MAAAzN,EAAA,EAAA;AAAA,MAAAqO;AAAA,SAAArO,EAAA,EAAA,MAAA6a,eAAA7a,UAAAyN,OAJjBY,qCAAC,SAAA,EAAqBwM,aAAkBjO,KAAAA,IACtCa,UAAAA,IAAAA,CAIF,GAAUzN,QAAA6a,aAAA7a,QAAAyN,KAAAzN,QAAAqO,OAAAA,MAAArO,EAAA,EAAA,GALVqO;AAKU,GC5HRuN,6BAMF7b,CAAAA,UAAA;AAAA,QAAAC,IAAAC,uBAAA,CAAA,GACF;AAAA,IAAA6R;AAAAA,IAAA+J;AAAAA,IAAAC;AAAAA,EAAAA,IAA6D/b;AAAK,MAAAI;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAG9DpC,oCAAC,gBAAoB,UAAC,GAAIH,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAA,MAAAI;AAAAJ,WAAA8b,oBAAA9b,EAAA,CAAA,MAAAD,MAAAsC,YAMtBjC,KAAAmD,2BAAAA,IAACwY,OAAAA,wBAAA,EAAkCD,WAAAA,kBAChC/b,UAAAA,MAAKsC,SAAAA,CACR,GAAyBrC,OAAA8b,kBAAA9b,EAAA,CAAA,IAAAD,MAAAsC,UAAArC,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAA,MAAA0C;AAAA,SAAA1C,EAAA,CAAA,MAAA8R,cAAA9R,SAAA6b,wBAAA7b,EAAA,CAAA,MAAAI,MAT/BsC,4DACEvC,UAAAA;AAAAA,IAAAA;AAAAA,IACAoD,2BAAAA,IAAC,OAAA,EAAS,IAAA,WAAoB,UAAA,KAAY,UACxC,UAAAA,2BAAAA,IAACyY,6BAAAA,sCAAA,EACalK,YACU+J,sBAEtBzb,cAGF,EAAA,CACF;AAAA,EAAA,GAAQ,GACPJ,OAAA8R,YAAA9R,OAAA6b,sBAAA7b,OAAAI,IAAAJ,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA,GAZH0C;AAYG,GAIMuZ,sBAAmElc,CAAAA,UAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GAC9E;AAAA,IAAA6R;AAAAA,IAAAoK;AAAAA,IAAAnK;AAAAA,IAAA+J;AAAAA,IAAAnF;AAAAA,IAAA5D;AAAAA,IAAA4E;AAAAA,IAAA3E;AAAAA,IAAAzB;AAAAA,IAAAsK;AAAAA,IAAA5I;AAAAA,EAAAA,IAYIlT;AAAK,MAAAI;AAAAH,IAAA,CAAA,MAAA8R,cAAA9R,EAAA,CAAA,MAAA+R,gBAAA/R,SAAAkc,mBAAAlc,EAAA,CAAA,MAAA2W,qBAAA3W,EAAA,CAAA,MAAA+S,mBAAA/S,EAAA,CAAA,MAAA2X,eAAA3X,EAAA,CAAA,MAAAgT,qBAAAhT,EAAA,CAAA,MAAAuR,gBAAAvR,SAAAiT,mBAQL9S,oCAAC,eAAA,EACa2R,YACEC,cACK4E,mBACF5D,iBACJ4E,aACM3E,mBACbkJ,MAAAA,iBACQ3K,cACG0B,gBAAAA,CAAe,GAChCjT,OAAA8R,YAAA9R,OAAA+R,cAAA/R,OAAAkc,iBAAAlc,OAAA2W,mBAAA3W,OAAA+S,iBAAA/S,OAAA2X,aAAA3X,OAAAgT,mBAAAhT,OAAAuR,cAAAvR,OAAAiT,iBAAAjT,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAA,MAAAI;AAAA,SAAAJ,EAAA,EAAA,MAAA8R,cAAA9R,EAAA,EAAA,MAAA8b,oBAAA9b,EAAA,EAAA,MAAA6b,wBAAA7b,UAAAG,MAfJC,KAAAmD,2BAAAA,IAAC,4BAAA,EACauO,YACMgK,kBACID,sBAEtB1b,UAAAA,GAAAA,CAWF,GAA6BH,QAAA8R,YAAA9R,QAAA8b,kBAAA9b,QAAA6b,sBAAA7b,QAAAG,IAAAH,QAAAI,MAAAA,KAAAJ,EAAA,EAAA,GAhB7BI;AAgB6B,GCjFpB+b,+BAIT,SAAApc,OAAA;AAAA,QAAAC,IAAAC,uBAAA,CAAA,GACF;AAAA,IAAAoC;AAAAA,IAAA+Z,UAAAC;AAAAA,EAAAA,IAAwCtc;AAAK,MAAAI;AAAAH,WAAAqc,aAG3Clc,KAAAA,CAAAyY,SAAA9B,cAAA;AACE,QAAI8B,WAAA9B,WAAmB;AACrB,YAAAlE,MAGI,CAAA;AACAgG,kBAAShG,IAAGT,SAAU;AAAA,QAAAyG;AAAAA,MAAAA,IACtB9B,cAAUlE,IAAGjQ,QAASmU,YAE1BuF,UAAUzJ,GAAkC;AAAA,IAAC;AAAA,EAC9C,GACF5S,OAAAqc,WAAArc,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAZH,QAAAoc,WAAiBjc;AAchB,MAAAC;AAAA,SAAAJ,EAAA,CAAA,MAAAqC,YAAArC,SAAAoc,YAGChc,KAAAmD,2BAAAA,IAAA+Y,YAAAA,4BAAA,UAAA,EAA6CF,OAAAA,UAC1C/Z,SAAAA,CACH,GAAuCrC,OAAAqC,UAAArC,OAAAoc,UAAApc,OAAAI,MAAAA,KAAAJ,EAAA,CAAA,GAFvCI;AAEuC;ACnCpC,SAAAmc,cAAAzZ,KAAA0Z,cAAA;AAAA,QAAAxc,IAAAC,qBAAAA,EAAA,CAAA;AAAA,MAAAE;AAAAH,IAAA,CAAA,MAAAwc,gBAAAxc,SAAA8C,OACiC3C,KAAAA,MACpCkF,KAAIC,MAAOC,aAAYC,QAAS1C,GAAmC,KAA3BuC,KAAIO,UAAW4W,YAAY,CAAC,GAACxc,OAAAwc,cAAAxc,OAAA8C,KAAA9C,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AADvE,QAAA,CAAA+C,OAAAE,QAAA,IAA0B+H,MAAAA,SAAY7K,EAEtC;AAAC,MAAAC,IAAAsC;AAAA1C,IAAA,CAAA,MAAA8C,OAAA9C,SAAA+C,SAES3C,KAAAA,MAAA;AACRmF,iBAAYI,QAAS7C,KAAKuC,KAAIO,UAAW7C,KAAK,CAAC;AAAA,EAAC,GAC/CL,KAAA,CAACI,KAAKC,KAAK,GAAC/C,OAAA8C,KAAA9C,OAAA+C,OAAA/C,OAAAI,IAAAJ,OAAA0C,OAAAtC,KAAAJ,EAAA,CAAA,GAAA0C,KAAA1C,EAAA,CAAA,IAFfO,MAAAA,UAAUH,IAEPsC,EAAY;AAAC,MAAAG;AAAA,SAAA7C,SAAA+C,SAETF,KAAA,CAACE,OAAOE,QAAQ,GAACjD,OAAA+C,OAAA/C,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA,GAAjB6C;AAAiB;ACQnB,SAAA4Z,yBAAA1c,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GAGL;AAAA,IAAAyc;AAAAA,EAAAA,IAA6B3c,OAE7B4c,oBAA0B,CAAC,CAACD,oBAAkBE,WAC9C,CAAAC,mBAAAC,mBAAA,IAAiDP,cAC/C,0BACAI,iBACF,GACAI,mBAAyBJ,oBAAAE,oBAAA;AAA6C,MAAA1c;AAAAuZ,OAAA;AAEpE,QAAI,CAACiD,mBAAiB;AAAExc,WAAO8D;AAAP,YAAAyV;AAAAA,IAAgB;AAAA,QAAAtZ;AAAAJ,aAAA8c,uBAEjC1c,MAAAA,MAAM0c,oBAAoBxc,OAAqB,GAACN,OAAA8c,qBAAA9c,OAAAI,OAAAA,MAAAJ,EAAA,CAAA,GAAvDG,KAAOC;AAAAA,EAAgD;AAHzD,QAAA4c,kBAAwB7c;AAIoB,MAAAC;AAAAJ,IAAA,CAAA,MAAA+c,oBAAA/c,SAAA0c,sBAG1Ctc,gBAAA;AAAA,iEACY2c,UAAAA,oBAAoBxZ,+BAAC,WAAA,EAAS,GAAKmZ,oBAAkB,GAAK;AAAA,EAAI,GACzE1c,OAAA+c,kBAAA/c,OAAA0c,oBAAA1c,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAHH,QAAAid,YAAkB7c;AAKjB,MAAAsC;AAAA1C,IAAA,CAAA,MAAA+c,oBAAA/c,SAAAgd,mBAEOta,KAAA;AAAA,IAAAqa;AAAAA,IAAAC;AAAAA,EAAAA,GAAmChd,OAAA+c,kBAAA/c,OAAAgd,iBAAAhd,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAAA,MAAA6C;AAAA,SAAA7C,EAAA,CAAA,MAAAid,aAAAjd,SAAA0C,MAApCG,KAAA,CAACH,IAAqCua,SAAS,GAACjd,OAAAid,WAAAjd,OAAA0C,IAAA1C,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA,GAAhD6C;AAAgD;AAxBlD,SAAAvC,QAAAyB,SAAA;AAAA,SAc2C,CAACA;AAAO;AAa1D,SAAAmb,mBAAAnd,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GAEE;AAAA,IAAA6D;AAAAA,IAAAC;AAAAA,IAAA6Y,WAAAM;AAAAA,EAAAA,IAA4Dnd,OAE5Dod,oBAA0BrZ,YAAY,QAAQC,YAAY,QAAQD,aAAaC;AAAQ,MAAA5D;AAAAH,WAAAkd,uBAIjF/c,KAAAoD,+BAAC2Z,qBAAA,CAAA,CAAkB,GAAGld,OAAAkd,qBAAAld,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAA,MAAAI;AAAAJ,IAAA,CAAA,MAAA+D,YAAA/D,SAAA8D,YAAA9D,EAAA,CAAA,MAAAG,MADxBC,KAAAmD,2BAAAA,IAAC,SAAS,IAAA,aAAsBO,UAAoBC,UAAiB,OAAA,GACnE5D,UAAAA,GAAAA,CACF,GAAQH,OAAA+D,UAAA/D,OAAA8D,UAAA9D,OAAAG,IAAAH,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAA,MAAA0C;AAAA1C,WAAAmd,qBACRza,KAAAa,+BAAC,cAAA,EAAoB,OAAA,GAAa4Z,UAAAA,mBAAiB,GAAInd,OAAAmd,mBAAAnd,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAAA,MAAA6C;AAAA,SAAA7C,EAAA,CAAA,MAAAI,MAAAJ,SAAA0C,MAJzDG,4DACEzC,UAAAA;AAAAA,IAAAA;AAAAA,IAGAsC;AAAAA,EAAAA,EAAAA,CAAuD,GACtD1C,OAAAI,IAAAJ,OAAA0C,IAAA1C,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA,GALH6C;AAKG;AAGP,MAAMua,YAAY5c,MAAAA,KAAK0c,kBAAkB,GCvD5BG,6BAIT,SAAAtd,OAAA;AAAA,QAAAC,IAAAC,uBAAA,CAAA,GACF;AAAA,IAAAoC;AAAAA,IAAA8P;AAAAA,EAAAA,IAA2BpS,OAE3BoB,UAA8DgR;AAAiB,MAAAhS;AAAA,SAAAH,EAAA,CAAA,MAAAqC,YAAArC,SAAAmB,WAG7EhB,KAAAoD,2BAAAA,IAAA+Z,YAAAA,0BAAA,UAAA,EAA2Cnc,OAAAA,SACxCkB,SAAAA,CACH,GAAqCrC,OAAAqC,UAAArC,OAAAmB,SAAAnB,OAAAG,MAAAA,KAAAH,EAAA,CAAA,GAFrCG;AAEqC,GCN5Bod,uBAST,SAAAxd,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GACF;AAAA,IAAAoC;AAAAA,IAAAuU;AAAAA,IAAA4G;AAAAA,IAAApB;AAAAA,IAAAjK;AAAAA,IAAAZ;AAAAA,IAAA0B;AAAAA,EAAAA,IAAmFlT;AAAK,MAAAI;AAAAH,WAAA4W,WAAA5W,EAAA,CAAA,MAAAwd,QAAAxd,EAAA,CAAA,MAAAoc,YAAApc,EAAA,CAAA,MAAAmS,UAAAnS,SAAAuR,gBAAAvR,EAAA,CAAA,MAAAiT,mBAG/E9S,KAAA;AAAA,IAAAyW;AAAAA,IAAA4G;AAAAA,IAAApB;AAAAA,IAAAjK;AAAAA,IAAAZ;AAAAA,IAAA0B;AAAAA,EAAAA,GAONjT,OAAA4W,SAAA5W,OAAAwd,MAAAxd,OAAAoc,UAAApc,OAAAmS,QAAAnS,OAAAuR,cAAAvR,OAAAiT,iBAAAjT,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AARH,QAAAmB,UACShB;AASR,MAAAC;AAAA,SAAAJ,EAAA,CAAA,MAAAqC,YAAArC,SAAAmB,WAEMf,KAAAmD,2BAAAA,IAAAka,YAAAA,oBAAA,UAAA,EAAqCtc,OAAAA,SAAUkB,SAAAA,CAAS,GAA+BrC,OAAAqC,UAAArC,OAAAmB,SAAAnB,OAAAI,MAAAA,KAAAJ,EAAA,CAAA,GAAvFI;AAAuF;AC/BzF,SAAAsd,iBAAAC,eAAA;AACL,QAAAC,gBAAsBC,MAAAA,YAAYF,eAAerd,OAAqC;AACtF,MAAI,CAACsG,MAAKC,QAAS+W,aAAa;AAC9B,UAAM,IAAIE,UAAU,gCAAgC;AACrD,SACMF;AAAa;AALf,SAAAtd,QAAAqC,OAAA;AAAA,SACuDA,MAAKxB,QAAQ4c;AAAa;ACFjF,SAASC,wBAAwBC,mBAA8C;AACpF,SAAOrX,MAAMC,QAAQoX,iBAAiB,IAAIA,kBAAkBhY,KAAK,GAAG,IAAIgY;AAC1E;ACHO,SAAAC,QAAA;AAAA,QAAAle,IAAAC,qBAAAA,EAAA,CAAA,GACLiB,KAAWid,MAAAA,MAAAA;AAAY,MAAAhe;AAAA,SAAAH,SAAAkB,MAEhBf,KAAAe,GAAEkd,WAAY,GAAmD,IAA5Cld,GAAEmd,QAAS,YAAY,YAAqB,IAAjEnd,IAAkElB,OAAAkB,IAAAlB,OAAAG,MAAAA,KAAAH,EAAA,CAAA,GAAlEG;AAAkE;ACYpE,MAAMme,SAASrN,MAAAA,WACpB,SAAAlR,OAAAwe,cAAA;AAAA,QAAAve,IAAAC,uBAAA,EAAA,GACE;AAAA,IAAAue;AAAAA,IAAArc;AAAAA,IAAAsc;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,IAAApa;AAAAA,EAAAA,IAAuEzE,OAEvEmR,MAAYzO,MAAAA,OAAiC,IAAI;AAAC,MAAAtC;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAIhDpC,KAAAA,MAAM+Q,IAAGtO,SAAQ5C,OAAAG,MAAAA,KAAAH,EAAA,CAAA,GAFnB6e,MAAAA,oBACEN,cACApe,EACF;AAAC,MAAAC,IAAAsC;AAAA1C,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAMSnC,KAAAA,MAAA;AACR,QAAI,CAAC8Q,IAAGtO;AAAQ;AAGhB,UAAAkc,WAAiB5N,IAAGtO,SACpBmc,wBAAA;AACMD,mBAAahI,SAAQkI,iBAIzBF,SAAQG,cAAe,IAAIC,WAAW,aAAa;AAAA,QAAAC,SAAU;AAAA,QAAIC,YAAc;AAAA,MAAA,CAAK,CAAC;AAAA,IAAC;AAExFlT,WAAAA,OAAMwP,iBAAkB,QAAQqD,UAAU,GACnC,MAAA;AACL7S,aAAMyP,oBAAqB,QAAQoD,UAAU;AAAA,IAAC;AAAA,EAC/C,GACArc,KAAA,CAAA,GAAE1C,OAAAI,IAAAJ,OAAA0C,OAAAtC,KAAAJ,EAAA,CAAA,GAAA0C,KAAA1C,EAAA,CAAA,IAhBLO,MAAAA,UAAUH,IAgBPsC,EAAE;AAEL,QAAA2c,qBAA2BnB,MAAAA;AAAO,MAAArb;AAAA7C,IAAA,CAAA,MAAAwE,SAAAxE,SAAAqf,sBAKrBxc,KAAA;AAAA,IAAA,GACF2B;AAAAA,IAAK6a;AAAAA,EAAAA,GAETrf,OAAAwE,OAAAxE,OAAAqf,oBAAArf,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA;AAAA,MAAAkD;AAAAlD,WAAAwe,WAAAxe,EAAA,CAAA,MAAAmC,WAAAnC,EAAA,CAAA,MAAAye,UAAAze,EAAA,CAAA,MAAA2e,OAAA3e,UAAA6C,MAAA7C,EAAA,EAAA,MAAA4e,YAJH1b,oCAAC,eAAA,EACQ,OAAAL,IAIE2b,SACArc,SACDsc,QACHvN,KACAyN,KACKC,SAAAA,CAAQ,GAClB5e,OAAAwe,SAAAxe,OAAAmC,SAAAnC,OAAAye,QAAAze,OAAA2e,KAAA3e,QAAA6C,IAAA7C,QAAA4e,UAAA5e,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAAA,MAAAqD;AAAArD,YAAA0e,gBACDrb,KAAAqb,+CAAiB,eAAA,EAAa,GAAG1e,QAAA0e,cAAA1e,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAAA,MAAAsD;AAAAtD,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAClCe,KAAAC,2BAAAA,IAAC,sBAAA,CAAA,CAAoB,GAAGvD,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA;AAAA,MAAA4L;AAAA,SAAA5L,EAAA,EAAA,MAAAkD,MAAAlD,UAAAqD,MAd1BuI,KAAA6E,2BAAAA,KAAA6O,WAAAA,UAAA,EACEpc,UAAAA;AAAAA,IAAAA;AAAAA,IAYCG;AAAAA,IACDC;AAAAA,EAAAA,EAAAA,CAAwB,GACvBtD,QAAAkD,IAAAlD,QAAAqD,IAAArD,QAAA4L,MAAAA,KAAA5L,EAAA,EAAA,GAfH4L;AAeG,CAGT,GAEM2T,gBAAgBC,QAAAA,OAAOC,OAAO/b,iBAAAA,OAAOgc;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,CAM1C,GAEKC,gBAAgBjc,iBAAAA,OAAOkN,MAAG;AAAA;AAAA;AAAA;AAAA,GAM1BgP,uBAAuBC,iBAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AC1EtB,SAAAC,kBAAA/f,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GAQL;AAAA,IAAA8f;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,EAAAA,IAA4FpgB;AAAK,MAAAqB;AAAApB,IAAA,CAAA,MAAAkgB,eAAAlgB,EAAA,CAAA,MAAAggB,yBAAAhgB,EAAA,CAAA,MAAAigB,wBAAAjgB,SAAAmgB,gBAG/F/e,MAAY,IAAIgf,IAAIH,sBAAsBD,yBAAAG,YAAqC,GAC/E/e,IAAGmQ,aAAalL,IAAKga,UAAAA,kCAAkCrC,wBAAwBkC,WAAW,CAAC,GAAClgB,OAAAkgB,aAAAlgB,OAAAggB,uBAAAhgB,OAAAigB,sBAAAjgB,OAAAmgB,cAAAngB,OAAAoB,OAAAA,MAAApB,EAAA,CAAA;AAC5F,QAAA;AAAA,IAAAsgB;AAAAA,IAAAC;AAAAA,EAAAA,IAA2Bnf,KAH7Bof,kBAKE,GAAUR,qBAAqB,GAAGM,QAAQ,GAAGC,MAAM,IAGrD;AAAA,IAAArQ;AAAAA,EAAAA,IAAYC,OAAAA,eAAeC,aAAAA,2BAA2B;AAAC,MAAAjQ;AAAAH,WAAA+f,aAGrD5f,KAAA2B,CAAAA,UAAA;AACEA,UAAK8L,eAAAA,GACLmS,UAAUje,MAAK2e,cAAcC,IAAK;AAAA,EAAC,GACpC1gB,OAAA+f,WAAA/f,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAJH,QAAA2gB,kBAAwBxgB;AAMvB,MAAAC;AAAAJ,WAAAkQ,KAK4B9P,KAAA8P,EAAE,+BAA+B,GAAClQ,OAAAkQ,GAAAlQ,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAA,MAAA0C;AAAA1C,WAAAI,MAAlDsC,KAAAa,+BAACiN,GAAAA,MAAA,EAAW,MAAA,GAAIpQ,UAAAA,IAAmC,GAAOJ,OAAAI,IAAAJ,QAAA0C,MAAAA,KAAA1C,EAAA,EAAA;AAAA,MAAA6C;AAAA7C,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAC/CM,KAAA,CAAC,cAAc,GAAC7C,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA;AAAA,MAAAkD;AAAAlD,YAAAkQ,KAMtBhN,KAAAgN,EAAE,+BAA+B,GAAClQ,QAAAkQ,GAAAlQ,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAAA,MAAAqD;AAAArD,IAAA,EAAA,MAAA2gB,mBAAA3gB,UAAAwgB,mBAAAxgB,EAAA,EAAA,MAAAkD,MAFhDG,KAAAE,+BAAC8M,0BAAAA,QAAA,EACI,IAAA,KACS,cAAAnN,IACN0d,MAAAA,MAAAA,YACD,MAAA,SACCJ,MAAAA,iBACF,KAAA,UACG,QAAA,UACO,oBAELG,SAAAA,gBAAAA,CAAe,GACxB3gB,QAAA2gB,iBAAA3gB,QAAAwgB,iBAAAxgB,QAAAkD,IAAAlD,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAAA,MAAAsD;AAAA,SAAAtD,EAAA,EAAA,MAAA0C,MAAA1C,UAAAqD,MAlBJC,KAAAC,2BAAAA,IAACsd,0BAAAA,WACC,SAAA,IACS,SAAAne,IACW,oBAAAG,IACV,WAAA,UACV,QAAA,IAEAQ,cAYF,GAAUrD,QAAA0C,IAAA1C,QAAAqD,IAAArD,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA,GAnBVsD;AAmBU;ACzDP,SAAAwd,gBAAAnD,eAAA;AACL,QAAAwC,eAAqBtC,MAAAA,YAAYF,eAAerd,OAA2C;AAC3F,MAAI,CAAC6f;AACH,UAAM,IAAIrC,UAAU,0BAA0B;AAC/C,SACMqC;AAAY;AALd,SAAA7f,QAAAqC,OAAA;AAAA,SACsDA,MAAKxB,QAAQ4f,YAAmBC;AAAA;ACctF,SAAAC,qBAAAlhB,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GASL;AAAA,IAAAihB,UAAA/gB;AAAAA,IAAAghB;AAAAA,IAAAC,SAAAhhB;AAAAA,IAAAihB;AAAAA,IAAAC;AAAAA,IAAAve;AAAAA,IAAA4a;AAAAA,EAAAA,IAAoF5d,OAA7EmhB,WAAA/gB,OAAA8D,SAAA,IAAA9D,IAAwBihB,UAAAhhB,OAAA6D,SAAA,IAAA7D,IAC/B2d,eAAqBL,iBAAiBC,aAAa,GACnDwC,eAAqBW,gBAAgBnD,aAAa,GAElD;AAAA,IAAAzN;AAAAA,EAAAA,IAAYC,OAAAA,eAAeC,aAAAA,2BAA2B,GACtD;AAAA,IAAAmR,UAAA7e;AAAAA,EAAAA,IAAyB8e,0BAAAA,GAAqCC,mBAArC,CAAA,GAAlBF,WAAA7e,OAAAuB,SAAA,MAAAvB,IAEPgf,WAAiBjf,MAAAA,OAAgC,IAAI,GACrD,CAAAkf,cAAAC,eAAA,IAAwC5W,eAA6B/G,MAAS,GAC9E,CAAA4d,gBAAAC,iBAAA,IAA4C9W,MAAAA,SAA6B/G,MAAS;AAAC,MAAApB;AAAA7C,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAElDM,KAAAf,CAAAA,UAAA;AAC/B8f,oBAAgB9f,MAAK2e,cAAc1d,KAAM;AAAA,EAAC,GAC3C/C,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA;AAFD,QAAA+hB,eAAqBlf;AAEf,MAAAK;AAAAlD,WAAA+d,gBAAA/d,EAAA,CAAA,MAAAuhB,YAAAvhB,EAAA,CAAA,MAAAmhB,YAAAnhB,EAAA,CAAA,MAAA2hB,gBAAA3hB,SAAAkQ,KAAAlQ,EAAA,CAAA,MAAAmgB,gBAGJjd,KAAAyK,CAAAA,YAAA;AACE,QAAI7L,QAAKgB,QAAS,SAAO;AACvB,UAAI6e,iBAAiB1d;AAAS;AAI9B,UAAA+d,gBAAoBL;AACpB,UAAA;AACEK,wBAAgBA,IAAI5B,IAAIuB,cAAcxB,YAAY,EAAClI,SAAAA;AAAAA,MAAtC,QAAA;AAAA,MAAA;AAKf,UAAIrR,MAAKC,QAASkX,YAAY;AAC5B,YAAI,CAACA,aAAYjX,KAAMmb,CAAAA,YAAaA,QAAOC,KAAMF,aAAa,CAAC,GAAC;AAC9DF,4BACE5R,EAAE,gCAAgC;AAAA,YAAA8Q,QACxBb;AAAAA,YAAYhf,SACX;AAAA,UAAA,CACV,CACH,GACAW,QAAK2e,cAAc0B,eAAAA;AAAiB;AAAA,QAAA;AAAA,iBAKtC,CAAChC,iBACA6B,cAAa5D,WAAY,GAAGmD,QAAQ,GAAiC,KAAzBS,kBAAkBT,WAAS;AAExEO,0BACE5R,EAAE,gCAAgC;AAAA,UAAAqR;AAAAA,UAAApgB,SAAoB;AAAA,QAAA,CAAiB,CACzE;AAAC;AAAA,MAAA;AAIH,YAAAihB,YAAkBJ,kBAAkB7B,eAAlB,GAAoCA,YAAY,MAAhD6B;AAElBF,wBAAkB7d,MAAS,GAC3B2d,gBAAgB3d,MAAS,GAEzBkd,SAASiB,SAAS,GAElBV,SAAQ9e,SAAcoY,KAAAA;AAAAA,IAAE;AAGtBlZ,YAAKgB,QAAS,aAChBgf,kBAAkB7d,MAAS,GAC3B2d,gBAAgB3d,MAAS;AAAA,EAC1B,GACFjE,OAAA+d,cAAA/d,OAAAuhB,UAAAvhB,OAAAmhB,UAAAnhB,OAAA2hB,cAAA3hB,OAAAkQ,GAAAlQ,OAAAmgB,cAAAngB,OAAAkD,MAAAA,KAAAlD,EAAA,CAAA;AAlDH,QAAAqiB,gBAAsBnf;AAoDrB,MAAAG;AAAArD,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAE8Bc,KAAAA,MAAA;AAC7Bye,sBAAkB7d,MAAS,GAC3B2d,gBAAgB3d,MAAS;AAAA,EAAC,GAC3BjE,OAAAqD,MAAAA,KAAArD,EAAA,CAAA;AAHD,QAAA+e,aAAmB1b;AAGb,MAAAC;AAAAtD,IAAA,CAAA,MAAAmgB,gBAAAngB,UAAA+C,SAE0BO,KAAAA,MAAA;AAC9Bwe,sBAAkB7d,MAAS;AAC3B,QAAAqe,cAAgBvf;AAChB,QAAA;AACEqf,oBAAYA,IAAIhC,IAAIrd,OAAOod,YAAY,EAAClI,SAAAA;AAAAA,IAA/B,QAAA;AAAA,IAAA;AAIX2J,oBAAgBQ,WAAS;AAAA,EAAC,GAC3BpiB,OAAAmgB,cAAAngB,QAAA+C,OAAA/C,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA;AATD,QAAAuiB,cAAoBjf;AASK,MAAAsI;AAAA5L,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEfqJ,KAAAA,MAAA;AACRkW,sBAAkB7d,MAAS,GAC3B2d,gBAAgB3d,MAAS;AAAA,EAAC,GAC3BjE,QAAA4L,MAAAA,KAAA5L,EAAA,EAAA;AAAA,MAAAiM;AAAAjM,IAAA,EAAA,MAAAmgB,gBAAAngB,UAAA+C,SAAEkJ,KAAA,CAACkU,cAAcpd,KAAK,GAAC/C,QAAAmgB,cAAAngB,QAAA+C,OAAA/C,QAAAiM,MAAAA,KAAAjM,EAAA,EAAA,GAHxBO,MAAAA,UAAUqL,IAGPK,EAAqB;AAAC,MAAAQ;AAAAzM,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEqCkK,KAAA;AAAA,IAAA+V,MAAOC,MAAAA;AAAAA,EAAAA,GAAUziB,QAAAyM,MAAAA,KAAAzM,EAAA,EAAA;AAK5D,QAAAuN,MAAAsU,iBAL2CpV,KAK3CxI;AAAwC,MAAAwJ;AAAAzN,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAS9CkL,MAAA;AAAA,IAAAiV,QAAS;AAAA,EAAA,GAAE1iB,QAAAyN,OAAAA,MAAAzN,EAAA,EAAA;AAAA,MAAAqO;AAAArO,IAAA,EAAA,MAAA2hB,gBAAA3hB,UAAAmgB,gBAAAngB,EAAA,EAAA,MAAA+C,SAKXsL,MAAAsT,iBAAiB1d,SAAY,IAAImc,IAAIrd,OAAOod,YAAY,EAAClI,SAAAA,IAAzD0J,cAAmF3hB,QAAA2hB,cAAA3hB,QAAAmgB,cAAAngB,QAAA+C,OAAA/C,QAAAqO,OAAAA,MAAArO,EAAA,EAAA;AAAA,MAAAsO;AAAA,SAAAtO,EAAA,EAAA,MAAA6hB,kBAAA7hB,EAAA,EAAA,MAAAkhB,YAAAlhB,UAAAuiB,eAAAviB,EAAA,EAAA,MAAAqiB,iBAAAriB,EAAA,EAAA,MAAAohB,WAAAphB,EAAA,EAAA,MAAAqhB,UAAArhB,EAAA,EAAA,MAAAshB,UAAAthB,EAAA,EAAA,MAAAuN,OAAAvN,UAAAqO,OAhB9FC,4DACE,UAAA/K,2BAAAA,IAACof,GAAAA,WAAA,EACc,aAAApV,KACGsU,gBACNX,UACFnC,QAAAA,YACCwD,SAAAA,aACCR,UAAAA,cACQM,iCACTjB,SACDC,QACD,OAAA5T,KACC,WACHiU,KAAAA,UACEN,OAAAA,SACCE,QACD,OAAAjT,IAAAA,IACP,GACDrO,QAAA6hB,gBAAA7hB,QAAAkhB,UAAAlhB,QAAAuiB,aAAAviB,QAAAqiB,eAAAriB,QAAAohB,SAAAphB,QAAAqhB,QAAArhB,QAAAshB,QAAAthB,QAAAuN,KAAAvN,QAAAqO,KAAArO,QAAAsO,OAAAA,MAAAtO,EAAA,EAAA,GAlBHsO;AAkBG;AC1GP,MAAMsU,YAAYC,MAAAA,KAAK,MAAM,QAAA,QAAA,EAAA,KAAA,WAAA;AAAA,SAAA,QAAO,gBAAa;AAAA,CAAA,CAAC,GAU5CC,iBAAiB,IACjBC,oBAAoB,IACpBC,SAAS,KAETC,uBAAuBvf,iBAAAA,OAAOwf,MAAAA,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA,YAKtCJ,cAAc;AAAA,WACfA,cAAc;AAAA,GAGnBK,gBAAgB3D,QAAAA,OAAOC,OAAO2D,GAAAA,OAAO,GACrCC,aAAa7D,QAAAA,OAAOC,OAAOjP,GAAAA,IAAI,GAC/B8S,iBAAiB9D,QAAAA,OAAOC,OAAOwD,oBAAoB;AAElD,SAAAM,iBAAAxjB,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GACL;AAAA,IAAAujB;AAAAA,IAAAC;AAAAA,IAAAC;AAAAA,IAAAzD;AAAAA,IAAAC;AAAAA,EAAAA,IAMIngB,OACJ;AAAA,IAAAmQ;AAAAA,EAAAA,IAAYC,OAAAA,eAAeC,aAAAA,2BAA2B,GACtD;AAAA,IAAAuT,MAAAC;AAAAA,EAAAA,IAA0BC,YAAAA;AAAU,MAAA1jB;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KACXpC,KAAA;AAAA,IAAA2jB,YAAaC,aAAAA;AAAAA,EAAAA,GAAY/jB,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAlD,QAAAgkB,UAAeC,OAAAA,UAAU9jB,EAAyB,GAClD+jB,cAAoBC,OAAAA,kBACpB,CAAAviB,SAAAwiB,UAAA,IAA8BpZ,MAAAA,SAAS,EAAI,GAC3C,CAAAqZ,UAAAC,WAAA,IAAgCtZ,MAAAA,SAAS,EAAK,GAC9C,CAAAuZ,WAAAC,YAAA,IAAkCxZ,MAAAA,SAAS,EAAK,GAChD,CAAAyZ,QAAAC,SAAA,IAA4B1Z,MAAAA,SAAwB,IAAI,GACxD2Z,OAAaN,YAAAE,aAAA3iB;AAAgC,MAAAxB;AAAAJ,IAAA,CAAA,MAAA0jB,cAAA1jB,EAAA,CAAA,MAAAkgB,eAAAlgB,EAAA,CAAA,MAAAigB,wBAAAjgB,SAAAykB,UAGzCrkB,KAAAqkB,SACIG,gDACElB,YACAe,QACAxE,sBACAjC,wBAAwBkC,WAAW,CAElC,IAPP,MAOQlgB,OAAA0jB,YAAA1jB,OAAAkgB,aAAAlgB,OAAAigB,sBAAAjgB,OAAAykB,QAAAzkB,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AATZ,QAAAoB,MAEIhB,IAWJ,CAAAiB,OAAAwjB,QAAA,IAA0B7Z,MAAAA,SAAkB,IAAI;AAChD,MAAI3J;AACF,UAAMA;AACP,MAAAqB;AAAA1C,IAAA,CAAA,MAAA4jB,aAAA5jB,SAAAkQ,KAEwCxN,KAAAA,MAAA;AACvCkhB,cAAU;AAAA,MAAAkB,UACE;AAAA,MAAIC,QACN;AAAA,MAAS9N,OACV/G,EAAE,2CAA2C;AAAA,QAAA/O,SAAU;AAAA,MAAA,CAAiB;AAAA,IAAA,CAChF;AAAA,EAAC,GACHnB,OAAA4jB,WAAA5jB,OAAAkQ,GAAAlQ,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAND,QAAAglB,uBAA6BtiB;AAMX,MAAAG;AAAA7C,WAAAgkB,WAAAhkB,EAAA,EAAA,MAAAkkB,aAAAhjB,MAEW2B,iBAAA;AAE3B,UAAAoiB,MAAY,YAAA;AACVT,mBAAa,EAAI,GACjB,MAAMU,2BAAAA,4BACJlB,SACA,uBACA,OAAO9X,SAAW,MAAlB,KAAqCiZ,SAAQzE,MAC7CwD,aAAWhjB,EACb,GACAwjB,UAAU,IAAI;AAAA,IAAC;AAEjB,QAAA;AACE,YAAMO,IAAAA;AAAAA,IAAK,SAAA/hB,KAAA;AAEX2hB,eADOxjB,GACO;AAAA,IAAC;AAEjBmjB,iBAAa,EAAK;AAAA,EAAC,GACpBxkB,OAAAgkB,SAAAhkB,EAAA,EAAA,IAAAkkB,aAAAhjB,IAAAlB,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA;AAlBD,QAAAolB,uBAA6BviB;AAkB5B,MAAAK;AAAAlD,YAAAgkB,WAAAhkB,EAAA,EAAA,MAAAkkB,aAAAhjB,MAC2BgC,iBAAA;AAE1B,UAAAmiB,QAAY,YAAA;AACVf,kBAAY,EAAI;AAEhB,YAAAgB,mBAAyB,MAAMC,2BAAAA,2BAC7BvB,SACA,uBACA,OAAO9X,SAAW,MAAlB,KAAqCiZ,SAAQzE,MAC7CwD,aAAWhjB,EACb;AACAwjB,gBAAUY,iBAAgBb,MAAO;AAAA,IAAC;AAEpC,QAAA;AACE,YAAMQ,MAAAA;AAAAA,IAAK,SAAA5hB,KAAA;AAEXwhB,eADOxjB,GACO;AAAA,IAAC;AAEjBijB,gBAAY,EAAK;AAAA,EAAC,GACnBtkB,QAAAgkB,SAAAhkB,EAAA,EAAA,IAAAkkB,aAAAhjB,IAAAlB,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAnBD,QAAAwlB,sBAA4BtiB;AAmB3B,MAAAG;AAAArD,IAAA,EAAA,MAAA4jB,aAAA5jB,UAAAkQ,KAAAlQ,EAAA,EAAA,MAAAoB,OAEiCiC,iBAAA;AAEhC,UAAAoiB,QAAY,YAAA;AACV,UAAI,CAACrkB;AACH,cAAM,IAAIgD,MAAM,gBAAgB;AAElC,YAAMshB,UAASC,UAAUC,UAAWxkB,IAAG6W,SAAAA,CAAW,GAClD2L,UAAU;AAAA,QAAAkB,UACE;AAAA,QAAIC,QACN;AAAA,QAAS9N,OACV/G,EAAE,8BAA8B;AAAA,UAAA/O,SAAU;AAAA,QAAA,CAAU;AAAA,MAAA,CAC5D;AAAA,IAAC;AAEJ,QAAA;AACE,YAAM8jB,MAAAA;AAAAA,IAAK,SAAA3hB,KAAA;AAEXuhB,eADOxjB,GACO;AAAA,IAAC;AAAA,EAChB,GACFrB,QAAA4jB,WAAA5jB,QAAAkQ,GAAAlQ,QAAAoB,KAAApB,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAlBD,QAAA6lB,gBAAsBxiB;AAkBC,MAAAC,IAAAsI;AAAA5L,YAAAgkB,WAEb1gB,KAAAA,MAAA;AACR,QAAAwiB,aAAiB,IAAIC,gBAAAA,GACrBC,WAA0B,CAAA;AAC1B,UAAAC,mBAAA,eAAAC,iBAAAC,QAAA;AACE,YAAA;AAAA,QAAAC;AAAAA,QAAAC;AAAAA,MAAAA,IAA2B,MAAMrC,QAAMsC,MACrCC,UAAAA,wBACA,CAAA,GACA;AAAA,QAAAC,gBAAiB;AAAA,QAAKN;AAAAA,QAAAO,KAAwB;AAAA,MAAA,CAChD;AACI7f,YAAKC,QAASwf,QAAQ,MACxBL,WAAWK,WAERF,OAAMO,WACThC,UAAU0B,MAAM;AAAA,IACjB,GAEHpN,eAAqBgL,QAAM2C,KAAKC,OAAAA,EAAS1N,UAAW;AAAA,MAAAvN,MAC5C7J,CAAAA,UAAA;AACAA,cAAK2C,SAAU,cACjBqhB,WAAUe,SACVf,aAAaA,IAAIC,gBAAAA,GACbjkB,MAAKH,KAAKmF,KAAM2f,CAAAA,QAAST,SAAQrT,SAAU8T,GAAG,CAAC,KAC5CR,iBAAiBnkB,MAAKZ,IAAK4kB,WAAUK,MAAO;AAAA,MAEpD;AAAA,MACF9kB,OACMwjB;AAAAA,IAAAA,CACR;AAEIoB,WAAAA,iBAAiB,MAAMH,WAAUK,MAAO,EAACW,QAAS,MAAM1C,WAAW,EAAK,CAAC,GAEvE,MAAA;AACLpL,mBAAYG,YAAAA,GACZ2M,WAAUe,MAAAA;AAAAA,IAAQ;AAAA,EACnB,GACAjb,KAAA,CAACoY,OAAM,GAAChkB,QAAAgkB,SAAAhkB,QAAAsD,IAAAtD,QAAA4L,OAAAtI,KAAAtD,EAAA,EAAA,GAAA4L,KAAA5L,EAAA,EAAA,IAnCXO,gBAAU+C,IAmCPsI,EAAQ;AAAC,MAAAK;AAAAjM,YAAAkQ,KAMQjE,KAAAiE,EAAE,uCAAuC,GAAClQ,QAAAkQ,GAAAlQ,QAAAiM,MAAAA,KAAAjM,EAAA,EAAA;AAAA,MAAAyM;AAAAzM,YAAAiM,MADxDQ,KAAAlJ,2BAAAA,IAAC8M,kCAAA,EACa,cAAApE,IACN8a,uBACD,MAAA,SACS,cAAA,KAAA,CAAI,GAClB/mB,QAAAiM,IAAAjM,QAAAyM,MAAAA,KAAAzM,EAAA,EAAA;AAAA,MAAAuN;AAAAvN,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAIWgL,MAAA;AAAA,IAAAxJ,UAAW;AAAA,EAAA,GAAI/D,QAAAuN,OAAAA,MAAAvN,EAAA,EAAA;AAAW,QAAAyN,MAAAgW,4BAAAxf,SAAA;AAAyC,MAAAoK;AAAArO,YAAA2kB,QAAA3kB,EAAA,EAAA,MAAAwjB,+BAAAxjB,EAAA,EAAA,MAAAyjB,6BAAAzjB,UAAAukB,aAAAvkB,EAAA,EAAA,MAAAqkB,YAAArkB,EAAA,EAAA,MAAA6lB,iBAAA7lB,EAAA,EAAA,MAAAolB,wBAAAplB,UAAAwlB,uBAAAxlB,EAAA,EAAA,MAAAglB,wBAAAhlB,EAAA,EAAA,MAAA4B,WAAA5B,UAAAkQ,KAAAlQ,EAAA,EAAA,MAAAoB,OAC7EiN,MAAAoV,4BAAAhT,2BAAAA,KAAA6O,WAAAA,UAAA,EAEG,UAAA;AAAA,IAAA/b,+BAAA,WAAc,OAAA;AAAA,MAAAgY,QAAS;AAAA,IAAA,GACrB,UAAA9K,2BAAAA,KAACuW,SAAA,EACU,SAAA,GACH,SACA,MAAA,GACA,MAAA,GACC,OAAA;AAAA,MAAAC,gBACW;AAAA,MAAQC,YACZ;AAAA,MAAQC,qBACC;AAAA,MAAiBC,kBACpB;AAAA,IAAA,GAER,YAAA,GACF,UAAA,GAEV,UAAA;AAAA,MAAA7jB,2BAAAA,IAACsd,0BAAAA,SAAA,EACC,SAAA,IAEE,wCAACrQ,GAAAA,MAAA,EAAW,MAAA,GACTN,UAAAA,EAAE,4CAA4C;AAAA,QAAA/O,SACpCC,MAAA,YAAA;AAAA,MAAA,CACV,EAAA,CACH,GAEkB,oBAAA,CAAC,cAAc,GACzB,WAAA,UACV,QAAA,IAEA,UAAAmC,2BAAAA,IAAC8jB,GAAAA,UACU,SAAAhD,YAAajjB,QAAQ,QAAR,CAAiBmjB,WAC7B,UAAAF,YAAAE,WACK3iB,eAAAA,SAEb,UAAC4hB,8BAEGpiB,MAAAgkB,uBAAAI,sBAFJR,sBAIyB,EAAA,CAG/B;AAAA,qCACCxU,GAAAA,MAAA,EAAW,MAAA,GAAU,QAAA,UACnBN,YAAE,0CAA0C;AAAA,QAAA/O,SAAU;AAAA,MAAA,CAAa,GACtE;AAAA,+CACQ;AAAA,qCACPqP,GAAAA,MAAA,EAAK,WAAY,MAAA,GACfN,YAAE,0CAA0C;AAAA,QAAA/O,SAAU;AAAA,MAAA,CAAc,EAAA,CACvE;AAAA,IAAA,EAAA,CACF,EAAA,CACF;AAAA,IACAoC,2BAAAA,IAACqN,GAAAA,OAAa,SAAA,GAAe,eAC3B,UAAAH,2BAAAA,KAACC,GAAAA,OAAA,EAAa,OAAA,GACZ,UAAA;AAAA,MAAAnN,+BAACwN,GAAAA,QACO,MAAA4T,QAAA,CAASvjB,MAAT,gBAAA6C,QACC,OAAA;AAAA,QAAAqjB,UACK;AAAA,QAAUC,aACP;AAAA,QAAOC,SACX;AAAA,QAAMN,YACH;AAAA,QAAQD,gBACJ;AAAA,MAAA,GAGlB,yCAACQ,QAAAA,iBAAA,EACE9C,UAAAA,sCACE,eAAA,EACC,OAAA,IACS,SAAA;AAAA,QAAA+C,SAAU;AAAA,MAAA,GACV,SAAA;AAAA,QAAAA,SAAU;AAAA,MAAA,GACb,MAAA;AAAA,QAAAA,SAAU;AAAA,MAAA,EAAC,CAAC,IAElBtmB,MAAAmC,2BAAAA,IAAA+b,WAAAA,UAAA,EAEA,0CAACjH,MAAAA,UAAA,EAAmB,UAAA9U,2BAAAA,IAAC6f,GAAAA,SAAA,CAAA,IACnB,UAAA;AAAA,QAAA7f,2BAAAA,IAAC,WAAA,EACQ,OAAA2M,EAAE,oCAAoC;AAAA,UAAA9O,KAAMA,IAAG6W,SAAAA;AAAAA,QAAU,CAAE,GAC3D,OAAA7W,IAAG6W,SAAAA,GACJ+K,cACA,OAAA,wBACI,UAAAF,iBAAiBC,kBAAAA,CAAiB;AAAA,QAE9Cxf,+BAAC,kBACU,SAAA;AAAA,UAAAmkB,SAAU;AAAA,QAAA,GACV,SAAA;AAAA,UAAAA,SAAU;AAAA,QAAA,GACb,MAAA;AAAA,UAAAA,SAAU;AAAA,QAAA,EAAC;SAErB,EAAA,CAAW,IAGbnkB,2BAAAA,IAAC,YAAA,EACC,OAAA,IACM,MAAA,GACC,OAAA;AAAA,QAAAQ,UAAW;AAAA,QAAO4jB,UAAY;AAAA,QAAQC,WAAa;AAAA,MAAA,GACjD,SAAA;AAAA,QAAAF,SAAU;AAAA,MAAA,GACV,SAAA;AAAA,QAAAA,SAAU;AAAA,MAAA,GACb,MAAA;AAAA,QAAAA,SAAU;AAAA,MAAA,GAEfxX,UAAAA,EAAE,wCAAwC,EAAA,CAC7C,GAEJ,EAAA,CACF;AAAA,MACA3M,+BAACiN,GAAAA,QAAK,OAAA,IAAY,MAAA,GACfN,UAAAA,EAAE,yCAAyC,EAAA,CAC9C;AAAA,IAAA,EAAA,CACF,EAAA,CACF;AAAA,mCACC2X,GAAAA,aAAA,EAAW;AAAA,IACZtkB,2BAAAA,IAACukB,0BAAAA,UAAA,EACW,WAAC1mB,OAADmjB,WACJwD,MAAAA,MAAAA,UACGlC,SAAAA,eACH,MAAA3V,EAAE,kCAAkC,EAAA,CAAC;AAAA,EAAA,EAAA,CAC3C,IAGJ3M,2BAAAA,IAACwN,GAAAA,MAAA,EAAc,YAAQ,MAAA,WAAkB,QAAA,GACvC,UAAAxN,2BAAAA,IAACiN,GAAAA,MAAA,EAAY,OAAA;AAAA,IAAAmX,UAAW;AAAA,EAAA,GACrBzX,YAAE,4BAA4B;AAAA,IAAA/O,SAAU;AAAA,EAAA,CAAiB,GAC5D,EAAA,CACF,GACDnB,QAAA2kB,MAAA3kB,QAAAwjB,6BAAAxjB,QAAAyjB,2BAAAzjB,QAAAukB,WAAAvkB,QAAAqkB,UAAArkB,QAAA6lB,eAAA7lB,QAAAolB,sBAAAplB,QAAAwlB,qBAAAxlB,QAAAglB,sBAAAhlB,QAAA4B,SAAA5B,QAAAkQ,GAAAlQ,QAAAoB,KAAApB,QAAAqO,OAAAA,MAAArO,EAAA,EAAA;AAAA,MAAAsO;AAAAtO,IAAA,EAAA,MAAAyN,OAAAzN,UAAAqO,OA3HHC,MAAA/K,2BAAAA,IAACykB,GAAAA,MAAA,EAAY,OAAAza,KAA0B,SAAAE,KACpCY,UAAAA,IAAAA,CA2HH,GAAOrO,QAAAyN,KAAAzN,QAAAqO,KAAArO,QAAAsO,OAAAA,MAAAtO,EAAA,EAAA;AAAA,MAAAwO;AAAAxO,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEAiM,MAAA;AAAA,IAAAyZ,eACQ;AAAA,IAAIC,WACR;AAAA,IAAQC,QACX;AAAA,EAAA,GACTnoB,QAAAwO,OAAAA,MAAAxO,EAAA,EAAA;AAAA,MAAAyO;AAAA,SAAAzO,EAAA,EAAA,MAAAsO,OAAAtO,UAAAyM,MA7IHgC,qCAAC2Z,0BAAAA,YAAA,EAEG,QAAA3b,IAOC,IAAA,cAED,MAAA6B,KA8HO,SAAAE,IAAAA,CAIR,GACDxO,QAAAsO,KAAAtO,QAAAyM,IAAAzM,QAAAyO,OAAAA,MAAAzO,EAAA,EAAA,GA9IFyO;AA8IE;ACjUN,MAAM4Z,uBAAuBtoB,CAAAA,UAAA;AAAA,QAAAC,IAAAC,uBAAA,GAAA,GAC3B;AAAA,IAAAqoB;AAAAA,IAAA9E;AAAAA,IAAAC;AAAAA,IAAA8E;AAAAA,IAAA7E;AAAAA,IAAA3G;AAAAA,IAAAyL;AAAAA,IAAAC;AAAAA,IAAA1I;AAAAA,IAAA2I;AAAAA,IAAAC;AAAAA,IAAAzI;AAAAA,IAAAa;AAAAA,IAAA6H;AAAAA,IAAAzI;AAAAA,IAAAnD;AAAAA,IAAA6L;AAAAA,IAAAC;AAAAA,IAAAnL;AAAAA,EAAAA,IAoBI5d,OAEJ;AAAA,IAAAmQ;AAAAA,EAAAA,IAAYC,OAAAA,eAAeC,aAAAA,2BAA2B;AAAC,MAAAjQ;AAAAH,IAAA,CAAA,MAAA4oB,eAAA5oB,SAAA8oB,YAGrD3oB,KAAAA,MAAMyoB,YAAYE,aAAa,YAAb,WAAA,SAA6C,GAAC9oB,OAAA4oB,aAAA5oB,OAAA8oB,UAAA9oB,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AADlE,QAAA+oB,qBAA2B5oB,IAK3B6f,wBACSG,iBAAiBgF,SAAQnE,SAAzB,KAAAb;AACS,MAAA/f;AAAAJ,IAAA,CAAA,MAAAuoB,aAAAvoB,EAAA,CAAA,MAAAyoB,aAAAzoB,EAAA,CAAA,MAAA2oB,mBAAA3oB,EAAA,CAAA,MAAA+gB,cAAA/gB,SAAAmgB,gBAEI/f,KAAAA,MAAA;AACpBqoB,cAAU,MAAA;AACHF,gBAAS3lB,YAGd+lB,gBAAeK,KAAM;AAAA,QAAAvkB,MAAO;AAAA,MAAA,CAAgB,GAG5CgN,OAAMlQ,OAAQgnB,UAAS3lB,SAAU;AAAA,QAAA+b,KAAM,GAAGwB,YAAY,GAAGY,cAAA,GAAiB;AAAA,MAAA,CAAG;AAAA,IAAC,CAC/E;AAAA,EAAC,GACH/gB,OAAAuoB,WAAAvoB,OAAAyoB,WAAAzoB,OAAA2oB,iBAAA3oB,OAAA+gB,YAAA/gB,OAAAmgB,cAAAngB,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAVD,QAAAipB,gBAAsB7oB,IAYtB8oB,YAAkBrL,MAAAA,YAAY8K,iBAAiBroB,OAAmC,GAClF6oB,WAAiBtL,MAAAA,YAAY8K,iBAAiBviB,QAAkC,GAChFgjB,eAAqBvL,MAAAA,YAAY8K,iBAAiBriB,QAElD,GACA+iB,cAAoBxL,MAAAA,YAAY8K,iBAAiBtT,QAA+C,GAChGiU,kBAAwBzL,kBACtB8K,iBACApT,QACF;AAAC,MAAA7S;AAAA,MAAA1C,EAAA,CAAA,MAAA+gB,cAAA/gB,UAAAmgB,cAAA;AAGC,UAAAoJ,aAAmB,IAAInJ,IAAIW,cAAA,KAAmBZ,YAAY;AAC/Bzd,SAAA8mB,0BAAAA,0BAA0BD,UAAU,GAACvpB,OAAA+gB,YAAA/gB,QAAAmgB,cAAAngB,QAAA0C;AAAAA,EAAA;AAAAA,SAAA1C,EAAA,EAAA;AAAhE,QAAA;AAAA,IAAAsgB;AAAAA,IAAAC;AAAAA,EAAAA,IAA2B7d,IAF7Bud,uBAIE,GAAUK,QAAQ,GAAGC,MAAM,IAG7BkJ,6BAAmCvL,MAAAA,GAMnCwL,iBAAuB7L,MAAAA,YAAYF,eAAelI,MAA+B;AAAC,MAAA5S;AAAA7C,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAG/BM,KAAA;AAAA,IAAAuF,OAAQ;AAAA,EAAA,GAAOpI,QAAA6C,MAAAA,KAAA7C,EAAA,EAAA;AAAA,MAAAkD;AAAAlD,IAAA,EAAA,MAAA+c,oBAAA/c,UAAAkQ,KAAAlQ,EAAA,EAAA,MAAAgd,mBAC7D9Z,KAAA8Z,mBACCzZ,2BAAAA,IAAC8M,kCAAA,EACa,cAAAH,EAAE,kDAAkD,GAC1DyZ,MAAAA,MAAAA,eACD,MAAA,SACI3M,SAAAA,iBACCD,UAAAA,kBACI,cAAA;AAAA,IAAA6M,SACHrmB,2BAAAA,IAACiN,GAAAA,MAAA,EAAW,MAAA,GAAIN,UAAAA,EAAE,+CAA+C,GAAE;AAAA,IAAO2Z,oBAC/D,CAAC,cAAc;AAAA,IAAC3B,WACzB;AAAA,EAAA,GACZ,GAEJloB,QAAA+c,kBAAA/c,QAAAkQ,GAAAlQ,QAAAgd,iBAAAhd,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAAA,MAAAqD;AAAArD,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAK+Bc,KAAA;AAAA,IAAAymB,YAAa;AAAA,EAAA,GAAS9pB,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAIjC,QAAAsD,KAAAgmB,kBAAA,YAAA;AAAsC,MAAA1d;AAAA5L,IAAA,EAAA,MAAAkQ,KAAAlQ,UAAAsD,MADhDsI,KAAAsE,EAAE,+CAA+C;AAAA,IAAA/O,SACvCmC;AAAAA,EAAAA,CACV,GAACtD,QAAAkQ,GAAAlQ,QAAAsD,IAAAtD,QAAA4L,MAAAA,KAAA5L,EAAA,EAAA;AAAA,MAAAiM;AAAAjM,YAAA4L,MAJNK,KAAA1I,2BAAAA,IAACqN,GAAAA,KAAA,EAAa,SAAA,GACZ,UAAArN,2BAAAA,IAACiN,GAAAA,MAAA,EAAW,MAAA,GACT5E,cAGH,EAAA,CACF,GAAM5L,QAAA4L,IAAA5L,QAAAiM,MAAAA,KAAAjM,EAAA,EAAA;AAAA,MAAAyM;AAAAzM,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KACNkK,oCAACmE,GAAAA,KAAA,EAAc,aACb,UAAArN,+BAACwmB,GAAAA,SAAA,EAAc,MAAA,CAAC,KAAK,GAAU,OAAA;AAAA,IAAAC,WAAY;AAAA,IAAEC,cAAgB;AAAA,EAAA,GAAG,GAClE,GAAMjqB,QAAAyM,MAAAA,KAAAzM,EAAA,EAAA;AAAA,MAAAuN;AAAAvN,YAAAiM,MAVRsB,sCAACsD,SAAA,EAAW,OAAA,UAAgB,OAAAxN,IAC1B4I,UAAAA;AAAAA,IAAAA;AAAAA,IAOAQ;AAAAA,EAAAA,EAAAA,CAGF,GAAOzM,QAAAiM,IAAAjM,QAAAuN,OAAAA,MAAAvN,EAAA,EAAA;AAAA,MAAAyN;AAAAzN,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEWkL,MAAA,CAAC,cAAc,GAACzN,QAAAyN,OAAAA,MAAAzN,EAAA,EAAA;AAAA,MAAAqO;AAAArO,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAS3B8L,MAAA;AAAA,IAAA6b,YACO;AAAA,IAACC,cACC;AAAA,IAAG3O,YACL;AAAA,EAAA,GACbxb,QAAAqO,OAAAA,MAAArO,EAAA,EAAA;AACK,QAAAsO,MAAAgb,kBAAA,gBAAArlB;AAA2C,MAAAuK;AAAAxO,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAGnCiM,MAAA;AAAA,IAAA4b,QAAS;AAAA,EAAA,GAAGpqB,QAAAwO,OAAAA,MAAAxO,EAAA,EAAA;AAEL,QAAAyO,OAAC0a,UAGNra,MAAAoa,aAAaR,uBAAuB;AAAW,MAAA3Z;AAAA/O,IAAA,EAAA,MAAAspB,mBAAAtpB,EAAA,EAAA,MAAAyO,OAAAzO,EAAA,EAAA,MAAA8O,OAAA9O,UAAA6oB,iBAL7D9Z,MAAAxL,2BAAAA,IAAA,OAAA,EAAY,OAAAiL,KACV,UAAAjL,2BAAAA,IAAC8jB,GAAAA,QAAA,EACgB,eAAA5Y,KACN6a,SAAAA,iBACCT,UAAAA,eACA,UAAA/Z,IAAAA,CAA+C,EAAA,CAE7D,GAAM9O,QAAAspB,iBAAAtpB,QAAAyO,KAAAzO,QAAA8O,KAAA9O,QAAA6oB,eAAA7oB,QAAA+O,OAAAA,MAAA/O,EAAA,EAAA;AAES,QAAAgP,OAACsa;AAAe,MAAAra;AAAAjP,YAAAkQ,KAC1BjB,MAAAiB,EAAE,0CAA0C,GAAClQ,QAAAkQ,GAAAlQ,QAAAiP,OAAAA,MAAAjP,EAAA,EAAA;AAAA,MAAA0P;AAAA1P,IAAA,EAAA,MAAAgP,OAAAhP,UAAAiP,OAFlDS,MAAAnM,2BAAAA,IAACqN,GAAAA,OACC,UAAArN,2BAAAA,IAACiN,GAAAA,MAAA,EAAY,OAAAxB,KAAwB,MAAA,GAAU,QAAA,UAC5CC,UAAAA,KACH,GACF,GAAMjP,QAAAgP,KAAAhP,QAAAiP,KAAAjP,QAAA0P,OAAAA,MAAA1P,EAAA,EAAA;AAAA,MAAA2P;AAAA3P,IAAA,EAAA,MAAA+O,OAAA/O,UAAA0P,OAbRC,sCAACkB,GAAAA,MAAA,EAAW,OAAA,UAAc,QACxB9B,UAAAA;AAAAA,IAAAA;AAAAA,IAQAW;AAAAA,EAAAA,EAAAA,CAKF,GAAO1P,QAAA+O,KAAA/O,QAAA0P,KAAA1P,QAAA2P,OAAAA,MAAA3P,EAAA,EAAA;AAAA,MAAA4P;AAAA5P,IAAA,EAAA,MAAAsO,OAAAtO,UAAA2P,OA1BTC,qCAACmB,GAAAA,QACI,IAAA,SACE,MAAA,QACI,SAAA,GACA,SAAA,GACF,OAAA1C,KAKD,MAAAC,KAENqB,UAAAA,IAAAA,CAeF,GAAO3P,QAAAsO,KAAAtO,QAAA2P,KAAA3P,QAAA4P,OAAAA,MAAA5P,EAAA,EAAA;AAAA,MAAAqqB;AAAArqB,IAAA,EAAA,MAAAuN,OAAAvN,UAAA4P,OA/CTya,MAAA9mB,2BAAAA,IAACsd,0BAAAA,WACC,SAAA,IAEE,SAAAtT,KAakB,oBAAAE,KACV,WAAA,UACV,QAAA,IAEAmC,UAAAA,IAAAA,CA4BF,GAAU5P,QAAAuN,KAAAvN,QAAA4P,KAAA5P,QAAAqqB,OAAAA,MAAArqB,EAAA,EAAA;AAAA,MAAAsqB;AAAAtqB,IAAA,EAAA,MAAAmpB,YAAAnpB,EAAA,EAAA,MAAAkpB,aAAAlpB,EAAA,EAAA,MAAAopB,gBAAAppB,EAAA,EAAA,MAAAqpB,eAAArpB,UAAAkQ,KAWKoa,MAAAnB,WACGjZ,EAAE,sCASD,IARDA,EAAE,wBAAwB;AAAA,IAAA/O,SACf+nB,YAAA,YAELE,eAAA,eAEEC,cAAA,cAAA;AAAA,EAAA,CAGP,GAACrpB,QAAAmpB,UAAAnpB,QAAAkpB,WAAAlpB,QAAAopB,cAAAppB,QAAAqpB,aAAArpB,QAAAkQ,GAAAlQ,QAAAsqB,OAAAA,MAAAtqB,EAAA,EAAA;AAAA,MAAAuqB;AAAAvqB,YAAAsqB,OAXRC,MAAAhnB,+BAACiN,GAAAA,MAAA,EAAW,MAAA,GACT8Z,UAAAA,KAWH,GAAOtqB,QAAAsqB,KAAAtqB,QAAAuqB,OAAAA,MAAAvqB,EAAA,EAAA;AAAA,MAAAwqB;AAAAxqB,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEWioB,MAAA,CAAC,YAAY,GAACxqB,QAAAwqB,OAAAA,MAAAxqB,EAAA,EAAA;AAAA,MAAAyqB;AAAAzqB,YAAAkQ,KAKpBua,MAAAva,EAAE,yCAAyC,GAAClQ,QAAAkQ,GAAAlQ,QAAAyqB,OAAAA,MAAAzqB,EAAA,EAAA;AAG/C,QAAA0qB,MAAArB,eAAAD,gBAAAM;AAA6C,MAAAiB;AAAA3qB,IAAA,EAAA,MAAAipB,iBAAAjpB,UAAAyqB,OAAAzqB,EAAA,EAAA,MAAA0qB,OAJxDC,qCAACta,kCAAA,EACa,cAAAoa,KACNG,MAAAA,mBACD,MAAA,SACI,SAAAF,KACAzB,SAAAA,eACK,cAAA,MAAI,GAClBjpB,QAAAipB,eAAAjpB,QAAAyqB,KAAAzqB,QAAA0qB,KAAA1qB,QAAA2qB,OAAAA,MAAA3qB,EAAA,EAAA;AAAA,MAAA6qB;AAAA7qB,IAAA,EAAA,MAAAuqB,OAAAvqB,UAAA2qB,OA7BNE,qCAACja,GAAAA,KAAA,EAAa,SAAA,GACZ,UAAArN,2BAAAA,IAACsd,0BAAAA,SAAA,EACC,SAAA,IAEE,SAAA0J,KAckB,oBAAAC,KACV,WAAA,UACV,QAAA,IAEAG,UAAAA,IAAAA,CAQF,GACF,GAAM3qB,QAAAuqB,KAAAvqB,QAAA2qB,KAAA3qB,QAAA6qB,OAAAA,MAAA7qB,EAAA,EAAA;AAAA,MAAA8qB;AAAA9qB,IAAA,EAAA,MAAA+f,aAAA/f,EAAA,EAAA,MAAAkgB,eAAAlgB,EAAA,EAAA,MAAAggB,yBAAAhgB,EAAA,EAAA,MAAAigB,wBAAAjgB,UAAAmgB,gBAIN2K,qCAACla,GAAAA,KAAA,EAAa,YACZ,UAAArN,2BAAAA,IAAC,mBAAA,EACYwc,WACYC,uBACDC,sBACTC,aACCC,aAAAA,CAAY,GAE9B,GAAMngB,QAAA+f,WAAA/f,QAAAkgB,aAAAlgB,QAAAggB,uBAAAhgB,QAAAigB,sBAAAjgB,QAAAmgB,cAAAngB,QAAA8qB,OAAAA,MAAA9qB,EAAA,EAAA;AAAA,MAAA+qB;AAAA/qB,IAAA,EAAA,MAAAwoB,gBAAAxoB,EAAA,EAAA,MAAAigB,wBAAAjgB,EAAA,EAAA,MAAA2d,iBAAA3d,EAAA,EAAA,MAAA6qB,OAAA7qB,UAAA8qB,OA/CZC,qCAACna,GAAAA,KAAA,EAAU,SACT,UAAArN,2BAAAA,IAAC,sBAAA,EACgBoa,eAEb,QAAAkN,KAiCQrC,UAAAA,cAER,QAAAsC,KAUK7K,OAAAA,qBAAAA,CAAoB,EAAA,CAE/B,GAAMjgB,QAAAwoB,cAAAxoB,QAAAigB,sBAAAjgB,QAAA2d,eAAA3d,QAAA6qB,KAAA7qB,QAAA8qB,KAAA9qB,QAAA+qB,OAAAA,MAAA/qB,EAAA,EAAA;AAAA,MAAAgrB;AAAAhrB,YAAAypB,8BAKGuB,MAAAC,CAAAA,SAAA;AACHA,UAAIzmB,MAAmB0mB,YAAC,wBAAwBzB,0BAA0B;AAAA,EAAC,GAC5EzpB,QAAAypB,4BAAAzpB,QAAAgrB,OAAAA,MAAAhrB,EAAA,EAAA;AAIc,QAAAmrB,MAAArC,aAAa,YAAb,WAAA;AAA0C,MAAAsC;AAAAprB,IAAA,EAAA,MAAAkQ,KAAAlQ,UAAAmrB,OADpDC,MAAAlb,EAAE,yCAAyC;AAAA,IAAA/O,SACjCgqB;AAAAA,EAAAA,CACV,GAACnrB,QAAAkQ,GAAAlQ,QAAAmrB,KAAAnrB,QAAAorB,OAAAA,MAAAprB,EAAA,EAAA;AAAA,MAAAqrB;AAAArrB,YAAAorB,OAHJC,MAAA9nB,+BAACiN,GAAAA,MAAA,EAAW,MAAA,GACT4a,UAAAA,KAGH,GAAOprB,QAAAorB,KAAAprB,QAAAqrB,OAAAA,MAAArrB,EAAA,EAAA;AAAA,MAAAsrB;AAAAtrB,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEW+oB,MAAA,CAAC,cAAc,GAACtrB,QAAAsrB,OAAAA,MAAAtrB,EAAA,EAAA;AAAA,MAAAurB;AAAAvrB,YAAAkQ,KAOtBqb,MAAArb,EAAE,0CAA0C,GAAClQ,QAAAkQ,GAAAlQ,QAAAurB,OAAAA,MAAAvrB,EAAA,EAAA;AACnD,QAAAwrB,MAAA1C,aAAa,YAAb2C,MAAAA,mBAAAC,MAAAA;AAAuD,MAAAC;AAAA3rB,IAAA,EAAA,MAAAurB,OAAAvrB,EAAA,EAAA,MAAAwrB,OAAAxrB,EAAA,EAAA,MAAA+oB,sBAAA/oB,UAAA8oB,YAJ/D6C,qCAACtb,0BAAAA,QAAA,EACa,eAAA,2BACGyY,iBAAAA,UACH,cAAAyC,KACN,MAAAC,KACD,MAAA,SACIzC,6BACK,cAAA,KAAA,CAAI,GAClB/oB,QAAAurB,KAAAvrB,QAAAwrB,KAAAxrB,QAAA+oB,oBAAA/oB,QAAA8oB,UAAA9oB,QAAA2rB,OAAAA,MAAA3rB,EAAA,EAAA;AAAA,MAAA4rB;AAAA5rB,IAAA,EAAA,MAAAgrB,OAAAhrB,UAAAqrB,OAAArrB,EAAA,EAAA,MAAA2rB,OAzBNC,qCAAC/a,GAAAA,MAAA,EAAW,OAAA,UAAc,MAAA,QAAY,KAAA,GACpC,UAAAtN,2BAAAA,IAACsd,0BAAAA,SAAA,EACC,SAAA,IACK,KAAAmK,KAIH,SAAAK,KAMkB,oBAAAC,KACV,WAAA,UACV,QAAA,IAEAK,UAAAA,IAAAA,CASF,EAAA,CACF,GAAO3rB,QAAAgrB,KAAAhrB,QAAAqrB,KAAArrB,QAAA2rB,KAAA3rB,QAAA4rB,OAAAA,MAAA5rB,EAAA,EAAA;AAAA,MAAA6rB;AAAA7rB,YAAAsoB,yBAAAtoB,EAAA,EAAA,MAAAwjB,+BAAAxjB,EAAA,EAAA,MAAAyjB,6BAAAzjB,EAAA,GAAA,MAAA0jB,cAAA1jB,WAAAkgB,eAAAlgB,EAAA,GAAA,MAAAigB,wBAEN4L,MAAAvD,yBACC/kB,2BAAAA,IAACsN,SAAA,EAAW,OAAA,UAAc,MAAA,QAAY,KAAA,GACpC,UAAAtN,2BAAAA,IAAC,kBAAA,EAC8BigB,6BACFC,2BACLxD,sBACVyD,YACCxD,YAAAA,CAAW,EAAA,CAE5B,GACDlgB,QAAAsoB,uBAAAtoB,QAAAwjB,6BAAAxjB,QAAAyjB,2BAAAzjB,SAAA0jB,YAAA1jB,SAAAkgB,aAAAlgB,SAAAigB,sBAAAjgB,SAAA6rB,OAAAA,MAAA7rB,EAAA,GAAA;AAAA,MAAA8rB;AAAA,SAAA9rB,EAAA,GAAA,MAAAqqB,OAAArqB,EAAA,GAAA,MAAA+qB,OAAA/qB,EAAA,GAAA,MAAAkD,MAAAlD,EAAA,GAAA,MAAA4rB,OAAA5rB,WAAA6rB,OA9JHC,sCAACjb,GAAAA,MAAA,EAAW,OAAA,UAAc,KAAA,GAAa,aAAU,OAAAhO,IAC9CK,UAAAA;AAAAA,IAAAA;AAAAA,IAeDmnB;AAAAA,IAkDAU;AAAAA,IAqDAa;AAAAA,IA6BCC;AAAAA,EAAAA,EAAAA,CAWH,GAAO7rB,SAAAqqB,KAAArqB,SAAA+qB,KAAA/qB,SAAAkD,IAAAlD,SAAA4rB,KAAA5rB,SAAA6rB,KAAA7rB,SAAA8rB,OAAAA,MAAA9rB,EAAA,GAAA,GA/JP8rB;AA+JO;AAKJ,SAAAC,cAAAhsB,OAAA;AAAA,QAAAC,IAAAC,uBAAA,CAAA,GAIL+rB,gBAAsBpW,QAItBqW,kBAAwBlsB,MAAKyU,SAAmBoI;AAAA,MAAAzc;AAAAH,IAAA,CAAA,MAAAisB,mBAAAjsB,SAAAD,SACjCI,KAAA8rB,kBACb1oB,2BAAAA,IAAC,iBAAA,KAAoBxD,OAAsBisB,cAAAA,CAAa,IAExDA,cAAcjsB,KAChB,GAACC,OAAAisB,iBAAAjsB,OAAAD,OAAAC,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAJD,QAAAksB,SAAe/rB;AAId,MAAAC;AAAAJ,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAGmDnC,KAAA;AAAA,IAAAknB,UAAW;AAAA,EAAA,GAAWtnB,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAA,MAAA0C;AAAA1C,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAC1CG,KAAA;AAAA,IAAAypB,WAAY;AAAA,EAAA,GAAEnsB,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAAA,MAAA6C;AAAA,SAAA7C,SAAAksB,UAD5CrpB,oCAACkO,GAAAA,MAAA,EAAU,MAAA,QAAgB,YAAG,cAAA,IAAoB,OAAA3Q,IAChD,UAAAmD,2BAAAA,IAACsN,GAAAA,MAAA,EAAW,OAAA,UAAgB,OAAAnO,sBAE5B,EAAA,CACF,GAAO1C,OAAAksB,QAAAlsB,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA,GAJP6C;AAIO;AApBJ,SAAA+S,OAAA2D,SAAA;AAAA,SAKIhW,+BAAC,sBAAA,EAAoB,GAAKxD,QAAAA,CAAK;AAAI;AAlPjB,SAAAO,QAAAqC,OAAA;AAAA,SA8C+BA,MAAKypB,QAAS,SAAS;AAAC;AA9CvD,SAAAhmB,SAAAimB,SAAA;AAAA,SA+C8B1pB,QAAKypB,QAAS,QAAQ;AAAC;AA/CrD,SAAA9lB,SAAAgmB,SAAA;AAAA,SAiDzB3pB,QAAKypB,QAAS;AAAA,IAAAvqB,QAAS;AAAA,EAAA,CAAa;AAAC;AAjDZ,SAAAwT,SAAAkX,SAAA;AAAA,SAmDiC5pB,QAAKypB,QAAS;AAAA,IAAAvqB,QAAS;AAAA,EAAA,CAAY;AAAC;AAnDrE,SAAA0T,SAAAiX,SAAA;AAAA,SAsDd7pB,QAAKxB,QAAQG;AAA6B;AAtD5B,SAAAmU,OAAAgX,SAAA;AAAA,SAsEkC9pB,QAAK+pB,OAAQ,MAAM;AAAC;AChCnF,MAAMC,aAAanN,QAAAA,OAAOC,OAAO5O,OAAI,GA2BxB+b,UAAUpsB,MAAAA,KACrByQ,MAAAA,WAA4C,SAA0BlR,OAAOwe,cAAc;AACzF,QAAM;AAAA,IACJ2N;AAAAA,IACAxI;AAAAA,IACAmJ;AAAAA,IACAnE;AAAAA,IACAxI;AAAAA,IACA4I;AAAAA,IACAgE;AAAAA,IACAnE;AAAAA,IACAhL;AAAAA,EAAAA,IACE5d,OAEE,CAACgtB,mBAAmBC,oBAAoB,IAAIhiB,MAAAA,SAAoC,IAAI,GACpFiiB,iBAAiBjP,wBACrB+O,sBAAsB,OAAO7M,cAAc6M,iBAC7C,GACMhM,aAAamM,MAAAA,QAAQ,MAAM;AAC/B,UAAM9rB,MAAM,IAAIgf,IAAIsD,UAAU;AAE9B,WAAKtiB,IAAImQ,aAAapL,IAAIka,UAAAA,gCAAgC,KACxDjf,IAAImQ,aAAalL,IAAIga,UAAAA,kCAAkC4M,cAAc,IAGnEH,0BAA0B1rB,IAAImQ,aAAapL,IAAIgnB,8CAAoC,MAErF/rB,IAAImQ,aAAalL,IACf+mB,+CACA,cACF,GAGEN,0BAA0B,CAAC1rB,IAAImQ,aAAapL,IAAIgnB,UAAAA,oCAAoC,KACtF/rB,IAAImQ,aAAalL,IAAI8mB,UAAAA,sCAAsCL,sBAAsB,GAG5E1rB;AAAAA,EACT,GAAG,CAACsiB,YAAYuJ,gBAAgBH,sBAAsB,CAAC;AAEvDvsB,QAAAA,UAAU,MAAM;AAIVssB,0BAAsB,eAIxBG,qBAAsBvhB,UAAUA,SAAS,OAAOyU,cAAczU,IAAK;AAAA,EAEvE,GAAG,CAACohB,mBAAmB3M,WAAW,CAAC;AAEnC,QAAM;AAAA,IAAChQ;AAAAA,EAAAA,IAAKC,OAAAA,eAAeC,aAAAA,2BAA2B,GAChD;AAAA,IAACwG;AAAAA,EAAAA,IAAWC,aAAAA,oBAAAA,GACZwW,uBAAuBC,GAAAA,wBAAAA,GACvBpc,MAAMzO,MAAAA,OAAiC,IAAI,GAE3C8qB,+CAAiB,eAAA,EAAc,GAAIxtB,OAAO,WAAWmR,KAAK,SAASgb,QAAO;AAGhFrN,QAAAA,oBACEN,cACA,MAAMrN,IAAItO,OACZ;AAEA,QAAMsmB,YAAYrL,MAAAA,YAChB8K,iBACChmB,CAAAA,UAAUA,MAAMypB,QAAQ,SAAS,KAAKzpB,MAAMypB,QAAQ;AAAA,IAACvqB,QAAQ;AAAA,EAAA,CAAY,CAC5E,GAEM,CAAC2rB,UAAUC,WAAW,IAAIziB,MAAAA,SAAS,EAAK,GACxCoe,eAAevL,MAAAA,YAAY8K,iBAAkBhmB,CAAAA,YACjDA,QAAMypB,QAAQ;AAAA,IAACvqB,QAAQ;AAAA,EAAA,CAAa,CACtC,GACM,CAAC6rB,kBAAkBC,mBAAmB,IAAI3iB,MAAAA,SAAS,EAAK,GACxD4iB,eAAe1E,aAAaE,gBAAgBV,uBAAuB,cAEnEtR,cAAcyW,MAAAA,YAAY,MAAM;AAC/B3c,QAAItO,YAITsO,IAAItO,QAAQ+b,MAAMoC,WAAW9I,SAAAA,GAE7B0Q,gBAAgBK,KAAK;AAAA,MAACvkB,MAAM;AAAA,IAAA,CAAgB;AAAA,EAC9C,GAAG,CAACkkB,iBAAiB5H,UAAU,CAAC,GAE1B,CAAC+M,gBAAgBC,iBAAiB,IAAI/iB,MAAAA,SAAS,EAAK,GACpDgjB,uBAAuBH,MAAAA,YAAY,MAAM;AAC7CE,sBAAkB,EAAI;AAAA,EACxB,GAAG,CAAA,CAAE,GACC,CAACE,8BAA8BC,8BAA8B,IAAIljB,MAAAA,SAAS,EAAK;AACrFzK,QAAAA,UAAU,MAAM;AACd,QAAI2oB,EAAAA,aAAaE,kBAIbV,uBAAuB,gBAAgBA,uBAAuB,iBAAgB;AAChF,YAAM7jB,UAAUI,WAAW,MAAM;AAC/BipB,uCAA+B,EAAI;AAAA,MACrC,GAAG,GAAK;AACR,aAAO,MAAMlpB,aAAaH,OAAO;AAAA,IACnC;AAAA,EAEF,GAAG,CAAC6jB,oBAAoBQ,WAAWE,YAAY,CAAC,GAEhD7oB,MAAAA,UAAU,MAAM;AACd,QAAI2oB,EAAAA,aAAaE,gBAAgB,CAAC6E,+BASlC;AAAA,UANIvF,uBAAuB,gBACzBiF,oBAAoB,EAAK,GACzBO,+BAA+B,EAAK,GACpCT,YAAY,EAAK,GACjBM,kBAAkB,EAAK,IAErBrF,uBAAuB,cAAc;AACvC,cAAM7jB,YAAUI,WAAW,MAAM;AAC/BwoB,sBAAY,EAAI,GAChBvZ,QAAQ7S,MACN,gGACF;AAAA,QACF,GAAG8sB,aAAAA,+BAA+B;AAClC,eAAO,MAAMnpB,aAAaH,SAAO;AAAA,MACnC;AACA,UAAI6jB,uBAAuB,gBAAgB;AACzC,cAAM7jB,YAAUI,WAAW,MAAM;AAC/BwoB,sBAAY,EAAI,GAChBE,oBAAoB,EAAI;AAAA,QAC1B,GAAGQ,aAAAA,+BAA+B;AAClC,eAAO,MAAMnpB,aAAaH,SAAO;AAAA,MACnC;AAAA,IAAA;AAAA,EAEF,GAAG,CAACqkB,WAAWR,oBAAoBU,cAAc6E,4BAA4B,CAAC;AAE9E,QAAMG,eAAeP,MAAAA,YAAY,MAAM;AACrClF,oBAAgBK,KAAK;AAAA,MAACvkB,MAAM;AAAA,IAAA,CAAgB;AAAA,EAC9C,GAAG,CAACkkB,eAAe,CAAC,GAEd0F,2BAA2BnB,MAAAA,QAAQ,OAEpChE,aAAcR,uBAAuB,gBAAgB,CAACU,iBAAkB,CAAC0E,gBAE3E,CAACA,gBAAgB5E,WAAWE,cAAcV,kBAAkB,CAAC,GAE1D4F,uBAAuBC,MAAAA;AAAAA;AAAAA,IAE3BV,MAAAA,YAAY,MAAM,MAAM;AAAA,IAAC,GAAG,CAAA,CAAE;AAAA,IAC9B,MAAMW,IAAIC,SAAS,8BAA8B;AAAA,EAAA,GAE7CC,mBAAmBxB,MAAAA,QAAQ,MACxB;AAAA,IACLmB,2BAA2B,eAAe;AAAA,IAC1CnF,YAAY,cAAc;AAAA;AAAA,IAE1BoF,uBAAuB,KAAKxF;AAAAA,IAC5BmF,gCAAgC,CAACH,iBAAiB,aAAa;AAAA,EAAA,GAEhE,CACDQ,sBACAR,gBACA5E,WACAmF,0BACAJ,8BACAnF,QAAQ,CACT,GAEK,CAAC6F,iBAAiBC,kBAAkB,IAAI5jB,MAAAA,SAAS8d,QAAQ,GACzD,CAAC+F,aAAaC,cAAc,IAAI9jB,MAAAA,SAAS+jB,eAAejG,QAAQ,CAAC;AACvEvoB,QAAAA,UAAU,MAAM;AACd,QAAI+tB,wBAAwBxF,aAAa6F,iBAAiB;AACxD,YAAMK,SAASA,MAAM;AACnBJ,2BAAmB9F,QAAQ,GAC3BgG,eAAeC,eAAejG,QAAQ,CAAC;AAAA,MACzC;AAEE,OAACuE,wBACD,yBAAyBvW,YACzB,OAAOA,SAASmY,uBAAwB,aAExCnY,SAASmY,oBAAoB;AAAA,QAC3BD,QAAQA,MAAME,SAAAA,UAAU,MAAMF,QAAQ;AAAA,QACtCnuB,OAAO,CAAC,wBAAwB;AAAA,MAAA,CACjC,IAEDmuB,OAAAA;AAAAA,IAEJ;AAAA,EACF,GAAG,CAACV,sBAAsBjB,sBAAsBsB,iBAAiB7F,QAAQ,CAAC;AAE1E,QAAMqG,QAAQtL,YAAAA,GACR9F,eAAeL,iBAAiBC,aAAa,GAC7C,CAACyR,aAAaC,cAAc,IAAIrkB,MAAAA,SAAyB,EAAK,GAC9D,CAACskB,kBAAkB,IAAItkB,eAAS,oBAAIukB,KAAa,GACjDC,0BAA0BC,8BAAgBC,CAAAA,mBAA2B;AACzE,QAAI3R,aAAajX,KAAM6oB,CAAAA,UAAUA,MAAMzN,KAAKwN,cAAc,CAAC,GAAG;AAC5DL,qBAAeK,cAAc;AAC7B;AAAA,IACF;AACIJ,uBAAmB5jB,IAAIgkB,cAAc,MACzCJ,mBAAmBM,IAAIF,cAAc,GACrCxb,QAAQC,KAAK,4CAA4C;AAAA,MAACub;AAAAA,IAAAA,CAAe,GACzEP,MAAMxL,KAAK;AAAA,MACTmB,UAAU;AAAA,MACV5jB,IAAI,uCAAuCwuB,cAAc;AAAA,MACzD3K,QAAQ;AAAA,MACR8K,UAAUC;AAAAA,MACV7Y,OAAO/G,EAAE,yCAAyC;AAAA,MAClDxO,aACE6B,2BAAAA,IAAC0W,kBAAA,EACC,GACA,SAAQ,iDACR,YAAY;AAAA,QAACxD,MAAM;AAAA,MAAA,GACnB,QAAQ;AAAA,QACN0J,cAAcY,WAAWC;AAAAA,QACzB0O;AAAAA,MAAAA,EACF,CAAE;AAAA,IAAA,CAGP;AAAA,EACH,CAAC,GACKtT,WAAW2T,aAAAA,2BACXC,gBAAgBP,eAAAA,eAAgBruB,CAAAA,UAAgB;AACpD,QAAI,CAACguB,YAAa;AAClB,UAAMa,UAAU,IAAI7P,IAAIhf,OAAKguB,WAAW;AACxChT,aAAS,GAAGgT,WAAW,GAAGa,QAAQ3P,QAAQ,GAAG2P,QAAQ1P,MAAM,GAAG0P,QAAQC,IAAI,EAAE;AAAA,EAC9E,CAAC;AACD3vB,SAAAA,MAAAA,UAAU,MAAM;AACd,QAAI,CAAC6uB;AACH;AAEF,UAAM5tB,SAAS0P,IAAItO,SAASutB;AAC5B,QAAI,CAAC3uB;AACH;AAEF,UAAMskB,aAAasK,QAAAA,iBAAiB;AAAA,MAACjQ,cAAciP;AAAAA,IAAAA,CAAY;AAC/DtJ,eAAWuK,UAAU7uB,MAAM;AAC3B,UAAMtB,YAAU4lB,WAAWwK,cACzB;AAAA,MACE9S,MAAM;AAAA,MACN+S,WAAW;AAAA,MACXC,WAAW;AAAA,IAAA,GAEbC,QAAAA,wBAAAA,EAA4EC,QAAQ;AAAA,MAClF3vB,QAAQ4vB,oBAAAA,0BAAAA;AAAAA,IAAsD,CAC/D,CACH;AAEAzwB,cAAQG,GAAG,2BAA4BqF,CAAAA,SAAS;AAC9CsqB,oBAActqB,KAAKtE,GAAG;AAAA,IACxB,CAAC;AACD,UAAMwvB,OAAO1wB,UAAQ2wB,MAAAA;AAErB,WAAO,MAAM;AACXD,WAAAA,GACA9K,WAAWgL,QAAAA;AAAAA,IACb;AAAA,EACF,GAAG,CAAC1B,WAAW,CAAC,GAChB7uB,MAAAA,UAAU,MAAM;AACd,QAAImoB,uBAAuB,gBAAgBA,uBAAuB,gBAAgB;AAChF,YAAMqI,WAAWC,YAAY,MAAM;AACjC9f,YAAItO,SAASutB,eAAec;AAAAA,UAC1B;AAAA,YAACC,QAAQ;AAAA,YAAmBvnB,MAAM;AAAA,YAAgBlF,MAAM;AAAA,UAAA;AAAA;AAAA;AAAA;AAAA,UAIxD;AAAA,QAAA;AAAA,MAEJ,GAAG,GAAK,GAEFqhB,eAAa,IAAIC,gBAAAA;AACvB7Z,aAAAA,OAAOwP,iBACL,WACA,CAAC;AAAA,QAAChW,MAAAA;AAAAA,MAAAA,MAAiC;AAK/BA,kBACA,OAAOA,UAAS,YAChB,YAAYA,UACZA,OAAKwrB,WAAW,qBAChB,UAAUxrB,UACVA,OAAKjB,SAAS,2BACd,UAAUiB,UACV,OAAOA,OAAKA,QAAS,YACrBA,OAAKA,QACL,YAAYA,OAAKA,QACjB,OAAOA,OAAKA,KAAKsb,UAAW,YAE5BwO,wBAAwB9pB,OAAKA,KAAKsb,MAAM;AAAA,MAE5C,GACA;AAAA,QAACmF,QAAQL,aAAWK;AAAAA,MAAAA,CACtB,GAEO,MAAM;AACXL,qBAAWe,MAAAA,GACXsK,cAAcJ,QAAQ;AAAA,MACxB;AAAA,IACF;AAAA,EAEF,GAAG,CAACrI,oBAAoB8E,QAAQ,CAAC,GAG/BjqB,2BAAAA,IAAC6tB,QAAAA,cAAA,EAAa,YAAY/D,uBAAuB;AAAA,IAACwC,UAAU;AAAA,EAAA,IAAK5rB,QAC/D,UAAAwM,2BAAAA,KAAC4gB,0BAAAA,2BAAA,EACE9D,UAAAA;AAAAA,IAAAA;AAAAA,IACDhqB,2BAAAA,IAACwN,GAAAA,QAAK,MAAM,GAAG,MAAK,eAClB,UAAAN,2BAAAA,KAACI,GAAAA,MAAA,EACC,OAAM,UACN,QAAO,QACP,SAAQ,UACR,UAAUyd,uBAAuBK,kBAAkB7F,cAAc,YAAY,IAAI,GACjF,QAAO,UACP,OAAO;AAAA,MACLxB,UAAU;AAAA,MACV/L,QAAQqS,eAAe,SAAS3pB;AAAAA,IAAAA,GAGlC,UAAA;AAAA,MAAAV,2BAAAA,IAACkkB,QAAAA,iBAAA,EACE,UAAA,CAACiG,oBACF,CAACxE,aACD,CAACE;AAAAA,MAED6E,gCACA,CAACH,iBACCvqB,2BAAAA,IAAC,YAAA,EACC,SAAQ,WACR,SAAQ,WACR,MAAK,QACL,UAAU+tB,iBACV,SAAQ,UACR,OAAM,UACN,OAAO;AAAA,QACLC,OAAO;AAAA,QACPjK,UAAU;AAAA,QACVkK,gBAAgBhE,WACZ,4CACA;AAAA,QACH,YAAyB;AAAA;AAAA,QAE1BiE,sBAAsBjE,WAClB,4CACA;AAAA,QACJkE,kBAAkB;AAAA,QAClBhP,QAAQ;AAAA,MAAA,GAGV,UAAAjS,2BAAAA,KAACI,GAAAA,MAAA,EACC,OAAO;AAAA,QAAC,GAAG8gB,MAAM7I,QAAQ;AAAA,MAAA,GACzB,SAAQ,UACR,OAAM,UACN,WAAU,UACV,KAAK,GAEJ0E,UAAAA;AAAAA,QAAAA,YACCjqB,2BAAAA,IAAC8M,kCAAA,EACC,UAAQ,IACR,MAAK,SACL,MAAMH,EAAE,oCAAoC,GAC5C,OAAO;AAAA,UAACwX,SAAS;AAAA,QAAA,GAAG;AAAA,QAGxBnkB,2BAAAA,IAACwN,GAAAA,QACC,QAAQ,GACR,MAAMyc,WAAW,YAAY,WAC7B,SAAS,GACT,QAAQ,GAER,UAAA/c,gCAACI,GAAAA,QAAK,SAAQ,UAAS,OAAM,UAAS,WAAU,UAAS,KAAK,GAC5D,UAAA;AAAA,UAAAtN,2BAAAA,IAAC6f,GAAAA,SAAA,EAAQ,OAAK,GAAA,CAAA;AAAA,UACd7f,2BAAAA,IAACiN,GAAAA,QAAK,OAAK,IAAC,MAAM,GACfgd,UAAAA,WACGtd,EAAE,wBAAwB;AAAA,YAAC/O,SAAS;AAAA,UAAA,CAAU,IAC9C+O,EAAE,wBAAwB;AAAA,YAAC/O,SAAS;AAAA,UAAA,CAAa,EAAA,CACvD;AAAA,QAAA,EAAA,CACF,EAAA,CACF;AAAA,QACCqsB,YACCjqB,2BAAAA;AAAAA,UAAC8M,0BAAAA;AAAAA,UAAA;AAAA,YAEC,MAAK;AAAA,YACL,SAAS2d;AAAAA,YACT,MAAM9d,EAAE,oCAAoC;AAAA,UAAA;AAAA,QAAA;AAAA,MAAE,EAAA,CAGpD,EAAA,CACF,KACGgZ,aAAcR,uBAAuB,gBAAgB,CAACU,iBACzD,CAAC0E,iBACDvqB,2BAAAA,IAAC,YAAA,EACC,SAAQ,WACR,SAAQ,WACR,MAAK,QACL,UAAU+tB,iBACV,SAAQ,UACR,OAAM,UACN,OAAO;AAAA,QACLC,OAAO;AAAA,QACPjK,UAAU;AAAA;AAAA,MAAA,GAIZ,UAAA7W,2BAAAA,KAACI,GAAAA,MAAA,EACC,OAAO;AAAA,QAAC,GAAG8gB,MAAM7I,QAAQ;AAAA,MAAA,GACzB,SAAQ,UACR,OAAM,UACN,WAAU,UACV,KAAK,GAEL,UAAA;AAAA,QAAAvlB,2BAAAA,IAAC6f,GAAAA,SAAA,EAAQ,OAAK,GAAA,CAAA;AAAA,uCACb5S,GAAAA,MAAA,EAAK,OAAK,IAAC,MAAM,GACfN,YAAE,wBAAwB;AAAA,UAAC/O,SAAS;AAAA,QAAA,CAAU,EAAA,CACjD;AAAA,MAAA,GACF,GACF,IACEusB,oBAAoB,CAACI,iBACvBvqB,2BAAAA,IAAC,cACC,SAAQ,WACR,SAAQ,WACR,MAAK,QACL,UAAUquB,eACV,SAAQ,UACR,OAAM,UACN,OAAO;AAAA,QACLC,YAAY;AAAA,QACZN,OAAO;AAAA,QACPjK,UAAU;AAAA,MAAA,GAGZ,UAAA/jB,2BAAAA,IAAC,WAAA,EACC,MAAM,GACN,SAAS2M,EAAE,qCAAqC,GAChD,SAASkH,aACT,kBAAkB4W,sBAEjBpX,qBACCnG,2BAAAA,KAAA6O,qBAAA,EACGoJ,UAAAA;AAAAA,QAAAA,uBAAuB,eACtBnlB,+BAACwN,GAAAA,MAAA,EAAK,SAAS,GAAG,QAAQ,GAAG,MAAK,YAChC,UAAAN,2BAAAA,KAACC,GAAAA,OAAA,EAAM,OAAO,GACZ,UAAA;AAAA,UAAAnN,2BAAAA,IAAC8T,GAAAA,SAAM,OAAK,IAAC,MAAM,GAChBnH,UAAAA,EAAE,+CAA+C,GACpD;AAAA,UACA3M,2BAAAA,IAACkT,GAAAA,MAAA,EAAK,MAAM,GACTvG,YAAE,kBAAkB;AAAA,YAAC/O,SAASunB;AAAAA,UAAAA,CAAmB,EAAA,CACpD;AAAA,QAAA,EAAA,CACF,EAAA,CACF;AAAA,QAGDmE,sBAAsB,eACrBtpB,+BAACwN,GAAAA,MAAA,EAAK,SAAS,GAAG,QAAQ,GAAG,MAAK,YAChC,UAAAN,2BAAAA,KAACC,GAAAA,OAAA,EAAM,OAAO,GACZ,UAAA;AAAA,UAAAnN,2BAAAA,IAAC8T,GAAAA,SAAM,OAAK,IAAC,MAAM,GAChBnH,UAAAA,EAAE,8CAA8C,GACnD;AAAA,UACA3M,2BAAAA,IAACkT,GAAAA,MAAA,EAAK,MAAM,GACTvG,YAAE,kBAAkB;AAAA,YAAC/O,SAAS0rB;AAAAA,UAAAA,CAAkB,EAAA,CACnD;AAAA,QAAA,EAAA,CACF,EAAA,CACF;AAAA,MAAA,EAAA,CAEJ,EAAA,CAEJ,GACF,IACE,KAAA,CACN;AAAA,MACAtpB,+BAAC,UACC,SAASmrB,kBACT,SAAS,CAAC,YAAY,GACtB,QAAQN,cACR,cAAcC,0BACd,KACA,KAAKtN,WAAW9I,SAAAA,GAChB,OAAO4W,aACP,UAAUE,eAAAA,CAAe;AAAA,IAAA,EAAA,CAE7B,EAAA,CACF;AAAA,EAAA,EAAA,CACF,EAAA,CACF;AAEJ,CAAC,CACH;AACAnC,QAAQkF,cAAc;AAEtB,MAAMH,QAAQ;AAAA,EACZI,SAAS;AAAA,IACP3pB,OAAO;AAAA,IACP+P,QAAQ;AAAA,EAAA;AAAA,EAEV6Z,QAAQ;AAAA,IACN5pB,OAAO;AAAA,IACP+P,QAAQ;AAAA,EAAA;AAEZ,GAEMmZ,kBAAkB;AAAA,EACtBnvB,SAAS;AAAA,IAACulB,SAAS;AAAA,EAAA;AAAA,EACnBlJ,SAAS;AAAA,IAACkJ,SAAS,CAAC,GAAG,GAAG,CAAC;AAAA,EAAA;AAAA,EAC3BuK,MAAM;AAAA,IAACvK,SAAS,CAAC,GAAG,GAAG,CAAC;AAAA,EAAA;AAC1B,GAEMkK,gBAAgB;AAAA,EACpBzvB,SAAS;AAAA,IAACulB,SAAS;AAAA,EAAA;AAAA,EACnBlJ,SAAS;AAAA,IAACkJ,SAAS,CAAC,GAAG,GAAG,CAAC;AAAA,EAAA;AAAA,EAC3BuK,MAAM;AAAA,IAACvK,SAAS,CAAC,GAAG,GAAG,CAAC;AAAA,EAAA;AAC1B,GAEMqH,iBAAiB;AAAA,EACrBgD,SAAS;AAAA,IACP,GAAGJ,MAAMI;AAAAA,IACTG,WAAW;AAAA,EAAA;AAAA,EAEbF,QAAQ;AAAA,IACN,GAAGL,MAAMK;AAAAA,IACTE,WAAW;AAAA,EAAA;AAAA,EAEbL,YAAY;AAAA,IACVnK,SAAS;AAAA,IACTyK,OAAO;AAAA,EAAA;AAAA,EAETnwB,MAAM;AAAA,IACJmwB,OAAO;AAAA,EAAA;AAAA,EAETjwB,WAAW;AAAA,IACTiwB,OAAO,CAAC,GAAG,GAAG,GAAG,IAAI;AAAA,EAAA;AAAA,EAEvBC,QAAQ;AAAA,IACN1K,SAAS,CAAC,GAAG,GAAG,CAAC;AAAA,IACjByK,OAAO;AAAA,EAAA;AAAA,EAET3E,UAAU;AAAA,IACR9F,SAAS,CAAC,GAAG,GAAG,CAAC;AAAA,EAAA;AAErB;AChnBO,SAAS2K,iBAAiB;AAC/B,MAAIC,SAAS;AAEb,SAAO,IAAIvtB,SAAsB;AAC1ButB,eACHpe,QAAQC,KAAK,GAAGpP,IAAI,GACpButB,SAAS;AAAA,EAEb;AACF;ACKA,MAAMC,qCAAqCF,eAAAA;AAMpC,SAAAG,mBAAAtS,aAAAuS,eAAA;AAAA,QAAAzyB,IAAAC,qBAAAA,EAAA,EAAA;AAOLyyB,SAAAA,uBAAuBxS,WAAW;AAAC,MAAA/f;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAE4BpC,SAAEH,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAjE,QAAA,CAAA2yB,WAAAC,YAAA,IAAkC5nB,MAAAA,SAA6B7K,EAAE;AAAC,MAAAC;AAAAJ,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KACKnC,SAAEJ,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAzE,QAAA,CAAA6yB,eAAAC,gBAAA,IAA0C9nB,MAAAA,SAA6B5K,EAAE,GAIzE2yB,SAAetwB,MAAAA,OAA2B,EAAE;AAAC,MAAAC;AAAA1C,WAAAyyB,iBAI3C/vB,KAAAA,CAAAI,KAAAkwB,eAAAnwB,QAAA;AACE,UAAAowB,aADkDpwB,QAAAoB,SAAA,CAAA,IAAApB,KACjBoI,OAAQ3K,OAWxC;AAID4yB,KAFiBhT,kBAAgB,cAAhB0S,eAAAE,kBAERK,CAAAA,UAAA;AAEP,YAAAxnB,OAA6C,CAAA;AAC7C,iBAAKmL,aAAkBmc;AACrBtnB,aAAKmL,UAAQ9C,GAAI,IAAI8C;AAIvB,UAAIic,OAAMnwB,YAAa6vB,cAAa7vB,QAAQxB;AAC1C2xB,eAAAA,OAAMnwB,UAAW6vB,cAAa7vB,QAAQxB,KAC/B;AAAA,UAAA,CAAE0B,GAAG,GAAG6I;AAAAA,QAAAA;AAIjB,YAAAF,OAAa0nB,MAAMrwB,GAAG;AACtB,aAAKswB,yBAAQ3nB,MAAME,IAAI,IAKhBwnB,QAJE;AAAA,QAAA,GAAIA;AAAAA,QAAK,CAAGrwB,GAAG,GAAG6I;AAAAA,MAAAA;AAAAA,IAIf,CACb;AAAA,EAAC,GACH3L,OAAAyyB,eAAAzyB,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAxCH,QAAAqzB,qBAA2B3wB,IA6CzB4wB,aAAmBpT,gBAAgB,cAAhByS,YAAAE;AAAuD,MAAAhwB;AAAA7C,WAAAszB,cAClDzwB,KAAA4O,OAAM7H,OAAQ0pB,UAAU,EAACnpB,OAAQ/D,UAKtD,CAAA,CAAE,GAACpG,OAAAszB,YAAAtzB,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA;AALN,QAAAuzB,kBAAwB1wB;AAKlB,MAAAK;AAAAlD,WAAAuzB,mBAECrwB,KAAAuO,OAAM7H,OAAQ2pB,eAAe,GAACvzB,OAAAuzB,iBAAAvzB,OAAAkD,MAAAA,KAAAlD,EAAA,CAAA;AATvC,QAAAkc,kBASEhZ;AACyC,MAAAG;AAAA,SAAArD,EAAA,CAAA,MAAAkc,mBAAAlc,SAAAqzB,sBAEpChwB,KAAA,CAAC6Y,iBAAiBmX,kBAAkB,GAACrzB,OAAAkc,iBAAAlc,OAAAqzB,oBAAArzB,QAAAqD,MAAAA,KAAArD,EAAA,EAAA,GAArCqD;AAAqC;AAxEvC,SAAA+C,SAAA2G,KAAAymB,SAAA;AA+DD/hB,SAAAA,OAAM7H,OAAQupB,OAAK,EAACM,QAAS5f,CAAAA,QAAA;AAC3B9G,QAAI8G,IAAGG,GAAI,IAAIH;AAAAA,EAAH,CACb,GACM9G;AAAG;AAlET,SAAAzM,QAAAozB,gBAAA;AAoBC,SAAI,gBAAgBA,kBAAkBA,eAAcC,cAGlDpB,mCACE,4EACAmB,cACF,GACO,MAEFA;AAAc;AC/B7B,SAASE,QAAcC,KAA0B1yB,SAAe;AAC9D,SAAO0yB,eAAeC,WAAWD,IAAI1yB,OAAO,IAAI0yB;AAClD;AAEA,SAASE,mBACPC,UACA7yB,SACoB;AACpB,MAAI6yB,SAASC,SAAS;AACpB,UAAMhpB,SAAS+oB,SAASC,QAAQ9yB,OAAO,GAAG8J;AAC1C,WAAOA,SACH;AAAA,IACJA,MAAM,qBACFhH;AAAAA,EACN;AAEA,SAAI,UAAU+vB,WACL;AAAA,cACGA,SAASvvB,IAAI,sBAGlB;AAAA,IACLmvB,QAAQI,SAAS/oB,QAAQ9J,OAAO,CAAC;AACrC;AAEA,SAAS+yB,oBACPF,UACA7yB,SACwB;AACxB,SAAI6yB,SAASC,UACJD,SAASC,QAAQ9yB,OAAO,GAAGgR,UAAUhR,QAAQgR,SAGlD,UAAU6hB,WACL,CAAA,IAGFJ,QAAQI,SAAS7hB,QAAQhR,OAAO,KAAKA,QAAQgR;AACtD;AAEO,SAASgiB,gBAAgBC,OAAahzB,KAA+C;AAC1F,QAAMizB,SAASztB,MAAMC,QAAQutB,KAAK,IAAIA,QAAQ,CAACA,KAAK;AAEpD,OAAKA,SAASC,QAAQ;AACpB,QAAI;AAAA,MAACrT,QAAAA;AAAAA,IAAAA,IAAU5f,KACXqS,OAAO2gB;AAGX,QAAI,OAAOA,SAAU;AACnB,UAAI;AACF,cAAME,WAAW,IAAIlU,IAAIgU,KAAK;AAG9B,YAAIE,SAAStT,WAAWA,QAAQ;AAEhCA,QAAAA,UAASsT,SAAStT,QAClBvN,OAAO6gB,SAAShU;AAAAA,MAClB,QAAQ;AAAA,MACN;AAIJ,QAAI;AAEF,YAAM8F,SADUmO,aAAAA,MAA8B9gB,MAAM;AAAA,QAAC+gB,QAAQC;AAAAA,MAAAA,CAAmB,EACzDrzB,IAAIkf,QAAQ;AACnC,UAAI8F,QAAQ;AAEV,cAAM;AAAA,UAACjU;AAAAA,UAAQsB,MAAAA;AAAAA,QAAAA,IAAQ2S;AACvB,eAAO;AAAA,UAACpF,QAAAA;AAAAA,UAAQ7O;AAAAA,UAAQsB,MAAAA;AAAAA,QAAAA;AAAAA,MAC1B;AAAA,IACF,SAASqH,GAAG;AACV,YAAM,IAAI1W,MAAM,IAAIgwB,KAAK,kCAAkC;AAAA,QAACM,OAAO5Z;AAAAA,MAAAA,CAAE;AAAA,IACvE;AAAA,EACF;AAEF;AAEO,SAAA6Z,gBAAA50B,OAAA;AAAA,QAAAC,IAAAC,uBAAA,EAAA,GAQL;AAAA,IAAAmc;AAAAA,IAAAwY;AAAAA,IAAAnhB;AAAAA,IAAA0M;AAAAA,IAAA0U,WAAA10B;AAAAA,IAAA+f;AAAAA,EAAAA,IAAuFngB;AAAK,MAAAK;AAAAJ,WAAAG,MAApCC,KAAAD,OAAA8D,SAAA,CAAA,IAAA9D,IAAcH,OAAAG,IAAAH,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAd,QAAA60B,YAAAz0B,IACxD;AAAA,IAAAuC,OAAAwQ;AAAAA,EAAAA,IAA6BE,iBAAAA;AAAW,MAAA3Q;AAAA1C,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KACfG,KAAA;AAAA,IAAAohB,YAAaC,aAAAA;AAAAA,EAAAA,GAAY/jB,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAAlD,QAAAgkB,UAAeC,OAAAA,UAAUvhB,EAAyB;AAAC,MAAAG;AAAA7C,IAAA,CAAA,MAAAyT,QAAAzT,SAAAmT,eAEjDtQ,KAAA4Q,QAAQN,YAAWxB,eAAoBmC,KAACxT,OAAiC,IAAC,CAAA,KAA1E,IAAgFN,OAAAyT,MAAAzT,OAAAmT,aAAAnT,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA;AADlF,QAAA80B,cACEjyB,IAEF,CAAA8T,mBAAAoe,oBAAA,IAAkD/pB,MAAAA,SAChD/G,MACF,GACA+wB,oBAA0BvyB,MAAAA,OAA2BwB,MAAS;AAAC,MAAAf;AAAAlD,IAAA,CAAA,MAAAoc,YAAApc,SAAA40B,qBAEzB1xB,KAAAA,CAAA2Q,KAAAzS,QAAA;AACpC,KAAI,CAACyS,OAAOmhB,kBAAiBpyB,YAAaiR,IAAGG,SAC3C+gB,qBAAqB;AAAA,MAAAje,UACTjD;AAAAA,MAAGJ,MACPrS,IAAGkf;AAAAA,IAAAA,CACV,GACD0U,kBAAiBpyB,UAAWiR,KAAGG,KAQ3B4gB,kBAAiBK,GAAI,EAAM,GAAC/zB,OAAK0zB,kBAAiBK,GAAI,EAAM,GAAC/zB,MAC/Dkb,WAAW;AAAA,MAAAzZ,OACF;AAAA,QAAAzB,IACD2S,KAAGG;AAAAA,QAAKvP,MACNoP,KAAGI;AAAAA,MAAAA;AAAAA,IACX,CACD;AAAA,EAEJ,GACFjU,OAAAoc,UAAApc,OAAA40B,mBAAA50B,OAAAkD,MAAAA,KAAAlD,EAAA,CAAA;AAvBD,QAAAk1B,iBAAuBzF,eAAAA,eAAevsB,EAuBrC;AAAC,MAAAG;AAAArD,WAAAgkB,WAAAhkB,EAAA,EAAA,MAAAk1B,kBAAAl1B,EAAA,EAAA,MAAAkgB,eAAAlgB,EAAA,EAAA,MAAA80B,eAAA90B,UAAA60B,aAAA70B,EAAA,EAAA,MAAAmgB,gBAEQ9c,KAAAA,MAAA;AACR,UAAA8xB,QAAY,IAAI/U,IAAI0U,aAAa3U,YAAY;AAE7C,QAAI0U,UAASlsB,QAAO;AACdyd,UAAAA;AAMJ,iBAAK4N,YAAkBa,WAAS;AAC9B,cAAA1zB,UAAgBgzB,gBAAgBH,SAAQI,OAAQhzB,KAAG;AACnD,YAAID,SAAO;AACTilB,mBAASA;AAAAA,YAAAA;AAAAA,YAAAA;AAAAA,UAAAA;AACT;AAAA,QAAK;AAAA,MACN;AAGH,UAAIA,QAAM;AACR,cAAAgP,QAAcrB,mBAAmB3N,OAAM4N,UAAW5N,OAAMjlB,OAAQ,GAChEgR,SAAe+hB,oBAAoB9N,OAAM4N,UAAW5N,OAAMjlB,OAAQ;AAClE,YAAIi0B,OAAK;AACP,gBAAAtP,aAAmB,IAAIC,gBAAAA,GACvBvR,UAAsC;AAAA,YAAA0L;AAAAA,YAAAiG,QAE5BL,WAAUK;AAAAA,YAAOM,KACpB;AAAA,UAAA;AAGPzC,iBAAAA,QAAMsC,MAC6B8O,OAAOjjB,QAAQqC,OAAO,EAAC6gB,KAClDC,CAAAA,UAASJ,eAAerhB,OAAKzS,KAAG,CAAC,EAACm0B,MACjCza,CAAAA,MAAA;AACDA,yBAAa1W,SAAS0W,EAAC0C,SAAU,iBACrCuX,qBAAqB;AAAA,cAAAje,UAAW7S;AAAAA,cAASwP,MAAQrS,MAAGkf;AAAAA,YAAAA,CAAU,GAC9D0U,kBAAiBpyB,UAAWqB;AAAAA,UAAH,CAC1B,GACI,MAAA;AACL6hB,uBAAUe,MAAAA;AAAAA,UAAQ;AAAA,QACnB;AAAA,MACF;AAAA,IACF;AAEHkO,yBAAqB9wB,MAAS,GAC9B+wB,kBAAiBpyB,UAAWqB;AAAAA,EAAH,GAE1BjE,OAAAgkB,SAAAhkB,QAAAk1B,gBAAAl1B,QAAAkgB,aAAAlgB,QAAA80B,aAAA90B,QAAA60B,WAAA70B,QAAAmgB,cAAAngB,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAAA,MAAAsD;AAAA,SAAAtD,EAAA,EAAA,MAAAgkB,WAAAhkB,EAAA,EAAA,MAAAkgB,eAAAlgB,EAAA,EAAA,MAAA80B,eAAA90B,EAAA,EAAA,MAAA60B,aAAA70B,UAAAmgB,gBAAE7c,KAAA,CAAC0gB,SAAQ9D,aAAa4U,aAAaD,WAAW1U,YAAY,GAACngB,QAAAgkB,SAAAhkB,QAAAkgB,aAAAlgB,QAAA80B,aAAA90B,QAAA60B,WAAA70B,QAAAmgB,cAAAngB,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA,GA9C9DO,MAAAA,UAAU8C,IA8CPC,EAA2D,GAEvDqT;AAAiB;AA5FnB,SAAArW,QAAAH,IAAA;AAYsC,QAAA,CAAA2C,GAAA,IAAA3C;AAAK,SAAK2C,QAAQ;AAAS;;;;;;;;;;;;;;;;;;;;;;;;;;ACvGjE,SAAS0yB,QAAQC,OAA+C;AACrE,MAAIA,UAAUxxB;AACZ;AAGF,QAAMyxB,WAAWjB,mBAAmBgB,KAAK,GAAGE,MAAM,GAAG;AAErD,SAAID,SAAS,CAAC,MAAM,YAClBA,SAASE,SAGJF,SAASzvB,KAAK,GAAG;AAC1B;AAEO,SAAS4vB,UAAUC,SAAiD;AACzE,MAAIA,YAAY7xB;AAIhB,WAAO+T,IAAAA,WAAWC,SAAS8d,gBAAgBtB,mBAAmBqB,OAAO,CAAC,CAAC;AACzE;AAEO,SAASE,iBAAiBrzB,OAAyD;AACxF,SAAO;AAAA,IACLzB,IAAIs0B,QAAQ7yB,MAAMzB,EAAE;AAAA,IACpBuS,MAAMoiB,UAAUlzB,MAAM8Q,IAAI;AAAA,IAC1BhP,MAAM9B,MAAM8B;AAAAA,EAAAA;AAEhB;ACjBA,SAASwxB,YAAoErjB,KAAW;AACtF,SAAOnB,OAAO6B,YACZ7B,OAAOC,QAAQkB,GAAG,EAAE3H,OAClB,CAAC,CAAA,EAAGlI,KAAK,MAAMA,UAAUkB,UAAalB,UAAU,MAAMA,UAAU,IAClE,CACF;AACF;AAKA,MAAMmzB,oBACJA,MACgBC,CAAAA,UACdA,OAEEC,2BAA2BF,kBAAAA,EAAoD,CACnF,eACA,WACA,UAAU,CACX,GAEKG,yBAAyBH,kBAAAA,EAAuD,CACpF,uBACA,WACA,WACA,eACA,kBACA,iBACA,QACA,WACA,OACA,SACA,YACA,kBACA,WACA,MAAM,CACP;AAEM,SAAAI,UAAAn2B,IAAA;AAAA,QAAAH,IAAAC,uBAAA,EAAA,GAAmB;AAAA,IAAAs2B;AAAAA,IAAAC;AAAAA,IAAArjB;AAAAA,IAAAI;AAAAA,EAAAA,IAAApT;AAczB,MAAAC;AAAAJ,WAAAmT,eAS4B/S,KAAA41B,iBAAiB7iB,WAAW,GAACnT,OAAAmT,aAAAnT,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAtD,QAAA;AAAA,IAAAkB;AAAAA,IAAAuS;AAAAA,IAAAhP;AAAAA,EAAAA,IAAyBrE;AAA6B,MAAAsC;AAAA1C,WAAAu2B,qBAAAv2B,EAAA,CAAA,MAAAuT,mBAAAqF,WAM3ClW,KAAA6Q,mBAAkBqF,WAAY2d,kBAAiBte,SAAAA,GAAWjY,OAAAu2B,mBAAAv2B,EAAA,CAAA,IAAAuT,mBAAAqF,SAAA5Y,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAiB9C,QAAA6C,KAAA0Q,mBAAkBkjB;AAA4C,MAAAvzB;AAAAlD,WAAAkB,MAAAlB,EAAA,CAAA,MAAAyT,QAAAzT,EAAA,CAAA,MAAAuT,mBAAAmjB,WAAA12B,EAAA,CAAA,MAAAuT,mBAAAojB,WAAA32B,EAAA,CAAA,MAAAuT,mBAAAqjB,eAAA52B,EAAA,EAAA,MAAAuT,mBAAAvB,iBAAAhS,EAAA,EAAA,MAAAuT,mBAAAsjB,WAAA72B,EAAA,EAAA,MAAAuT,mBAAA2M,eAAAlgB,EAAA,EAAA,MAAAuT,mBAAAujB,OAAA92B,UAAAuT,mBAAAwjB,kBAAA/2B,UAAAuT,mBAAAyjB,SAAAh3B,UAAAuT,mBAAAtB,YAAAjS,EAAA,EAAA,MAAAuT,mBAAAqE,kBAAA5X,EAAA,EAAA,MAAAuT,mBAAA0jB,QAAAj3B,EAAA,EAAA,MAAAuT,mBAAAuV,YAAA9oB,EAAA,EAAA,MAAA0C,MAAA1C,UAAA6C,MAAA7C,EAAA,EAAA,MAAAyE,QArB9EvB,KAAA;AAAA,IAAAhC;AAAAA,IAAAuD;AAAAA,IAAAgP;AAAAA,IAAAmF,SAIIlW;AAAAA,IAA0Dwd,aACtD3M,mBAAkB2M;AAAAA,IAAY4I,UACjCvV,mBAAkBuV;AAAAA,IAAS6N,SAC5BpjB,mBAAkBojB;AAAAA,IAAQI,gBACnBxjB,mBAAkBwjB;AAAAA,IAAe/kB,eAElCuB,mBAAkBvB;AAAAA,IAAc8kB,KAC1CvjB,mBAAkBujB;AAAAA,IAAIE,OACpBzjB,mBAAkByjB;AAAAA,IAAM/kB,UACrBsB,mBAAkBtB;AAAAA,IAAS2F,gBACrBrE,mBAAkBqE;AAAAA,IAAeqf,MAC3C1jB,mBAAkB0jB;AAAAA,IAAKJ,SAEpBtjB,mBAAkBsjB;AAAAA,IAAQD,aACtBrjB,mBAAkBqjB;AAAAA,IAAYF,SAElCnjB,mBAAkBmjB;AAAAA,IAAQD,qBACd5zB;AAAAA,EAAAA,GACtB7C,OAAAkB,IAAAlB,OAAAyT,MAAAzT,EAAA,CAAA,IAAAuT,mBAAAmjB,SAAA12B,EAAA,CAAA,IAAAuT,mBAAAojB,SAAA32B,EAAA,CAAA,IAAAuT,mBAAAqjB,aAAA52B,EAAA,EAAA,IAAAuT,mBAAAvB,eAAAhS,EAAA,EAAA,IAAAuT,mBAAAsjB,SAAA72B,EAAA,EAAA,IAAAuT,mBAAA2M,aAAAlgB,EAAA,EAAA,IAAAuT,mBAAAujB,KAAA92B,EAAA,EAAA,IAAAuT,mBAAAwjB,gBAAA/2B,EAAA,EAAA,IAAAuT,mBAAAyjB,OAAAh3B,EAAA,EAAA,IAAAuT,mBAAAtB,UAAAjS,EAAA,EAAA,IAAAuT,mBAAAqE,gBAAA5X,EAAA,EAAA,IAAAuT,mBAAA0jB,MAAAj3B,EAAA,EAAA,IAAAuT,mBAAAuV,UAAA9oB,QAAA0C,IAAA1C,QAAA6C,IAAA7C,QAAAyE,MAAAzE,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAzBH,QAAAmS,SAGEjP;AAuBsD,MAAAG;AAAArD,IAAA,EAAA,MAAAmS,OAAAskB,uBAAAz2B,EAAA,EAAA,MAAAmS,OAAAukB,WAAA12B,EAAA,EAAA,MAAAmS,OAAAwkB,WAAA32B,EAAA,EAAA,MAAAmS,OAAAykB,eAAA52B,UAAAmS,OAAAH,iBAAAhS,EAAA,EAAA,MAAAmS,OAAAsB,QAAAzT,EAAA,EAAA,MAAAmS,OAAA0kB,WAAA72B,EAAA,EAAA,MAAAmS,OAAA2kB,OAAA92B,EAAA,EAAA,MAAAmS,OAAA4kB,kBAAA/2B,UAAAmS,OAAA6kB,SAAAh3B,EAAA,EAAA,MAAAmS,OAAAF,YAAAjS,EAAA,EAAA,MAAAmS,OAAAyF,kBAAA5X,EAAA,EAAA,MAAAmS,OAAA8kB,QAGvC5zB,KAAA4yB,YAAY;AAAA,IAAAU,SAChBxkB,OAAMwkB;AAAAA,IAAQI,gBACP5kB,OAAM4kB;AAAAA,IAAetjB,MAC/BtB,OAAMsB;AAAAA,IAAKzB,eACFG,OAAMH;AAAAA,IAAc8kB,KAC9B3kB,OAAM2kB;AAAAA,IAAIE,OACR7kB,OAAM6kB;AAAAA,IAAM/kB,UACTE,OAAMF;AAAAA,IAAS2F,gBACTzF,OAAMyF;AAAAA,IAAeqf,MAC/B9kB,OAAM8kB;AAAAA,IAAKJ,SAER1kB,OAAM0kB;AAAAA,IAAQD,aACVzkB,OAAMykB;AAAAA,IAAYF,SAEtBvkB,OAAMukB;AAAAA,IAAQD,qBACFtkB,OAAMskB;AAAAA,EAAAA,CAC5B,GAACz2B,EAAA,EAAA,IAAAmS,OAAAskB,qBAAAz2B,EAAA,EAAA,IAAAmS,OAAAukB,SAAA12B,EAAA,EAAA,IAAAmS,OAAAwkB,SAAA32B,EAAA,EAAA,IAAAmS,OAAAykB,aAAA52B,EAAA,EAAA,IAAAmS,OAAAH,eAAAhS,EAAA,EAAA,IAAAmS,OAAAsB,MAAAzT,EAAA,EAAA,IAAAmS,OAAA0kB,SAAA72B,EAAA,EAAA,IAAAmS,OAAA2kB,KAAA92B,EAAA,EAAA,IAAAmS,OAAA4kB,gBAAA/2B,EAAA,EAAA,IAAAmS,OAAA6kB,OAAAh3B,EAAA,EAAA,IAAAmS,OAAAF,UAAAjS,EAAA,EAAA,IAAAmS,OAAAyF,gBAAA5X,EAAA,EAAA,IAAAmS,OAAA8kB,MAAAj3B,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAjBJ,QAAAiT,kBACiB5P;AAgCf,MAAAC;AAAAtD,IAAA,EAAA,MAAAmS,OAAA+N,eAAAlgB,EAAA,EAAA,MAAAmS,OAAAyG,WAAA5Y,EAAA,EAAA,MAAAmS,OAAA2W,YAGexlB,KAAA2yB,YAAY;AAAA,IAAA/V,aACZ/N,OAAM+N;AAAAA,IAAYtH,SACtBzG,OAAMyG;AAAAA,IAAQkQ,UACb3W,OAAM2W;AAAAA,EAAAA,CACjB,GAAC9oB,EAAA,EAAA,IAAAmS,OAAA+N,aAAAlgB,EAAA,EAAA,IAAAmS,OAAAyG,SAAA5Y,EAAA,EAAA,IAAAmS,OAAA2W,UAAA9oB,QAAAsD,MAAAA,KAAAtD,EAAA,EAAA;AALJ,QAAAuR,eACiBjO,IAQjB4zB,iBAAuBz0B,MAAAA,OAAO0Q,WAAW;AAAC,MAAAvH,IAAAK;AAAAjM,YAAAmT,eAE1BvH,KAAAA,MAAA;AACdsrB,mBAAct0B,UAAWuQ;AAAAA,EAAH,GACrBlH,KAAA,CAACkH,WAAW,GAACnT,QAAAmT,aAAAnT,QAAA4L,IAAA5L,QAAAiM,OAAAL,KAAA5L,EAAA,EAAA,GAAAiM,KAAAjM,EAAA,EAAA,IAFhB0E,sBAAgBkH,IAEbK,EAAa;AAAC,MAAAQ;AAAAzM,YAAAmT,eAEyD1G,KAAA,CAAC0G,WAAW,GAACnT,QAAAmT,aAAAnT,QAAAyM,MAAAA,KAAAzM,EAAA,EAAA;AAAvF,QAAA,CAAA40B,mBAAAuC,oBAAA,IAAkDnsB,MAAAA,SAAwByB,EAAa;AAAC,MAAAc;AAAAvN,IAAA,EAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAIrDgL,MAAAE,CAAAA,SAAA;AAAC,UAAA;AAAA,MAAAvM,IAAAsK;AAAAA,MAAA/G,MAAA2yB;AAAAA,IAAAA,IAAA3pB,MAClC;AAAA,MAAA7K;AAAAA,IAAAA,IAAkBs0B;AAAc,WACzBh2B,SAAO0B,QAAO1B,MAAOuD,WAAS7B,QAAO6B;AAAAA,EAAK,GAClDzE,QAAAuN,OAAAA,MAAAvN,EAAA,EAAA;AAHD,QAAAq3B,iBAAuB9pB;AAGjB,MAAAE;AAAAzN,YAAAw2B,kBAGJ/oB,MAAA+G,CAAAA,YAAA;AACE,UAAA;AAAA,MAAA7R;AAAAA,MAAAwP,QAAAmlB;AAAAA,MAAAjZ,SAAAhQ;AAAAA,IAAAA,IAAyCmG,SAAnB6J,UAAAhQ,SAAApK,SAAA,KAAAoK;AAGlB1L,WAAKzB,OAAMyB,MAAKzB,KAAMgR,OAAAA,eAAevP,MAAKzB,EAAG;AAGjD,UAAA;AAAA,MAAA0B,SAAA20B;AAAAA,IAAAA,IAAkBL,gBAClBM,eAAqB;AAAA,MAAAt2B,IACf0B,UAAO1B;AAAAA,MAAGuD,MACR7B,UAAO6B;AAAAA,MAAKgP,MACZ7Q,UAAO6Q;AAAAA,IAAAA,GAEfgkB,gBAAsBhmB,OAAM6B,YAAa1Q,UAAO+O,iBAAP,CAAA,CAA2B,GAIpE+lB,YAAkB/0B,SAAA60B,cAgBlBhlB,aAAmB;AAAA,MAAA,GAbS,CAAA,GACvB4jB,0BAAwB,GACvBiB,eAAeK,SAAuC,IAAtDrB,yBAAA,CAAA,CAAuD,EAGjBlsB,OAAQ,CAAA4C,KAAAjK,SAGlDiK,IAAIjK,GAAG,IAAI20B,cAAc30B,GAAG,GACrBiK,MACN,EAAmC;AAAA,MAGC,GAAKoF;AAAAA,IAAAA,GAE5CwlB,kBAAwB;AAAA,MAAA,GACnBD;AAAAA,MAAS/lB,eACGF,OAAMC,QAASc,UAAU,EAACrI,OACvC7J,SACA,CAAA,CACF;AAAA,IAAA;AAGF62B,yBAAqB1rB,CAAAA,SAAU,CAAA,GAAIA,MAAMksB,eAAe,CAAC,GACzDnB,eAAemB,iBAAiB;AAAA,MAAAtZ;AAAAA,IAAAA,CAAS;AAAA,EAAC,GAC3Cre,QAAAw2B,gBAAAx2B,QAAAyN,OAAAA,MAAAzN,EAAA,EAAA;AA9CH,QAAAoc,WAAiB3O;AAgDhB,MAAAY;AAAA,SAAArO,EAAA,EAAA,MAAAoc,YAAApc,EAAA,EAAA,MAAA40B,qBAAA50B,EAAA,EAAA,MAAAmS,UAAAnS,EAAA,EAAA,MAAAuR,gBAAAvR,UAAAiT,mBAEM5E,MAAA;AAAA,IAAAgpB;AAAAA,IAAAjb;AAAAA,IAAAwY;AAAAA,IAAAziB;AAAAA,IAAAZ;AAAAA,IAAA0B;AAAAA,EAAAA,GAONjT,QAAAoc,UAAApc,QAAA40B,mBAAA50B,QAAAmS,QAAAnS,QAAAuR,cAAAvR,QAAAiT,iBAAAjT,QAAAqO,OAAAA,MAAArO,EAAA,EAAA,GAPMqO;AAON;AAtKI,SAAA/N,QAAA4M,OAAA/M,IAAA;AAoJS,QAAA,CAAAgD,OAAAJ,KAAA,IAAA5C;AAAY,SAAK,CAAA,GAAI4M,OAAK,CAACjK,OAAKC,KAAK,CAAC;AAAgB;ACvL/D,MAAM60B,YAAY9R,CAAAA,eAAA;AAAA,QAAA9lB,IAAAC,qBAAAA,EAAA,EAAA,GAOvB,CAAA43B,QAAAC,SAAA,IAA4B9sB,MAAAA,SAAsB1K,OAAe;AAAC,MAAAH;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAGzCpC,KAAAiB,CAAAA,QAAA;AACvB,UAAA22B,SAAe7rB,OAAM8rB,KAAM52B,KAAK,QAAQ;AACpC22B,cACFD,UAAUrsB,CAAAA,SAAU,IAAI8jB,IAAI9jB,IAAI,EAACmkB,IAAKmI,MAAM,CAAC;AAAA,EAC9C,GACF/3B,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AALD,QAAAg4B,OAAa73B;AAKP,MAAAC,IAAAsC;AAAA1C,IAAA,CAAA,MAAA8lB,cAAA9lB,SAAA63B,UAGIz3B,KAAAA,MAAA;AACR,UAAA63B,SAAkC,CAAA;AAClC,QAAIJ,OAAMK,QAANpS;AAEF,iBAAKqS,YAAgBN;AACfM,oBAAU,YAAYJ,YAAtB,CAAiCA,SAAMK,UACzCH,OAAMtU,KAAMmC,WAAUuK,UAAW0H,QAAM,CAAC;AAG7C,WACM,MAAA;AACLE,aAAMxE,QAASrtB,QAAkB;AAAA,IAAC;AAAA,EACnC,GACA1D,KAAA,CAACojB,YAAY+R,MAAM,GAAC73B,OAAA8lB,YAAA9lB,OAAA63B,QAAA73B,OAAAI,IAAAJ,OAAA0C,OAAAtC,KAAAJ,EAAA,CAAA,GAAA0C,KAAA1C,EAAA,CAAA,IAbvBO,MAAAA,UAAUH,IAaPsC,EAAoB;AAAC,MAAAG,IAAAK;AAAAlD,WAAA63B,UAGdh1B,KAAAA,MAAA;AACR,QAAIg1B,OAAMK,MAAK;AACb,YAAAnH,WAAiBC,YAAY,MAAA;AAC3B,cAAAoH,6BAAmB7I,IAAAA;AACnB,mBAAK8I,YAAgBR;AACfQ,sBAAU,YAAYN,YAAUA,SAAMK,UACxCA,OAAMxI,IAAKmI,QAAM;AAGjBK,eAAMF,QACRJ,UAAUhsB,CAAAA,WAAA;AACR,gBAAAH,OAAa,IAAI4jB,IAAI9jB,MAAI;AACzB,qBAAK6sB,YAAgBF;AACnBzsB,iBAAIK,OAAQ+rB,QAAM;AACnB,iBACMpsB;AAAAA,QAAI,CACZ;AAAA,MACF,GACA4sB,aAAAA,oBAAoB;AAAC,aAEjB,MAAA;AACLpH,sBAAcJ,QAAQ;AAAA,MAAC;AAAA,IACxB;AAAA,EACF,GAEA7tB,KAAA,CAAC20B,MAAM,GAAC73B,OAAA63B,QAAA73B,OAAA6C,IAAA7C,OAAAkD,OAAAL,KAAA7C,EAAA,CAAA,GAAAkD,KAAAlD,EAAA,CAAA,IAzBXO,gBAAUsC,IAyBPK,EAAQ;AAAC,MAAAG;AAAA,SAAArD,SAAA63B,UAELx0B,KAAA;AAAA,IAAAw0B;AAAAA,IAAAG;AAAAA,EAAAA,GAAch4B,OAAA63B,QAAA73B,OAAAqD,MAAAA,KAAArD,EAAA,CAAA,GAAdqD;AAAc;AA7DE,SAAA/C,UAAA;AAAA,6BAOqCivB,IAAAA;AAAK;AAP1C,SAAAnpB,SAAAoyB,OAAA;AAAA,SA6BOA,MAAAA;AAAO;AC1ChC,SAAAC,2BAAAt4B,IAAA;AAAA,QAAAH,IAAAC,uBAAA,CAAA,GAAoC;AAAA,IAAA82B;AAAAA,EAAAA,IAAA52B,IAKzC;AAAA,IAAAu4B,yBAAAt4B;AAAAA,IAAAu4B;AAAAA,IAAA7f;AAAAA,EAAAA,IAAkFC,OAAAA,eAAAA,GAA3E2f,0BAAAt4B,OAAA6D,SAAA,WAAA7D;AAAkC,MAAAsC;AAAA,SAAA1C,EAAA,CAAA,MAAA8Y,oBAAA9Y,EAAA,CAAA,MAAA+2B,kBAAA/2B,EAAA,CAAA,MAAA04B,2BAAA14B,SAAA24B,qBAGvCj2B,KAAAi2B,qBAAA5B,iBAAA,CACKA,gBAAc,GAAKje,gBAAgB,IADxC4f,yBAE2B14B,OAAA8Y,kBAAA9Y,OAAA+2B,gBAAA/2B,OAAA04B,yBAAA14B,OAAA24B,mBAAA34B,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA,GAF3B0C;AAIgB;ACCb,SAAAk2B,YAAA;AAAA,QAAA54B,IAAAC,qBAAAA,EAAA,CAAA;AAAA,MAAAE;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAGHpC,KAAA,oBAAI2K,IAAAA,GAAgE9K,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AADtE,QAAA,CAAA64B,WAAAC,YAAA,IAAkC9tB,MAAAA,SAChC7K,EACF;AAAC,MAAAC;AAAAsZ,OAAA;AAIC,UAAA9P,SAAehD,MAAK+C,KAAMkvB,UAASjvB,QAAS;AAE5C,QAAIA,OAAMkK,KAAMxT,OAAoC,GAAC;AACnDF,WAAO;AAAP,YAAAsZ;AAAAA,IAAkB;AAGpB,UAAAqf,cAAoBnvB,OAAMqB,OAAQ7E,QAAqC;AACvE,QAAI2yB,YAAWpwB,QAAO;AACpBvI,WAAO24B,YAAWjyB,KAAMR,QAAiE,IAAlF,eAAA;AAAP,YAAAoT;AAAAA,IAA0F;AAG5FtZ,SAAO;AAAA,EAAM;AAZf,QAAA44B,aAAmB54B;AAaJ,MAAAsC;AAAA1C,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAGwBG,KAAAZ,CAAAA,UAAA;AACrCg3B,iBAAartB,CAAAA,SAAA;AACX,YAAAE,OAAa,IAAIb,IAAIW,IAAI;AACzB,UAAI3J,MAAKijB,WAAY;AAEnBpZ,aAAIK,OAAQlK,MAAKm3B,UAAW;AAAA,WAAC;AAG7B,cAAAC,iBACEvtB,KAAIxF,IAAKrE,MAAKm3B,UAAyB,GAACE,gBAAIr3B,MAAKijB,WAAY,aAC/DqU,WAAet3B,MAAKijB,WAAY,gBAAjB,eAAgDjjB,MAAKijB;AACpEpZ,aAAItF,IAAKvE,MAAKm3B,YAAa;AAAA,UAAAlU,QAACA;AAAAA,UAAMoU,cAAEA;AAAAA,QAAAA,CAAa;AAAA,MAAC;AACnD,aACMxtB;AAAAA,IAAI,CACZ;AAAA,EAAC,GACH3L,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAfD,QAAAq5B,qBAA2B32B;AAerB,MAAAG;AAAA,SAAA7C,SAAAg5B,cAGCn2B,KAAA,CAACm2B,YAAYK,kBAAkB,GAACr5B,OAAAg5B,YAAAh5B,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA,GAAhC6C;AAAgC;AAzClC,SAAAyD,SAAAnG,IAAA;AAgBwB,QAAA;AAAA,IAAAg5B;AAAAA,EAAAA,IAAAh5B;AAAc,SAAK,CAACg5B;AAAY;AAhBxD,SAAA/yB,SAAAjG,IAAA;AAcgC,QAAA;AAAA,IAAA4kB,QAAAuU;AAAAA,EAAAA,IAAAn5B;AAAQ,SAAK4kB,aAAW;AAAY;AAdpE,SAAAzkB,QAAAH,IAAA;AAUc,QAAA;AAAA,IAAA4kB;AAAAA,EAAAA,IAAA5kB;AAAQ,SAAK4kB,WAAW;AAAW;ACoCxD,MAAMwU,cAAc1W,MAAAA,KAAK,MAAM,QAAA,QAAA,EAAA,KAAA,WAAA;AAAA,SAAA,QAAO,kBAAsB;AAAA,CAAA,CAAC,GACvD2W,uBAAuB3W,MAAAA,KAAK,MAAM,QAAA,QAAA,EAAA,KAAA,WAAA;AAAA,SAAA,QAAO,2BAAiC;AAAA,CAAA,CAAC,GAC3E4W,8BAA8B5W,MAAAA,KAAK,MAAM,QAAA,QAAA,EAAA,KAAA,WAAA;AAAA,SAAA,QAAO,kCAAsC;AAAA,CAAA,CAAC,GACvF6W,yBAAyB7W,MAAAA,KAAK,MAAM,QAAA,QAAA,EAAA,KAAA,WAAA;AAAA,SAAA,QAAO,6BAA0B;AAAA,CAAA,CAAC,GACtE8W,8BAA8B9W,MAAAA,KAAK,MAAM,QAAA,QAAA,EAAA,KAAA,WAAA;AAAA,SAAA,QAAO,kCAAsC;AAAA,CAAA,CAAC,GACvF+W,oBAAoB/W,MAAAA,KAAK,MAAM,QAAA,QAAA,EAAA,KAAA,WAAA;AAAA,SAAA,QAAO,wBAAqC;AAAA,CAAA,CAAC,GAC5EgX,uBAAuBhX,MAAAA,KAAK,MAAM,QAAA,QAAA,EAAA,KAAA,WAAA;AAAA,SAAA,QAAO,2BAAwB;AAAA,CAAA,CAAC,GAElE/R,YAAYpN,iBAAAA,OAAOmN,OAAI;AAAA;AAAA;AAI7B,SAAeipB,iBAAA/5B,OAAA;AAAA,QAAAC,IAAAC,uBAAA,GAAA,GAQb;AAAA,IAAAujB;AAAAA,IAAAC;AAAAA,IAAAsW;AAAAA,IAAAjN;AAAAA,IAAAyJ;AAAAA,IAAA5Y;AAAAA,EAAAA,IAOI5d,OAEJge,eAAqBL,iBAAiBC,aAAa,GACnDwC,eAAqBW,gBAAgBnD,aAAa,GAElDqc,aAAmBD,KAAIvlB,SAAoBwlB,YAC3Cxc,OAAauc,KAAIvc,QAAJyc,aAAAA;AAA8B,MAAA95B;AAAAH,WAAAg6B,cACG75B,KAAA65B,cAAA,CAAA,GAAgBh6B,OAAAg6B,YAAAh6B,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAA9D,QAAA;AAAA,IAAA0c;AAAAA,IAAAwd;AAAAA,EAAAA,IAA8C/5B,IAE9C;AAAA,IAAAic,UAAAoa;AAAAA,IAAA7zB,OAAAwQ;AAAAA,EAAAA,IAAuDE,iBAAAA;AAEtD,MAAAjT;AAAAJ,IAAA,CAAA,MAAAmT,YAAAxB,iBACoCvR,KAAAqR,OAAM6B,YAAaH,YAAWxB,iBAAX,CAAA,CAA+B,GAAC3R,EAAA,CAAA,IAAAmT,YAAAxB,eAAA3R,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAAxF,QAAAuT,qBAA2BC,OAAAA,UAAUpT,EAAmD,GAExFkoB,wBAA8BzK,MAAAA,YAC5BF,eACArd,OACF;AAAC,MAAAoC;AAAA1C,IAAA,CAAA,MAAA+5B,KAAAvlB,SAAAoC,WAE0BlU,KAAAA,MAAA;AACzB,UAAAy3B,SAAeJ,KAAIvlB,SAAiBoC;AAEpC,WAAI,OAAOujB,UAAW,aAAmBA,OAAAA,IACrC,OAAOA,UAAW,YAAkBA,SAEjC,OAAOjuB,SAAW,OAAeA,OAAMiZ,SAASiV,aAAc;AAAA,EAAW,GACjFp6B,EAAA,CAAA,IAAA+5B,KAAAvlB,SAAAoC,SAAA5W,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAPD,QAAA,CAAA4W,OAAA,IAAkB5L,MAAAA,SAAStI,EAO1B,GAED6lB,YAAkB9lB,MAAAA,OAA0B,IAAI,GAEhD,CAAAqjB,YAAAuU,aAAA,IAAoCrvB,MAAAA,YACpC,CAAAsvB,sBAAAC,uBAAA,IAAwDvvB,MAAAA,SACtD,IACF;AAAC,MAAAnI;AAAA7C,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAEwCM,KAAA;AAAA,IAAAoU,OAChChT;AAAAA,IAAS7C,KACX6C;AAAAA,EAAAA,GACNjE,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA;AAHD,QAAAyyB,gBAAsBhwB,MAAAA,OAAmBI,EAGxC;AAAC,MAAAK;AAAAlD,IAAA,CAAA,MAAAu2B,qBAAAv2B,EAAA,CAAA,MAAAw2B,kBAAAx2B,EAAA,CAAA,MAAAuT,sBAAAvT,UAAAmT,eAGUjQ,KAAA;AAAA,IAAAqzB;AAAAA,IAAAC;AAAAA,IAAArjB;AAAAA,IAAAI;AAAAA,IAAAkf;AAAAA,EAAAA,GAMTzyB,OAAAu2B,mBAAAv2B,OAAAw2B,gBAAAx2B,OAAAuT,oBAAAvT,QAAAmT,aAAAnT,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAPH,QAAA;AAAA,IAAAq3B;AAAAA,IAAAjb;AAAAA,IAAAwY;AAAAA,IAAAziB;AAAAA,IAAAZ;AAAAA,IAAA0B;AAAAA,EAAAA,IACEqjB,UAAUpzB,EAMT;AAAC,MAAAG;AAAArD,IAAA,EAAA,MAAAmS,OAAA4kB,kBAC2C1zB,KAAA;AAAA,IAAA0zB,gBAAiB5kB,OAAM4kB;AAAAA,EAAAA,GAAgB/2B,EAAA,EAAA,IAAAmS,OAAA4kB,gBAAA/2B,QAAAqD,MAAAA,KAAArD,EAAA,EAAA;AAAtF,QAAAkgB,cAAoBuY,2BAA2Bp1B,EAAuC,GAEtFslB,kBAAwB6R,MAAAA,YAAY75B,mBAAmB,GAEvDmoB,WAAgC3W,OAAM2W,WAAN,WAAA,WAEhC,CAAA5M,iBAAAmX,kBAAA,IAA8Cb,mBAAmBtS,aAAauS,aAAa,GAE3FgI,YAAkBC,OAAAA,aAAAA,GAClBC,UAAgBC,OAAAA,WAAAA,GAOHt3B,KAAAy2B,KAAIvlB,SAAiByf,SAAe4G;AAAA,MAAAjvB;AAAA5L,IAAA,EAAA,MAAAoc,YAAApc,UAAA40B,qBAAA50B,EAAA,EAAA,MAAAmS,OAAAyG,WAAA5Y,EAAA,EAAA,MAAAkgB,eAAAlgB,UAAAsD,MAAAtD,EAAA,EAAA,MAAAmgB,gBALPvU,KAAA;AAAA,IAAAwQ;AAAAA,IAAAwY;AAAAA,IAAAnhB,MAGlCtB,OAAMyG;AAAAA,IAAQuH;AAAAA,IAAA0U,WAETvxB;AAAAA,IAAoC4c;AAAAA,EAAAA,GAEhDlgB,QAAAoc,UAAApc,QAAA40B,mBAAA50B,EAAA,EAAA,IAAAmS,OAAAyG,SAAA5Y,QAAAkgB,aAAAlgB,QAAAsD,IAAAtD,QAAAmgB,cAAAngB,QAAA4L,MAAAA,KAAA5L,EAAA,EAAA;AAPD,QAAA2W,oBAA0Bge,gBAAgB/oB,EAOzC,GAED,CAAA8c,oBAAAoS,qBAAA,IAAoDlC,UAAAA,GACpD,CAAA/L,mBAAAkO,oBAAA,IAAkDnC,UAAAA,GAClD,CAAAoC,sBAAAC,uBAAA,IAAwDrC,aAExD;AAAA,IAAAZ,MAAArX;AAAAA,EAAAA,IAAgCiX,UAAU9R,UAAU,GAEpDoD,YAAkBrL,MAAAA,YAAY8K,iBAAiBviB,QAAmC;AAAC,MAAA6F,IAAAQ;AAAAzM,IAAA,EAAA,MAAAkpB,aAAAlpB,UAAAmgB,gBAEzElU,KAAAA,MAAA;AACR,UAAAzK,SAAe+mB,UAAS3lB,SAAuButB;AAE/C,QAAI,CAAC3uB,UAAD0nB;AAAoB;AAExB,UAAAgS,eAAmB9K,QAAAA,iBAAiB;AAAA,MAAAjQ;AAAAA,IAAAA,CAAc;AAClD2F,WAAAA,aAAUuK,UAAW7uB,MAAM,GAC3B64B,cAAcvU,YAAU,GAEjB,MAAA;AACLA,mBAAUgL,QAAAA,GACVuJ,cAAcp2B,MAAS;AAAA,IAAC;AAAA,EACzB,GACAwI,KAAA,CAAC0T,cAAc+I,SAAS,GAAClpB,QAAAkpB,WAAAlpB,QAAAmgB,cAAAngB,QAAAiM,IAAAjM,QAAAyM,OAAAR,KAAAjM,EAAA,EAAA,GAAAyM,KAAAzM,EAAA,EAAA,IAb5BO,MAAAA,UAAU0L,IAaPQ,EAAyB;AAAC,MAAAc;AAAAvN,YAAAoc,YAE+B7O,MAAAiH,CAAAA,YAAA;AAC1D4H,aAAS5H,OAAO;AAAA,EAAC,GAClBxU,QAAAoc,UAAApc,QAAAuN,OAAAA,MAAAvN,EAAA,EAAA;AAFD,QAAAm7B,iBAAuB1L,eAAAA,eAAqCliB,GAE3D,GAED6tB,aAAmB34B,MAAAA,OAAewB,MAAS;AAAC,MAAAwJ;AAAAzN,YAAA8lB,cAAA9lB,EAAA,EAAA,MAAAm7B,kBAAAn7B,EAAA,EAAA,MAAA2oB,mBAAA3oB,EAAA,EAAA,MAAAqzB,sBAAArzB,UAAA86B,yBAAA96B,EAAA,EAAA,MAAAmgB,gBAElC1S,MAAAA,MAAA;AACR,QAAI,CAACqY;AAAU;AAEf,UAAA5lB,YAAgB4lB,WAAUwK,cACxB;AAAA,MAAA9S,MACQ;AAAA,MAAc+S,WACT;AAAA,MAAIC,WACJ;AAAA,IAAA,GAEbC,QAAAA,wBAAAA,EAA2EC,QAAS;AAAA,MAAA3vB,QAC1E4vB,oBAAAA,0BAAAA;AAAAA,IAAsD,CAC/D,CACH;AAEAzwB,cAAOG,GAAI,wBAAwBqF,CAAAA,SAAA;AAC3B,cAAQA,QACdy1B,eAAe;AAAA,QAAAx4B,OACN;AAAA,UAAA8B,MACCiB,KAAIjB;AAAAA,UAAKvD,IACXwE,KAAIxE;AAAAA,UAAGuS,MACL/N,KAAI+N;AAAAA,QAAAA;AAAAA,MACZ,CACD;AAAA,IAAC,CACH,GAEDvT,UAAOG,GAAI,2BAA2Bg7B,CAAAA,WAAA;AACpC,YAAA;AAAA,QAAApkB;AAAAA,MAAAA,IAAgBvR;AAChB,UAAAtE,MAAUsE,OAAItE;AAId,UAAI,CAACA,IAAGgd,WAAY,MAAM;AACxB,YAAA;AACEhd,gBAAMA,IAAIgf,IAAIhf,KAAK+e,YAAY,EAAClI,SAAAA;AAAAA,QAA7B,QAAA;AAAA,QAAA;AAMP,UAAIwa,cAAa7vB,QAAQxB,QAASA,KAAG;AAEnC,cAAA6jB,MAAYA,MAAA;AAEV,gBAAA,CAAAqW,kBAAA/a,MAAA,IAAmCnf,IAAGu0B,MAAO,GAAG,GAChD4F,iBAAqB,IAAIC,gBAAgBjb,MAAM;AAC/ChP,yBAAYvF,OAAQmhB,8CAAoC,GACxD5b,eAAYvF,OAAQohB,UAAAA,mCAAmC,GACvD+N,eAAe;AAAA,YAAAhpB,QACL;AAAA,cAAAyG,SACG,GAAG0iB,gBAAgB,GAAG/pB,eAAY2mB,OAAQ,IAApB,MAAA,EAAgC,GAAG3mB,cAAY;AAAA,YAAA;AAAA,UAChF,CACD;AAAA,QAAC;AAEJ,YAAA;AACE0T,cAAAA;AAAAA,QAAK,QAAA;AAELkW,yBAAe;AAAA,YAAAhpB,QAAS;AAAA,cAAAyG,SAAUxX;AAAAA,YAAAA;AAAAA,UAAG,CAAE;AAAA,QAAC;AAAA,MACzC;AAEHqxB,oBAAa7vB,UAAW;AAAA,QAAAqU;AAAAA,QAAA7V;AAAAA,MAAAA;AAAAA,IAAH,CACtB,GAEDlB,UAAOG,GAAI,uBAAuBo7B,CAAAA,WAAA;AAChChJ,oBAAa7vB,QAAQqU,QAASvR,OAAIuR;AAAAA,IAAP,CAC5B,GAED/W,UAAOG,GAAI,yBAAyBq7B,CAAAA,WAAA;AAClC/S,sBAAeK,KAAM;AAAA,QAAAvkB,MAAO;AAAA,QAAgC1C,SAAW2D,OAAI3D;AAAAA,MAAAA,CAAS;AAAA,IAAC,CACtF,GAED7B,UAAOG,GAAI,4BAA4Bs7B,CAAAA,WAAA;AACrCtI,yBACE,kBAEA3tB,OAAIwa,aACJxa,OAAIutB,SACN;AAAA,IAAC,CACF,GAGD/yB,UAAOG,GAAI,6BAA6Bu7B,CAAAA,WAAA;AAClCl2B,aAAIqyB,WAAY,WAClB/yB,aAAao2B,WAAUx4B,OAAQ,IACtB8C,OAAIqyB,WAAY,cACzBpP,gBAAeK,KAAM;AAAA,QAAAvkB,MAAO;AAAA,MAAA,CAAiB;AAAA,IAC9C,CACF,GAEDvE,UAAOG,GAAI,4BAA4B,MAAA;AACrCsoB,sBAAeK,KAAM;AAAA,QAAAvkB,MAAO;AAAA,MAAA,CAAgB;AAAA,IAAC,CAC9C,GAEDvE,UAAO27B,SAAUf,qBAAqB;AAEtC,UAAAlK,OAAa1wB,UAAO2wB,MAAAA;AACpB0J,WAAAA,wBAAwBr6B,SAAO,GACxB,MAAA;AACL0wB,WAAAA,GACA2J,wBAAwB,IAAI;AAAA,IAAC;AAAA,EAC9B,GACFv6B,QAAA8lB,YAAA9lB,QAAAm7B,gBAAAn7B,QAAA2oB,iBAAA3oB,QAAAqzB,oBAAArzB,QAAA86B,uBAAA96B,QAAAmgB,cAAAngB,QAAAyN,OAAAA,MAAAzN,EAAA,EAAA;AAAA,MAAAqO;AAAArO,IAAA,EAAA,MAAA8lB,cAAA9lB,EAAA,EAAA,MAAA2oB,mBAAA3oB,EAAA,EAAA,MAAAqzB,sBAAArzB,EAAA,EAAA,MAAA86B,yBAAA96B,UAAAmgB,gBAAE9R,MAAA,CAACyX,YAAY6C,iBAAiB0K,oBAAoByH,uBAAuB3a,YAAY,GAACngB,QAAA8lB,YAAA9lB,QAAA2oB,iBAAA3oB,QAAAqzB,oBAAArzB,QAAA86B,uBAAA96B,QAAAmgB,cAAAngB,QAAAqO,OAAAA,MAAArO,EAAA,EAAA,GApGzFO,gBAAUkN,KAoGPY,GAAsF;AAAC,MAAAC;AAAAtO,IAAA,EAAA,MAAA8lB,cAAA9lB,EAAA,EAAA,MAAA26B,WAAA36B,EAAA,EAAA,MAAAy6B,aAAAz6B,EAAA,EAAA,MAAAqzB,sBAAArzB,UAAAi7B,2BAEhF3sB,MAAAA,MAAA;AACR,QAAI,CAACwX;AAAU;AACf,UAAAgW,YAAgBhW,WAAUwK,cACxB;AAAA,MAAA9S,MACQ;AAAA,MAAcgT,WACT;AAAA,MAAaD,WACb;AAAA,IAAA,GAEbE,QAAAA,wBAAAA,EAAqDC,QAAS;AAAA,MAAA3vB,QACpD4vB,oBAAAA,0BAAAA;AAAAA,IAA0B,CACnC,CACH;AAEAzwB,WAAAA,UAAO27B,SAAUZ,uBAAuB,GAExC/6B,UAAOG,GAAI,yBAAyB07B,CAAAA,WAAA;AAC9Br2B,aAAI+0B,cAAeA,aAAa/0B,OAAIi1B,YAAaA,WACnDtH,mBACE,eAEA3tB,OAAIwa,aACJxa,OAAIutB,SACN;AAAA,IACD,CACF,GAEM/yB,UAAO2wB,MAAAA;AAAAA,EAAQ,GACvB7wB,QAAA8lB,YAAA9lB,QAAA26B,SAAA36B,QAAAy6B,WAAAz6B,QAAAqzB,oBAAArzB,QAAAi7B,yBAAAj7B,QAAAsO,OAAAA,MAAAtO,EAAA,EAAA;AAAA,MAAAwO;AAAAxO,YAAA8lB,cAAA9lB,EAAA,EAAA,MAAA26B,WAAA36B,EAAA,EAAA,MAAAy6B,aAAAz6B,EAAA,EAAA,MAAAqzB,sBAAArzB,UAAAi7B,2BAAAj7B,EAAA,EAAA,MAAAmgB,gBAAE3R,MAAA,CAACsX,YAAY6U,SAASF,WAAWpH,oBAAoB4H,yBAAyB9a,YAAY,GAACngB,QAAA8lB,YAAA9lB,QAAA26B,SAAA36B,QAAAy6B,WAAAz6B,QAAAqzB,oBAAArzB,QAAAi7B,yBAAAj7B,QAAAmgB,cAAAngB,QAAAwO,OAAAA,MAAAxO,EAAA,EAAA,GA3B9FO,MAAAA,UAAU+N,KA2BPE,GAA2F;AAAC,MAAAC;AAAAzO,IAAA,EAAA,MAAAq3B,kBAAAr3B,UAAAoc,YAO3F3N,MAAA9J,SAA6D2nB,CAAAA,YAAA;AAGvD+K,mBAAe10B,OAAK,KACtByZ,SAAS;AAAA,MAAAzZ,OACPA;AAAAA,MAAK0b,SACI;AAAA,IAAA,CACV;AAAA,EACF,GACA,CAAC,GAACre,QAAAq3B,gBAAAr3B,QAAAoc,UAAApc,QAAAyO,OAAAA,MAAAzO,EAAA,EAAA;AAdT,QAAAkY,kBAKIzJ;AAWH,MAAAK;AAAA9O,IAAA,EAAA,MAAA+d,gBAAA/d,UAAAoc,YAAApc,EAAA,EAAA,MAAAmS,OAAAyG,WAAA5Y,UAAAmgB,gBAGCrR,MAAAktB,CAAAA,aAAA;AACE,UAAA7G,QAAY,IAAI/U,IAAI4b,UAAU7b,YAAY,GAC1CvH,UAAgBxX,MAAG6W,SAAAA;AACf9F,WAAMyG,YAAaA,YAGnBhS,MAAKC,QAASkX,YAAY,IACxBA,aAAYjX,KAAMmb,aAAaA,QAAOC,KAAMtJ,OAAO,CAAC,KACtDwD,SAAS;AAAA,MAAAjK,QAAS;AAAA,QAAAyG;AAAAA,MAAAA;AAAAA,IAAQ,CAAE,IAErBxX,MAAG4f,WAAYb,gBACxB/D,SAAS;AAAA,MAAAjK,QAAS;AAAA,QAAAyG;AAAAA,MAAAA;AAAAA,IAAQ,CAAE;AAAA,EAC7B,GACF5Y,QAAA+d,cAAA/d,QAAAoc,UAAApc,EAAA,EAAA,IAAAmS,OAAAyG,SAAA5Y,QAAAmgB,cAAAngB,QAAA8O,OAAAA,MAAA9O,EAAA,EAAA;AAdH,QAAAi8B,oBAA0BntB;AAgBzB,MAAAC;AAAA/O,YAAAoc,YAGCrN,MAAAuoB,CAAAA,aAAA;AACElb,aAAS;AAAA,MAAAjK,QAACA;AAAAA,IAAAA,CAAO;AAAA,EAAC,GACnBnS,QAAAoc,UAAApc,QAAA+O,OAAAA,MAAA/O,EAAA,EAAA;AAHH,QAAAk8B,wBAA8BntB;AAK7B,MAAAC;AAAAhP,YAAAoc,YAGCpN,MAAAkH,CAAAA,cAAA;AACEkG,aAAS5H,SAAO;AAAA,EAAC,GAClBxU,QAAAoc,UAAApc,QAAAgP,OAAAA,MAAAhP,EAAA,EAAA;AAHH,QAAAkV,sBAA4BlG;AAK3B,MAAAC,KAAAS;AAAA1P,IAAA,EAAA,MAAAmS,OAAAjR,MAAAlB,EAAA,EAAA,MAAAmS,OAAAsB,QAAAzT,UAAAs6B,wBAGSrrB,MAAAA,MAAA;AACJkD,WAAMjR,MAAOiR,OAAMsB,OACrB6mB,sBAAoBt3B,KAAO,sBAAsB;AAAA,MAAA9B,IAAKiR,OAAMjR;AAAAA,MAAGuS,MAAQtB,OAAMsB;AAAAA,IAAAA,CAAM,IAEnF6mB,sBAAoBt3B,KAAO,mBAAmB;AAAA,EAC/C,GACA0M,MAAA,CAACyC,OAAMjR,IAAKiR,OAAMsB,MAAO6mB,oBAAoB,GAACt6B,EAAA,EAAA,IAAAmS,OAAAjR,IAAAlB,EAAA,EAAA,IAAAmS,OAAAsB,MAAAzT,QAAAs6B,sBAAAt6B,QAAAiP,KAAAjP,QAAA0P,QAAAT,MAAAjP,EAAA,EAAA,GAAA0P,MAAA1P,EAAA,EAAA,IANjDO,MAAAA,UAAU0O,KAMPS,GAA8C;AAAC,MAAAC,KAAAC;AAAA5P,IAAA,EAAA,MAAA0oB,sBAAA1oB,UAAAmS,OAAAyG,WAAA5Y,EAAA,EAAA,MAAAmgB,gBAAAngB,UAAAs6B,wBAGxC3qB,MAAAA,MAAA;AACR,QACE8iB,cAAa7vB,QAAQxB,OACrB+Q,OAAMyG,WACN6Z,cAAa7vB,QAAQxB,QAAS+Q,OAAMyG,SAAQ;AAE5C,UAAA;AACE,cAAAujB,cAAoB,IAAI/b,IAAIqS,cAAa7vB,QAAQxB,KAAM+e,YAAY,EAACa,QACpEob,gBAAsB,IAAIhc,IAAIjO,OAAMyG,SAAUuH,YAAY,EAACa;AAC3D,YAAImb,gBAAgBC;AAAa;AAAA,MAEhC,QAAA;AAAA,MAAA;AAMH,UADA3J,cAAa7vB,QAAQxB,MAAO+Q,OAAMyG,SAC9B8P,uBAAuB,aAAW;AAIpC,YAAA2T,QAAUlqB,OAAMyG;AAChB,YAAIxX,MAAGgd,WAAY,MAAM;AACvB,cAAA;AACE,kBAAAke,SAAe,IAAIlc,IAAIjO,OAAMyG,SAAUuH,YAAY;AACnD/e,oBAAMk7B,OAAMhc,WAAYgc,OAAM/b,SAAU+b,OAAMpM;AAAAA,UAA3C,QAAA;AAAA,UAAA;AAKPoK,8BAAoBt3B,KAAO,yBAAyB;AAAA,UAAA5B,KAClDA;AAAAA,UAAGqD,MACG;AAAA,QAAA,CACP;AAAA,MAAC;AAAA,IACH;AAAA,EACF,GACAmL,MAAA,CAAC8Y,oBAAoBvI,cAAchO,OAAMyG,SAAU0hB,oBAAoB,GAACt6B,QAAA0oB,oBAAA1oB,EAAA,EAAA,IAAAmS,OAAAyG,SAAA5Y,QAAAmgB,cAAAngB,QAAAs6B,sBAAAt6B,QAAA2P,KAAA3P,QAAA4P,QAAAD,MAAA3P,EAAA,EAAA,GAAA4P,MAAA5P,EAAA,EAAA,IApC3EO,MAAAA,UAAUoP,KAoCPC,GAAwE;AAAC,MAAAya;AAAArqB,YAAAs6B,wBAG1EjQ,MAAAA,MAAMiQ,sBAAoBt3B,KAAO,6BAA6B,GAAChD,QAAAs6B,sBAAAt6B,QAAAqqB,OAAAA,MAAArqB,EAAA,EAAA;AADjE,QAAA6oB,gBAAsBwB,KAKtB,CAAAkS,mBAAA1gB,oBAAA,IAAkD7Q,MAAAA,SAEhD,IAAI;AAAC,MAAAsf,KAAAC;AAAAvqB,YAAA6oB,iBAEGyB,MAAAA,MAAA;AACR,UAAAkS,cAAoB1hB,CAAAA,MAAA;AACd2hB,eAAS3hB,CAAC,KACZ+N,cAAAA;AAAAA,IACD,GAEH6T,gBAAsBC,CAAAA,QAAA;AAChBF,eAAS3hB,GAAC,KACZ+N,cAAAA,GAGE+T,SAAS,CAAC,OAAO,IAAI,GAAG9hB,GAAC,KAC3B+N,cAAAA;AAAAA,IACD;AAEH3c,WAAAA,OAAMwP,iBAAkB,WAAWghB,aAAa,GAChDxwB,OAAMwP,iBAAkB,SAAS8gB,WAAW,GACrC,MAAA;AACLtwB,aAAMyP,oBAAqB,WAAW+gB,aAAa,GACnDxwB,OAAMyP,oBAAqB,SAAS6gB,WAAW;AAAA,IAAC;AAAA,EACjD,GACAjS,MAAA,CAAC1B,aAAa,GAAC7oB,QAAA6oB,eAAA7oB,QAAAsqB,KAAAtqB,QAAAuqB,QAAAD,MAAAtqB,EAAA,EAAA,GAAAuqB,MAAAvqB,EAAA,EAAA,IArBlBO,gBAAU+pB,KAqBPC,GAAe;AAElB,QAAA,CAAAsS,iBAAAC,kBAAA,IAA8C9xB,MAAAA,SAAgC,IAAI;AAAC,MAAAwf;AAAAxqB,YAAA0c,sBAEW8N,MAAA;AAAA,IAAA9N;AAAAA,EAAAA,GAE7F1c,QAAA0c,oBAAA1c,QAAAwqB,OAAAA,MAAAxqB,EAAA,EAAA;AAFD,QAAA,CAAAyqB,KAAAsS,qBAAA,IAAqEtgB,yBAAyB+N,GAE7F,GAFM;AAAA,IAAAzN;AAAAA,IAAAC;AAAAA,EAAAA,IAAAyN;AAAmC,MAAAC;AAAA1qB,IAAA,EAAA,MAAA6sB,qBAAA7sB,EAAA,EAAA,MAAA2oB,mBAAA3oB,EAAA,EAAA,MAAAg7B,wBAAAh7B,UAAAs6B,wBAKxC5P,MAAA7Q,CAAAA,aAAA;AAEE,QADA8O,gBAAeK,KAAM;AAAA,MAAAvkB,MAAO;AAAA,IAAA,CAAiB,GACzC61B,sBAAoB;AAEtBc,iBAAUx4B,UAAWsJ,OAAMjH,WAAY4U,UAAU,GAAG,GACpDygB,qBAAoBt3B,KAAM,wBAAwB;AAAA,QAAA+0B,QACxC;AAAA,QAAQiF,oBAEdhC,yBAAyB,eAAenO,sBAAsB;AAAA,MAAA,CACjE;AAAC;AAAA,IAAA;AAGJhT,aAAAA;AAAAA,EAAU,GACX7Z,QAAA6sB,mBAAA7sB,QAAA2oB,iBAAA3oB,QAAAg7B,sBAAAh7B,QAAAs6B,sBAAAt6B,QAAA0qB,OAAAA,MAAA1qB,EAAA,EAAA;AAdH,QAAAipB,gBAAsByB,KAkBtBuS,YAAkBC,oBAAAA;AAAc,MAAAvS;AAAA3qB,IAAA,EAAA,MAAAmS,OAAAyG,WAAA5Y,EAAA,EAAA,MAAAi9B,UAAAzf,QAG9BmN,MAAAE,CAAAA,SAAA;AAAC,UAAA;AAAA,MAAA3pB;AAAAA,MAAAuD;AAAAA,MAAAgP;AAAAA,IAAAA,IAAAoX;AACC,QAAI4H,cAAa7vB,QAAQxB;AAAI,aACpB;AAAA,QAAA6V,OACEwb,cAAa7vB,QAAQqU,SAAUwb,cAAa7vB,QAAQxB;AAAAA,QAAIoc,MACzD;AAAA,QAAMrL,QACJ;AAAA,UAAAjR;AAAAA,UAAAuS;AAAAA,UAAAhP;AAAAA,UAAAkyB,SAIGwG,OAAAA;AAAAA,UAAuBF,WACrBA,UAASzf;AAAAA,UAAK4f,MACnBC,aAAAA;AAAAA,UAAgBzkB,SACbzG,OAAMyG;AAAAA,QAAAA;AAAAA,MACjB;AAAA,EAEH,GAEF5Y,EAAA,EAAA,IAAAmS,OAAAyG,SAAA5Y,EAAA,EAAA,IAAAi9B,UAAAzf,MAAAxd,QAAA2qB,OAAAA,MAAA3qB,EAAA,EAAA;AAlBH,QAAA8b,mBAAyB6O;AAoBxB,MAAAE;AAAA7qB,YAAAoc,YAGCyO,MAAAlf,CAAAA,SAAA;AAIEyQ,aAAS;AAAA,MAAAjK,QACC;AAAA,QAAA2W,UAFOnd,SAAS,YAAT1H,SAAA;AAAA,MAAA;AAAA,MAEGoa,SACT;AAAA,IAAA,CACV;AAAA,EAAC,GACHre,QAAAoc,UAAApc,QAAA6qB,OAAAA,MAAA7qB,EAAA,EAAA;AATH,QAAA4oB,cAAoBiC;AAWnB,MAAAC;AAAA9qB,YAAA+8B,yBAiBejS,MAAAvnB,+BAAC,yBAAqB,GAAGvD,QAAA+8B,uBAAA/8B,QAAA8qB,OAAAA,MAAA9qB,EAAA,EAAA;AAIV,QAAA+qB,MAAAhO,mBAAA,KAAA;AAA0B,MAAAiO;AAAAhrB,IAAA,EAAA,MAAAsoB,yBAAAtoB,EAAA,EAAA,MAAAwjB,+BAAAxjB,EAAA,EAAA,MAAAyjB,6BAAAzjB,EAAA,EAAA,MAAA2gB,mBAAA3gB,UAAAi8B,qBAAAj8B,EAAA,GAAA,MAAAipB,iBAAAjpB,WAAAu2B,qBAAAv2B,EAAA,GAAA,MAAA6sB,qBAAA7sB,WAAA+c,oBAAA/c,EAAA,GAAA,MAAA0oB,sBAAA1oB,EAAA,GAAA,MAAAmS,OAAAyG,WAAA5Y,WAAAkgB,eAAAlgB,EAAA,GAAA,MAAA2oB,mBAAA3oB,WAAA2d,iBAAA3d,EAAA,GAAA,MAAA4oB,eAAA5oB,EAAA,GAAA,MAAAmgB,gBAAAngB,EAAA,GAAA,MAAAgd,mBAAAhd,EAAA,GAAA,MAAA6oB,iBAAA7oB,EAAA,GAAA,MAAAk6B,mBAAAl6B,EAAA,GAAA,MAAA8sB,0BAAA9sB,WAAA8oB,YAKnCkC,MAAAznB,+BAAC,SAAA,EAIwB+kB,uBACM9E,6BACFC,2BACnByW,QAAAA,iBACI3D,YAAAA,mBACO1J,mBACD9P,kBACJkf,cAAAA,mBACHhT,WAAAA,eACAtI,WAAAA,iBACS+H,oBACR,YAAAvW,OAAMyG,SACLsH,aACRqI,KAAAA,WACQK,aACCzI,cACGnD,iBACF6L,eACLC,UACcgE,wBACPnE,iBACFhL,cAAAA,GAtBVwC,YAsBuB,GAC5BngB,QAAAsoB,uBAAAtoB,QAAAwjB,6BAAAxjB,QAAAyjB,2BAAAzjB,QAAA2gB,iBAAA3gB,QAAAi8B,mBAAAj8B,SAAAipB,eAAAjpB,SAAAu2B,mBAAAv2B,SAAA6sB,mBAAA7sB,SAAA+c,kBAAA/c,SAAA0oB,oBAAA1oB,EAAA,GAAA,IAAAmS,OAAAyG,SAAA5Y,SAAAkgB,aAAAlgB,SAAA2oB,iBAAA3oB,SAAA2d,eAAA3d,SAAA4oB,aAAA5oB,SAAAmgB,cAAAngB,SAAAgd,iBAAAhd,SAAA6oB,eAAA7oB,SAAAk6B,iBAAAl6B,SAAA8sB,wBAAA9sB,SAAA8oB,UAAA9oB,SAAAgrB,OAAAA,MAAAhrB,EAAA,GAAA;AAAA,MAAAmrB;AAAAnrB,IAAA,GAAA,MAAA68B,mBAAA78B,WAAAgrB,OA5BNG,qCAACta,GAAAA,MAAA,EAAe,WAAA,UAAe,MAAA,GAAU,QAAA,QAAYisB,KAAAA,oBACnD,UAAAv5B,2BAAAA,IAAC+5B,GAAAA,yBAAA,EAAiCT,0BAChC7R,UAAAA,IAAAA,CA2BF,GACF,GAAOhrB,SAAA68B,iBAAA78B,SAAAgrB,KAAAhrB,SAAAmrB,OAAAA,MAAAnrB,EAAA,GAAA;AAAA,MAAAorB;AAAAprB,IAAA,GAAA,MAAA+qB,OAAA/qB,WAAAmrB,OApCTC,qCAAC,OAAA,EACI,IAAA,WACO,UAAA,KACG,aAAAL,KACN,OAAA,GAEPI,eA+BF,GAAQnrB,SAAA+qB,KAAA/qB,SAAAmrB,KAAAnrB,SAAAorB,OAAAA,MAAAprB,EAAA,GAAA;AAAA,MAAAqrB;AAAArrB,IAAA,GAAA,MAAAkc,mBAAAlc,EAAA,GAAA,MAAA8b,oBAAA9b,WAAAkV,uBAAAlV,EAAA,GAAA,MAAAkY,mBAAAlY,EAAA,GAAA,MAAAk8B,yBAAAl8B,EAAA,GAAA,MAAA2W,qBAAA3W,EAAA,GAAA,MAAAmS,OAAAjR,MAAAlB,EAAA,GAAA,MAAAmS,OAAA1N,QAAAzE,EAAA,GAAA,MAAAuR,gBAAAvR,WAAAiT,mBACRoY,MAAA9nB,+BAAC,qBAAA,EACa,YAAA4O,OAAMjR,IACDgb,iBACH,cAAA/J,OAAM1N,MACFqX,kBACCnF,mBACFzB,iBAAAA,qBACJgD,aAAAA,iBACMgkB,mBAAAA,uBACL3qB,cACQsK,sBACL5I,gBAAAA,CAAe,GAChCjT,SAAAkc,iBAAAlc,SAAA8b,kBAAA9b,SAAAkV,qBAAAlV,SAAAkY,iBAAAlY,SAAAk8B,uBAAAl8B,SAAA2W,mBAAA3W,EAAA,GAAA,IAAAmS,OAAAjR,IAAAlB,EAAA,GAAA,IAAAmS,OAAA1N,MAAAzE,SAAAuR,cAAAvR,SAAAiT,iBAAAjT,SAAAqrB,OAAAA,MAAArrB,EAAA,GAAA;AAAA,MAAAsrB;AAAAtrB,IAAA,GAAA,MAAA8qB,OAAA9qB,WAAAorB,OAAAprB,EAAA,GAAA,MAAAqrB,OArDNC,qCAAC,WAAA,EAAsB,eAAA,qBAA2B,QAAA,QAChD,0CAAC,QAAA,EACCR,UAAAA;AAAAA,IAAAA;AAAAA,IACAM;AAAAA,IAsCAC;AAAAA,EAAAA,GAaF,EAAA,CACF,GAAYrrB,SAAA8qB,KAAA9qB,SAAAorB,KAAAprB,SAAAqrB,KAAArrB,SAAAsrB,OAAAA,MAAAtrB,EAAA,GAAA;AAAA,MAAAurB;AAAAvrB,IAAA,GAAA,MAAAsrB,OAAAtrB,WAAAs6B,wBAxDd/O,MAAAhoB,2BAAAA,IAAC,qBAAA,EAA6B+2B,SAAAA,sBAC5BhP,UAAAA,KAwDF,GAAsBtrB,SAAAsrB,KAAAtrB,SAAAs6B,sBAAAt6B,SAAAurB,OAAAA,MAAAvrB,EAAA,GAAA;AAAA,MAAAwrB;AAAAxrB,IAAA,GAAA,MAAAmS,UAAAnS,WAAAurB,OA1DxBC,MAAAjoB,2BAAAA,IAAC,4BAAA,EAAmC4O,QAClCoZ,UAAAA,IAAAA,CA0DF,GAA6BvrB,SAAAmS,QAAAnS,SAAAurB,KAAAvrB,SAAAwrB,OAAAA,MAAAxrB,EAAA,GAAA;AAAA,MAAA2rB;AAAA3rB,IAAA,GAAA,MAAAoc,YAAApc,WAAAwrB,OA5D/BG,MAAApoB,2BAAAA,IAAC,8BAAA,EAAuC6Y,UACtCoP,UAAAA,IAAAA,CA4DF,GAA+BxrB,SAAAoc,UAAApc,SAAAwrB,KAAAxrB,SAAA2rB,OAAAA,MAAA3rB,EAAA,GAAA;AAAA,MAAA4rB;AAAA5rB,IAAA,GAAA,MAAA4W,WAAA5W,EAAA,GAAA,MAAAwd,QAAAxd,EAAA,GAAA,MAAAoc,YAAApc,WAAAmS,UAAAnS,EAAA,GAAA,MAAAuR,gBAAAvR,EAAA,GAAA,MAAAiT,mBAAAjT,EAAA,GAAA,MAAA2rB,OArEjCC,qCAAC,sBAAA,EACUhV,SACH4G,MACIpB,UACFjK,QACMZ,cACG0B,iBAEjB0Y,UAAAA,IAAAA,CA8DF,GAAuB3rB,SAAA4W,SAAA5W,SAAAwd,MAAAxd,SAAAoc,UAAApc,SAAAmS,QAAAnS,SAAAuR,cAAAvR,SAAAiT,iBAAAjT,SAAA2rB,KAAA3rB,SAAA4rB,OAAAA,MAAA5rB,EAAA,GAAA;AAAA,MAAA6rB;AAAA7rB,IAAA,GAAA,MAAA8lB,cAAA9lB,EAAA,GAAA,MAAAu8B,qBAAAv8B,EAAA,GAAA,MAAAkgB,eAAAlgB,EAAA,GAAA,MAAAqzB,sBAAArzB,WAAA+6B,wBAEpBlP,MAAA/F,cACCviB,2BAAAA,IAAC,aAAA,EACauiB,YACC5F,aACCqc,cAAAA,mBACKlJ,mBAAAA,oBACE0H,qBAAAA,qBAAAA,CAAoB,GAE5C/6B,SAAA8lB,YAAA9lB,SAAAu8B,mBAAAv8B,SAAAkgB,aAAAlgB,SAAAqzB,oBAAArzB,SAAA+6B,sBAAA/6B,SAAA6rB,OAAAA,MAAA7rB,EAAA,GAAA;AAAA,MAAA8rB;AAAA9rB,aAAA6sB,qBAAA7sB,EAAA,GAAA,MAAAmS,OAAAjR,MAAAlB,WAAAmS,OAAA1N,QAAAzE,WAAAg7B,wBAAAh7B,EAAA,GAAA,MAAAs6B,wBACAxO,MAAAwO,wBAAwBnoB,OAAMjR,MAAOiR,OAAM1N,QAC1ClB,2BAAAA,IAAC,6BAAA,EACU+2B,+BACL,IAAAnoB,OAAMjR,IACJ,MAAAiR,OAAM1N,MACOooB,mBACGmO,qBAAAA,CAAoB,GAE7Ch7B,SAAA6sB,mBAAA7sB,EAAA,GAAA,IAAAmS,OAAAjR,IAAAlB,EAAA,GAAA,IAAAmS,OAAA1N,MAAAzE,SAAAg7B,sBAAAh7B,SAAAs6B,sBAAAt6B,SAAA8rB,OAAAA,MAAA9rB,EAAA,GAAA;AAAA,MAAAu9B;AAAAv9B,IAAA,GAAA,MAAAkgB,eAAAlgB,WAAAs6B,wBACAiD,MAAAjD,wBACC/2B,2BAAAA,IAAC,mBAAA,EAA2B+2B,SAAAA,sBAAmCpa,aAAW,GAC3ElgB,SAAAkgB,aAAAlgB,SAAAs6B,sBAAAt6B,SAAAu9B,OAAAA,MAAAv9B,EAAA,GAAA;AAAA,MAAAw9B;AAAAx9B,IAAA,GAAA,MAAAkc,mBAAAlc,WAAAkgB,eAAAlgB,EAAA,GAAA,MAAAs6B,wBACAkD,MAAAlD,wBAAwBpe,gBAAevT,SAAU,KAChDpF,+BAAC,+BACU+2B,SAAAA,sBACIpa,aACPhE,MAAAA,gBAAAA,CAAe,GAExBlc,SAAAkc,iBAAAlc,SAAAkgB,aAAAlgB,SAAAs6B,sBAAAt6B,SAAAw9B,OAAAA,MAAAx9B,EAAA,GAAA;AAAA,MAAAy9B;AAAAz9B,IAAA,GAAA,MAAAkgB,eAAAlgB,WAAAs6B,wBACAmD,MAAAnD,wBACC/2B,2BAAAA,IAAC,sBAAA,EAA8B+2B,SAAAA,sBAAmCpa,aAAW,GAC9ElgB,SAAAkgB,aAAAlgB,SAAAs6B,sBAAAt6B,SAAAy9B,OAAAA,MAAAz9B,EAAA,GAAA;AAAA,MAAA09B;AAAA19B,aAAAs6B,wBACAoD,MAAApD,wBAAwB/2B,+BAAC,uBAA6B+2B,SAAAA,qBAAAA,CAAoB,GAAIt6B,SAAAs6B,sBAAAt6B,SAAA09B,OAAAA,MAAA19B,EAAA,GAAA;AAAA,MAAA29B;AAAA39B,IAAA,GAAA,MAAAkgB,eAAAlgB,WAAAs6B,wBAC9EqD,MAAArD,wBACC/2B,2BAAAA,IAAC,wBAAA,EAAgC+2B,SAAAA,sBAAmCpa,aAAW,GAChFlgB,SAAAkgB,aAAAlgB,SAAAs6B,sBAAAt6B,SAAA29B,OAAAA,MAAA39B,EAAA,GAAA;AAAA,MAAA49B;AAAA59B,aAAAs6B,wBACAsD,MAAAtD,wBAAwB/2B,+BAAC,wBAA8B+2B,SAAAA,qBAAAA,CAAoB,GAAIt6B,SAAAs6B,sBAAAt6B,SAAA49B,OAAAA,MAAA59B,EAAA,GAAA;AAAA,MAAA69B;AAAA79B,IAAA,GAAA,MAAA6rB,OAAA7rB,EAAA,GAAA,MAAA8rB,OAAA9rB,EAAA,GAAA,MAAAu9B,OAAAv9B,EAAA,GAAA,MAAAw9B,OAAAx9B,EAAA,GAAA,MAAAy9B,OAAAz9B,EAAA,GAAA,MAAA09B,OAAA19B,EAAA,GAAA,MAAA29B,OAAA39B,WAAA49B,OApClFC,sCAACxlB,MAAAA,UAAA,EACEwT,UAAAA;AAAAA,IAAAA;AAAAA,IASAC;AAAAA,IASAyR;AAAAA,IAGAC;AAAAA,IAOAC;AAAAA,IAGAC;AAAAA,IACAC;AAAAA,IAGAC;AAAAA,EAAAA,EAAAA,CACH,GAAW59B,SAAA6rB,KAAA7rB,SAAA8rB,KAAA9rB,SAAAu9B,KAAAv9B,SAAAw9B,KAAAx9B,SAAAy9B,KAAAz9B,SAAA09B,KAAA19B,SAAA29B,KAAA39B,SAAA49B,KAAA59B,SAAA69B,OAAAA,MAAA79B,EAAA,GAAA;AAAA,MAAA89B;AAAA,SAAA99B,EAAA,GAAA,MAAA4rB,OAAA5rB,WAAA69B,OA7GbC,6DACElS,UAAAA;AAAAA,IAAAA;AAAAA,IAuEAiS;AAAAA,EAAAA,EAAAA,CAqCW,GACV79B,SAAA4rB,KAAA5rB,SAAA69B,KAAA79B,SAAA89B,OAAAA,MAAA99B,EAAA,GAAA,GA9GH89B;AA8GG;AAjiBQ,SAAA13B,SAAAimB,SAAA;AAAA,SAyF6C1pB,QAAKypB,QAAS,SAAS;AAAC;AAzFrE,SAAA9rB,QAAAqC,OAAA;AAAA,SA+BAA,MAAKxB,QAAQ48B,aAAyBC,gBAAK;AAAK;AAugB/D,SAASvB,SAAS36B,OAA+B;AAC/C,SAAOA,MAAMgB,QAAQ;AACvB;AAGA,MAAMm7B,SACJ,OAAO/xB,SAAU,OAAe,uBAAuBgW,KAAKhW,OAAOwZ,UAAUwY,QAAQ,GACjFC,YAA2E;AAAA,EAC/EC,KAAK;AAAA,EACLC,MAAM;AAAA,EACNC,KAAKL,SAAS,YAAY;AAAA,EAC1BrI,OAAO;AACT;AAEA,SAASgH,SAAS2B,MAAgBz8B,OAA+B;AAC/D,SAAOy8B,KAAKC,MAAO17B,CAAAA,QACbq7B,UAAUr7B,GAAG,IACRhB,MAAMq8B,UAAUr7B,GAAG,CAAC,IAEtBhB,MAAMgB,QAAQA,IAAI27B,aAC1B;AACH;ACpoBO,SAASC,+BAA+B;AAAA,EAC7C1a,QAAAA;AAAAA,EACA2a;AAIF,GAGG;AACD,SAAOC,OAAAA,YAAY,YACV,MAAMC,iCAAoB7a,SAAQ,uBAAuBmB,SAASzE,MAAMie,aAAa,CAC7F;AACH;ACbO,SAASG,4BAA4B;AAAA,EAC1C9a,QAAAA;AAGF,GAAqC;AACnC,SAAO4a,OAAAA,YAAY,YACV5a,QAAOsC,MACZC,UAAAA,wBACA,CAAA,GACA;AAAA,IAACE,KAAK;AAAA,EAAA,CACR,CACD;AACH;ACPO,SAASsY,gCAAgC;AAAA,EAC9C/a,QAAAA;AAAAA,EACAgb;AACO,GAA2C;AAClD,SAAOJ,OAAAA,YAAiC,OAAO;AAAA,IAACK;AAAAA,EAAAA,MAAW;AACzD,UAAM;AAAA,MAACvb;AAAAA,IAAAA,IAAcub;AAYrB,QAPI,OAAOC,aAAe,OACxB,MAAM,OAAO,qBAAqB,GAMhC,CAACF;AACH,aAAO,CAAC,IAAIE,WAAWxb,WAAW1C,MAAM,CAAC;AAG3C,UAAMme,gBACJ,OAAOH,eAAgB,aACnB,MAAMA,YAAY;AAAA,MAAChb,QAAAA;AAAAA,MAAQhD;AAAAA,MAAQ0C;AAAAA,IAAAA,CAAW,IAC9Csb,aAEAI,eADWx4B,MAAMC,QAAQs4B,aAAa,IAAIA,gBAAgB,CAACA,aAAa,GACjDp5B,IAAKhD,CAAAA,UAAU;AAC1C,YAAMs8B,aAAa,IAAIH,WAAWn8B,KAAK;AACvC,UAAIs8B,WAAWjF,aAAa;AAC1B,cAAM,IAAIh2B,MACR,iFACF;AAEF,aAAOi7B;AAAAA,IACT,CAAC;AAID,WAAKD,YAAYt4B,KAAMmb,CAAAA,YAAYA,QAAQC,KAAKwB,WAAW1C,MAAM,CAAC,IAI3Doe,cAHE,CAAC,GAAGA,aAAa,IAAIF,WAAWxb,WAAW1C,MAAM,CAAC;AAAA,EAI7D,CAAC;AACH;AC/CO,SAASse,6BAA6B;AAAA,EAC3Ctb,QAAAA;AAAAA,EACAub;AAAAA,EACAC;AAAAA,EACAtf;AAMF,GAAgE;AAC9D,SAAO0e,OAAAA,YACL,OAAO;AAAA,IAACK;AAAAA,EAAAA,MAAyD;AAC/D,UAAM;AAAA,MAACje,QAAAA;AAAAA,IAAAA,IAAUmE;AAIjB,QAAI,OAAOqa,oBAAqB,YAAY;AAC1C,YAAMr9B,UAAU,MAAMq9B,iBAAiB;AAAA,QACrCxb,QAAAA;AAAAA,QACAub;AAAAA;AAAAA,QAEAja,kBAAkB;AAAA,QAClBma,0BAA0BzhB,wBAAwBkC,WAAW;AAAA,QAC7Dwf,oBAAoBT,MAAMS;AAAAA,MAAAA,CAC3B;AACD,aAAO,IAAItf,IAAIje,SAAS6e,OAAM;AAAA,IAChC;AAKA,QAAI,CAACwe;AACH,aAAO,IAAIpf,IAAI,KAAKY,OAAM;AAK5B,QAAI,OAAOwe,oBAAqB;AAC9B,aAAO,IAAIpf,IAAIof,kBAAkBxe,OAAM;AAGzC,QAAI,OAAOwe,iBAAiBr9B,WAAY,YAAY;AAClD,YAAMA,UAAU,MAAMq9B,iBAAiBr9B,QAAQ;AAAA,QAC7C6hB,QAAAA;AAAAA,QACAhD,QAAAA;AAAAA,MAAAA,CACD;AACD,aAAO,IAAIZ,IAAIje,SAAS6e,OAAM;AAAA,IAChC;AAEA,WAAI,OAAOwe,iBAAiBr9B,WAAY,WAC/B,IAAIie,IAAIof,iBAAiBr9B,SAAS6e,OAAM,IAG1C,IAAIZ,IAAIof,iBAAiB5mB,WAAW,KAAK4mB,iBAAiBxe,UAAUA,OAAM;AAAA,EACnF,CACF;AACF;AChDO,SAAS2e,8BAA8B;AAAA,EAC5C3b,QAAAA;AAAAA,EACAwb;AACO,GAA4D;AACnE,SAAOZ,OAAAA,YAAkD,OAAO;AAAA,IAACK;AAAAA,EAAAA,MAAW;AAC1E,UAAM;AAAA,MAAC9e;AAAAA,IAAAA,IAAgB8e;AAKvB,QAAI,OAAOO,oBAAqB,YAAYA,kBAAkBI;AAC5D,aAAO;AAAA,QACLC,QAAQL,iBAAiBI,UAAUC;AAAAA,QACnC7B,aAAawB,iBAAiBI,UAAU5B,eAAe;AAAA,MAAA;AAO3D,QACE,CAACwB,oBACD,OAAOA,oBAAqB,YAC5B,OAAOA,oBAAqB,cAC5B,CAACA,iBAAiBzB;AAElB,aAAO;AAMT,UAAMA,cACJ,OAAOyB,iBAAiBzB,eAAgB,aACpC,MAAMyB,iBAAiBzB,YAAY;AAAA,MAAC/Z,QAAAA;AAAAA,MAAQhD;AAAAA,MAAQb;AAAAA,IAAAA,CAAa,IACjEqf,iBAAiBzB;AAEvB,WAAIA,gBAAgB,KACX,KAMF;AAAA,MACL8B,QAAQ9B,YAAY8B;AAAAA,MACpB7B,aAAaD,YAAYC,eAAe;AAAA,IAAA;AAAA,EAE5C,CAAC;AACH;AC1CO,SAAS8B,iCAAiC;AAAA,EAC/C9b,QAAAA;AAAAA,EACAub;AAAAA,EACAC;AAAAA,EACAtf;AAMF,GAAuD;AACrD,SAAO0e,OAAAA,YAA6C,OAAO;AAAA,IAACK;AAAAA,EAAAA,MAAW;AACrE,UAAM;AAAA,MAAC3Z;AAAAA,MAAkBya;AAAAA,MAAqBrc;AAAAA,IAAAA,IAAcub;AAK5D,QAAI,OAAOO,oBAAqB,YAAY;AAC1C,YAAMr9B,UAAU,MAAMq9B,iBAAiB;AAAA,QACrCxb,QAAAA;AAAAA,QACAub;AAAAA,QACAja;AAAAA,QACAma,0BAA0BzhB,wBAAwBkC,WAAW;AAAA,QAC7Dwf,oBAAoBhc,WAAWzL,SAAAA;AAAAA,MAAS,CACzC;AACD,aAAO,IAAImI,IAAIje,SAASuhB,UAAU;AAAA,IACpC;AAKA,QAAI,CAACqc;AACH,YAAM,IAAI37B,MAAM,gCAAgC;AAGlD,UAAMhD,MAAM,IAAIgf,IAAI2f,oBAAoBF,QAAQnc,UAAU;AAE1DtiB,WAAAA,IAAImQ,aAAalL,IAAI25B,UAAAA,6BAA6B1a,gBAAgB,GAClElkB,IAAImQ,aAAalL,IAAIga,UAAAA,kCAAkCrC,wBAAwBkC,WAAW,CAAC,GACvFwD,WAAWpD,aAAalf,IAAIkf,YAC9Blf,IAAImQ,aAAalL,IACf45B,UAAAA,+BACA,GAAGvc,WAAWpD,QAAQ,GAAGoD,WAAWnD,MAAM,GAAGmD,WAAWwM,IAAI,EAC9D,GAGK9uB;AAAAA,EACT,CAAC;AACH;ACpEO,MAAM8+B,wCAAwCtB,OAAAA,YAGnD,OAAO;AAAA,EAACK;AAAK,MAAM;AACnB,QAAM;AAAA,IAACS;AAAAA,IAAoBhc;AAAAA,IAAY3F;AAAAA,EAAAA,IAAgBkhB;AAKvD,MAAI,CAACS;AACH,WAAOhc;AAMT,MAAI;AACF,UAAMyc,wBAAwB,IAAI/f,IAAIsf,oBAAoBhc,WAAW1C,MAAM;AAC3E,WAAKjD,aAAajX,KAAMmb,CAAAA,YAAYA,QAAQC,KAAKie,sBAAsBnf,MAAM,CAAC,IAGvEmf,wBAFEzc;AAAAA,EAGX,QAAc;AACZ,WAAOA;AAAAA,EACT;AACF,CAAC,GCiBY0c,+BAA+B;AAAA,EAACpsB,KAAKqsB,UAAAA;AAAAA,EAAmBpsB,OAAOqsB,UAAAA;AAAmB,GAClFC,2BAA2B;AAAA,EACtCvsB,KAAK,UAAUmG,OAAAA,KAAAA,CAAM;AAAA,EACrBlG,OAAOwE,UAAAA;AACT,GAEa+nB,oBAAoB5/B,OAAAA,MAAM;AAAA,EACrCC,OAAO,CAAA;AAAA,EAMPC,SAAS;AAAA,IACP,mCAAmC2/B,OAAAA,IACjC,gHACF;AAAA,IACA,+BAA+Bl/B,OAAAA,OAAO;AAAA,MACpCm+B,oBAAoBA,CAACgB,GAAGvuB,WACtBA,OAAOutB;AAAAA,IAAAA,CACV;AAAA,IACD,gBAAgBn+B,OAAAA,OAAO;AAAA,MACrBF,OAAOA,CAACq/B,GAAGvuB,WACFA,OAAO9Q,iBAAiB+C,QAC3B+N,OAAO9Q,QACP,IAAI+C,MAAM+N,OAAOrC,SAAS;AAAA,QAAC4kB,OAAOviB,OAAO9Q;AAAAA,MAAAA,CAAM;AAAA,IAAA,CAEtD;AAAA,EAAA;AAAA,EAEHN,QAAQ;AAAA,IACN,oBAAoB4/B,OAAAA,eAA4D,MAC9EC,KAAAA,WACE,MACE,IAAIx8B,MACF,uLACF,CACJ,CACF;AAAA,IACA,uBAAuBw6B,OAAAA,YAAsD,MAC3EiC,QAAQC,OACN,IAAI18B,MACF,8IACF,CACF,CACF;AAAA,IACA,0BAA0Bw6B,OAAAA,YAA6C,MACrEiC,QAAQC,OACN,IAAI18B,MACF,mJACF,CACF,CACF;AAAA,IACA,yCAAyC87B;AAAAA,IACzC,wBAAwBtB,OAAAA,YAAmE,MACzFiC,QAAQC,OACN,IAAI18B,MACF,gJACF,CACF,CACF;AAAA,IACA,yBAAyBw6B,OAAAA,YAGtB,YACDiC,QAAQC,OACN,IAAI18B,MACF,kJACF,CACF,CACF;AAAA,IACA,8BAA8Bw6B,OAAAA,YAA2B,YACvDiC,QAAQC,OACN,IAAI18B,MACF,4JACF,CACF,CACF;AAAA,IACA,4BAA4Bw6B,OAAAA,YAA6C,MACvEiC,QAAQC,OACN,IAAI18B,MACF,wJACF,CACF,CACF;AAAA,EAAA;AAAA,EAEFpD,QAAQ;AAAA,IACN,2BAA2B+/B,CAAC;AAAA,MAAC5/B;AAAAA,IAAAA,MACpB6/B,GACL7/B,QAAQ8/B,wCACN9/B,QAAQ+/B,sCACR//B,QAAQggC,wCACRhgC,QAAQigC;AAAAA,IAGd,+BAA+BC,CAAC;AAAA,MAAClgC;AAAAA,MAASW;AAAAA,IAAAA,MAAW;AACnD,UAAI,CAACX,QAAQ4f,cAAc,CAACjf,MAAM49B;AAChC,eAAO;AAET,UAAI;AACF,cAAMS,wBAAwB,IAAI/f,IAAIte,MAAM49B,oBAAoBv+B,QAAQ4f,UAAU;AAClF,eAAO5f,QAAQ4f,WAAWC,WAAWmf,sBAAsBnf;AAAAA,MAC7D,QAAQ;AACN,eAAO;AAAA,MACT;AAAA,IACF;AAAA,IACA,6BAA6BsgB,CAAC;AAAA,MAACngC;AAAAA,IAAAA,MACtBA,QAAQigC,4BAA4BG,YAAY;AAAA,IAGzD,wCAAwCC,CAAC;AAAA,MAACrgC;AAAAA,IAAAA,GAAUgR,WAC9CA,WAAW,KACN,KAEFhR,QAAQigC,4BAA4BG,YAAY;AAAA,IAEzD,sCAAsCE,CAAC;AAAA,MAACtgC;AAAAA,IAAAA,GAAUgR,WAC5CA,WAAW,KACN,KAEFhR,QAAQ+/B,oCAAoCK,YAAY;AAAA,IAEjE,wCAAwCG,CAAC;AAAA,MAACvgC;AAAAA,IAAAA,GAAUgR,WAC9CA,WAAW,KACN,KAGPhR,QAAQ+/B,oCAAoCK,YAAY,MACxDpgC,QAAQigC,4BAA4BG,YAAY;AAAA,EAAA;AAAA,EAItDI,QAAQ;AAAA,IACNC,eAAeA,CAAC;AAAA,MAACzgC;AAAAA,IAAAA,MAAa;AAC5B,UAAI,CAACA,QAAQmkB,kBAAkBuc;AAC7B,eAAO;AAET,YAAMC,MAAMC,KAAKD,IAAAA,GACXD,YAAY1gC,QAAQmkB,iBAAiBuc,UAAUG,QAAAA;AACrD,aAAO36B,KAAKE,IAAIs6B,YAAYC,KAAK,CAAC;AAAA,IACpC;AAAA,EAAA;AAEJ,CAAC,EAAE7gC,cAAc;AAAA;AAAA;AAAA,EAGfC,IAAI;AAAA,EACJC,SAASA,CAAC;AAAA,IAAC89B;AAAAA,EAAAA,OAAY;AAAA,IACrBvb,YAAY;AAAA,IACZ3C,YAAY;AAAA,IACZ1f,OAAO;AAAA,IACP0c,cAAc;AAAA,IACd2hB,oBAAoBT,MAAMS;AAAAA,IAC1Bpa,kBAAkB;AAAA,IAClB2b,sCAAsC;AAAA,IACtCC,oCAAoC;AAAA,IACpCC,sCAAsC;AAAA,IACtCC,4BAA4B;AAAA,IAC5BrD,aAAa;AAAA,EAAA;AAAA,EAGfkE,QAAQ,CACN;AAAA,IACEtjB,KAAK;AAAA,IACLsgB,OAAOA,OAAO;AAAA,MAACiD,qBAAqB;AAAA,MAAQprB,UAAUspB;AAAAA,IAAAA;AAAAA,IACtD+B,SAAS;AAAA,MACP3gC,QAAQ;AAAA,MACRV,SAAS;AAAA,QACP2D,MAAM;AAAA,QACN0N,QAAQA,CAAC;AAAA,UAACrQ;AAAAA,QAAAA,OAAY;AAAA,UACpBgO,SAAS;AAAA,UACTzO,OAAOS,MAAMT;AAAAA,QAAAA;AAAAA,MACf;AAAA,IACF;AAAA,IAEF+gC,YAAY;AAAA,MACVthC,SAASS,OAAAA,OAAO;AAAA,QACd2/B,oCAAoCA,CAAC;AAAA,UAACp/B;AAAAA,QAAAA,MAAWA,MAAM6X,SAASxY,WAAW;AAAA,MAAA,CAC5E;AAAA,IAAA;AAAA,EACH,GAEF;AAAA,IACEwd,KAAK;AAAA,IACLsgB,OAAOA,OAAO;AAAA,MAACiD,qBAAqB;AAAA,MAAUprB,UAAUspB;AAAAA,IAAAA;AAAAA,IACxD+B,SAAS;AAAA,MACP3gC,QAAQ;AAAA,MACRV,SAAS;AAAA,QACP2D,MAAM;AAAA,QACN0N,QAAQA,CAAC;AAAA,UAACrQ;AAAAA,QAAAA,OAAY;AAAA,UACpBgO,SAAS;AAAA,UACTzO,OAAOS,MAAMT;AAAAA,QAAAA;AAAAA,MACf;AAAA,IACF;AAAA,IAEF+gC,YAAY;AAAA,MACVthC,SAASS,OAAAA,OAAO;AAAA,QACd0/B,sCAAsCA,CAAC;AAAA,UAACn/B;AAAAA,QAAAA,MAAWA,MAAM6X,SAASxY,WAAW;AAAA,MAAA,CAC9E;AAAA,IAAA;AAAA,EACH,GAEF;AAAA,IACEwd,KAAK;AAAA,IACLsgB,OAAOA,OAAO;AAAA,MAACiD,qBAAqB;AAAA,MAAUprB,UAAUspB;AAAAA,IAAAA;AAAAA,IACxD+B,SAAS;AAAA,MACP3gC,QAAQ;AAAA,MACRV,SAAS;AAAA,QACP2D,MAAM;AAAA,QACN0N,QAAQA,CAAC;AAAA,UAACrQ;AAAAA,QAAAA,OAAY;AAAA,UACpBgO,SAAS;AAAA,UACTzO,OAAOS,MAAMT;AAAAA,QAAAA;AAAAA,MACf;AAAA,IACF;AAAA,IAEF+gC,YAAY;AAAA,MACVthC,SAASS,OAAAA,OAAO;AAAA,QACd4/B,sCAAsCA,CAAC;AAAA,UAACr/B;AAAAA,QAAAA,MAAWA,MAAM6X,SAASxY,WAAW;AAAA,MAAA,CAC9E;AAAA,IAAA;AAAA,EACH,GAEF;AAAA,IACEwd,KAAK;AAAA,IACLsgB,OAAOA,OAAO;AAAA,MAACiD,qBAAqB;AAAA,MAAUprB,UAAUypB;AAAAA,IAAAA;AAAAA,IACxD4B,SAAS;AAAA,MACP3gC,QAAQ;AAAA,MACRV,SAAS;AAAA,QACP2D,MAAM;AAAA,QACN0N,QAAQA,CAAC;AAAA,UAACrQ;AAAAA,QAAAA,OAAY;AAAA,UACpBgO,SAAS;AAAA,UACTzO,OAAOS,MAAMT;AAAAA,QAAAA;AAAAA,MACf;AAAA,IACF;AAAA,IAEF+gC,YAAY;AAAA,MACVthC,SAASS,OAAAA,OAAO;AAAA,QACd6/B,4BAA4BA,CAAC;AAAA,UAACt/B;AAAAA,QAAAA,MAAWA,MAAM6X,SAASxY,WAAW;AAAA,MAAA,CACpE;AAAA,IAAA;AAAA,EACH,CACD;AAAA,EAGHd,IAAI;AAAA,IACF,4BAA4B;AAAA,MAC1BS,SAAS;AAAA,QACP2D,MAAM;AAAA,QACN0N,QAAQA,CAAC;AAAA,UAACrQ;AAAAA,QAAAA,OAAY;AAAA,UAAC49B,oBAAoB59B,MAAM49B;AAAAA,QAAAA;AAAAA,MAAkB;AAAA,IACrE;AAAA,EACF;AAAA,EAGFj+B,QAAQ;AAAA,IACN4gC,qBAAqB;AAAA,MACnBC,QAAQ;AAAA,QACNC,OAAO;AAAA,QACP/gC,QAAQ;AAAA,MAAA;AAAA,MAEVG,MAAM;AAAA,IAAA;AAAA,IAGR6gC,qBAAqB;AAAA,MACnBP,QAAQ;AAAA,QACNtjB,KAAK;AAAA,QACLsgB,OAAOA,CAAC;AAAA,UAAC99B;AAAAA,QAAAA,OAAc;AAAA,UAACu+B,oBAAoBv+B,QAAQu+B;AAAAA,QAAAA;AAAAA,QACpDyC,SAAS;AAAA,UACP3gC,QAAQ;AAAA,UACRV,SAAS;AAAA,YACP2D,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,OAAY;AAAA,cACpBgO,SAAS;AAAA,cACTzO,OAAOS,MAAMT;AAAAA,YAAAA;AAAAA,UACf;AAAA,QACF;AAAA,QAEFohC,QAAQ;AAAA,UACNjhC,QAAQ;AAAA,UACRV,SAASS,OAAAA,OAAO;AAAA,YAACmiB,YAAYA,CAAC;AAAA,cAAC5hB;AAAAA,YAAAA,MAAWA,MAAM4gC;AAAAA,UAAAA,CAAO;AAAA,QAAA;AAAA,MACzD;AAAA,MAGF/gC,MAAM;AAAA,IAAA;AAAA,IAGRN,OAAO;AAAA,MACLoD,MAAM;AAAA,MACN9C,MAAM;AAAA,IAAA;AAAA,IAGRghC,wBAAwB;AAAA,MACtBV,QAAQ;AAAA,QACNtjB,KAAK;AAAA,QACLsgB,OAAOA,CAAC;AAAA,UAAC99B;AAAAA,QAAAA,OAAc;AAAA,UAACuiB,YAAYviB,QAAQuiB;AAAAA,QAAAA;AAAAA,QAC5Cye,SAAS;AAAA,UACP3gC,QAAQ;AAAA,UACRV,SAAS;AAAA,YACP2D,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,OAAY;AAAA,cACpBgO,SAAS;AAAA,cACTzO,OAAOS,MAAMT;AAAAA,YAAAA;AAAAA,UACf;AAAA,QACF;AAAA,QAEFohC,QAAQ;AAAA,UACNjhC,QAAQ;AAAA,UACRV,SAASS,OAAAA,OAAO;AAAA,YAACwc,cAAcA,CAAC;AAAA,cAACjc;AAAAA,YAAAA,MAAWA,MAAM4gC;AAAAA,UAAAA,CAAO;AAAA,QAAA;AAAA,MAC3D;AAAA,MAEF/gC,MAAM,CAAC,MAAM;AAAA,IAAA;AAAA,IAGfihC,oCAAoC;AAAA,MAClC1hC,IAAI;AAAA,MACJ+gC,QAAQ;AAAA,QACNtjB,KAAK;AAAA,QACLsgB,OAAOA,CAAC;AAAA,UAAC99B;AAAAA,QAAAA,OAAc;AAAA,UACrBuiB,YAAYviB,QAAQuiB;AAAAA,UACpB3F,cAAc5c,QAAQ4c;AAAAA,UACtB2hB,oBAAoBv+B,QAAQu+B;AAAAA,QAAAA;AAAAA,QAE9ByC,SAAS;AAAA,UACP3gC,QAAQ;AAAA,UACRV,SAAS;AAAA,YACP2D,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,OAAY;AAAA,cACpBgO,SAAS;AAAA,cACTzO,OAAOS,MAAMT;AAAAA,YAAAA;AAAAA,UACf;AAAA,QACF;AAAA,QAEFohC,QAAQ;AAAA,UACNjhC,QAAQ;AAAA,UACRV,SAASS,OAAAA,OAAO;AAAA,YAACmiB,YAAYA,CAAC;AAAA,cAAC5hB;AAAAA,YAAAA,MAAWA,MAAM4gC;AAAAA,UAAAA,CAAO;AAAA,QAAA;AAAA,MACzD;AAAA,MAEF/gC,MAAM,CAAC,MAAM;AAAA,IAAA;AAAA,IAGfkhC,sBAAsB;AAAA,MACpBxiC,IAAI;AAAA,QACF,4BAA4B;AAAA,UAC1BkiC,OAAO;AAAA,UACPzhC,SAAS;AAAA,YACP2D,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,OAAY;AAAA,cAAC49B,oBAAoB59B,MAAM49B;AAAAA,YAAAA;AAAAA,UAAkB;AAAA,UAErEl+B,QAAQ;AAAA,UACRshC,SAAS;AAAA,QAAA;AAAA,MACX;AAAA,MAEFb,QAAQ;AAAA,QACNtjB,KAAK;AAAA,QACLsgB,OAAOA,CAAC;AAAA,UAAC99B;AAAAA,QAAAA,OAAc;AAAA,UAACgf,cAAchf,QAAQuiB,WAAY1C;AAAAA,QAAAA;AAAAA,QAC1DmhB,SAAS;AAAA,UACP3gC,QAAQ;AAAA,UACRV,SAAS;AAAA,YACP2D,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,OAAY;AAAA,cACpBgO,SAAS;AAAA,cACTzO,OAAOS,MAAMT;AAAAA,YAAAA;AAAAA,UACf;AAAA,QACF;AAAA,QAEFohC,QAAQ,CACN;AAAA,UACEF,OAAO;AAAA,YACL99B,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,MAAWA,MAAM4gC;AAAAA,UAAAA;AAAAA,UAE7B5hC,SAASS,OAAAA,OAAO;AAAA,YACdw8B,aAAaA,CAAC;AAAA,cAACj8B;AAAAA,YAAAA,MAAWA,MAAM4gC;AAAAA,UAAAA,CACjC;AAAA,UACDlhC,QAAQ;AAAA,QAAA,GAEV;AAAA,UACE+gC,OAAO;AAAA,YACL99B,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,MAAWA,MAAM4gC;AAAAA,UAAAA;AAAAA,UAE7B5hC,SAASS,OAAAA,OAAO;AAAA,YACdw8B,aAAaA,CAAC;AAAA,cAACj8B;AAAAA,YAAAA,MAAWA,MAAM4gC;AAAAA,UAAAA,CACjC;AAAA,UACDlhC,QAAQ;AAAA,QAAA,GAEV;AAAA,UACE+gC,OAAO;AAAA,YACL99B,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,MAAWA,MAAM4gC;AAAAA,UAAAA;AAAAA,UAE7B5hC,SAAS,CACPS,OAAAA,OAAO;AAAA,YACLwf,YAAYA,CAAC;AAAA,cAAC5f;AAAAA,YAAAA,MAAaA,QAAQuiB;AAAAA,UAAAA,CACpC,GACD,iCAAiC;AAAA,UAEnCliB,QAAQ;AAAA,QAAA,GAEV;AAAA,UACEV,SAASS,OAAAA,OAAO;AAAA,YACdwf,YAAYA,CAAC;AAAA,cAAC5f;AAAAA,YAAAA,MAAaA,QAAQuiB;AAAAA,UAAAA,CACpC;AAAA,UACDliB,QAAQ;AAAA,QAAA,CACT;AAAA,MAAA;AAAA,MAGLG,MAAM,CAAC,MAAM;AAAA,IAAA;AAAA,IAGfohC,SAAS;AAAA,MACP1iC,IAAI;AAAA,QACF,4BAA4B;AAAA,UAC1BkiC,OAAO;AAAA,UACPzhC,SAAS;AAAA,YACP2D,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,OAAY;AAAA,cAAC49B,oBAAoB59B,MAAM49B;AAAAA,YAAAA;AAAAA,UAAkB;AAAA,UAErEl+B,QAAQ;AAAA,UACRshC,SAAS;AAAA,QAAA;AAAA,MACX;AAAA,IACF;AAAA,IAGF/E,aAAa;AAAA,MACX19B,IAAI;AAAA,QACF,4BAA4B;AAAA,UAC1BkiC,OAAO;AAAA,UACPzhC,SAAS;AAAA,YACP2D,MAAM;AAAA,YACN0N,QAAQA,CAAC;AAAA,cAACrQ;AAAAA,YAAAA,OAAY;AAAA,cAAC49B,oBAAoB59B,MAAM49B;AAAAA,YAAAA;AAAAA,UAAkB;AAAA,UAErEl+B,QAAQ;AAAA,UACRshC,SAAS;AAAA,QAAA;AAAA,MACX;AAAA,MAGFrhC,QAAQ;AAAA,QACNo9B,qBAAqB;AAAA,UACnBoD,QAAQ;AAAA,YACNtjB,KAAK;AAAA,YACLwjB,SAAS;AAAA,cACP3gC,QAAQ;AAAA,cACRV,SAAS;AAAA,gBACP2D,MAAM;AAAA,gBACN0N,QAAQA,CAAC;AAAA,kBAACrQ;AAAAA,gBAAAA,OAAY;AAAA,kBACpBgO,SAAS;AAAA,kBACTzO,OAAOS,MAAMT;AAAAA,gBAAAA;AAAAA,cACf;AAAA,YACF;AAAA,YAEFohC,QAAQ;AAAA,cACNjhC,QAAQ;AAAA,cACRV,SAASS,OAAAA,OAAO;AAAA,gBAAC+jB,kBAAkBA,CAAC;AAAA,kBAACxjB;AAAAA,gBAAAA,MAAWA,MAAM4gC;AAAAA,cAAAA,CAAO;AAAA,YAAA;AAAA,UAC/D;AAAA,UAEF/gC,MAAM,CAAC,MAAM;AAAA,QAAA;AAAA,QAEfqhC,iBAAiB;AAAA,UACff,QAAQ;AAAA,YACNtjB,KAAK;AAAA,YACLwjB,SAAS;AAAA,cACP3gC,QAAQ;AAAA,cACRV,SAAS;AAAA,gBACP2D,MAAM;AAAA,gBACN0N,QAAQA,CAAC;AAAA,kBAACrQ;AAAAA,gBAAAA,OAAY;AAAA,kBACpBgO,SAAS;AAAA,kBACTzO,OAAOS,MAAMT;AAAAA,gBAAAA;AAAAA,cACf;AAAA,YACF;AAAA,YAEFohC,QAAQ;AAAA,cACNjhC,QAAQ;AAAA,cACRV,SAASS,OAAAA,OAAO;AAAA,gBACd+jB,kBAAkBA,CAAC;AAAA,kBAACxjB;AAAAA,gBAAAA,OAAY;AAAA,kBAC9B2iB,QAAQ3iB,MAAM4gC;AAAAA,kBACdb,WAAW,IAAIE,KAAKA,KAAKD,IAAAA,IAAQ,MAAO,KAAK,KAAK,KAAK,EAAE;AAAA,gBAAA;AAAA,cAC3D,CACD;AAAA,YAAA;AAAA,UACH;AAAA,UAEFngC,MAAM,CAAC,MAAM;AAAA,QAAA;AAAA,QAEfshC,mBAAmB;AAAA,UACjBhB,QAAQ;AAAA,YACNtjB,KAAK;AAAA,YACLsgB,OAAOA,CAAC;AAAA,cAAC99B;AAAAA,YAAAA,OAAc;AAAA,cACrBuiB,YAAYviB,QAAQuiB;AAAAA,cACpBqc,qBAAqB5+B,QAAQ48B;AAAAA,cAC7BzY,kBAAkBnkB,QAAQmkB,iBAAkBb;AAAAA,YAAAA;AAAAA,YAE9C0d,SAAS;AAAA,cACP3gC,QAAQ;AAAA,cACRV,SAAS;AAAA,gBACP2D,MAAM;AAAA,gBACN0N,QAAQA,CAAC;AAAA,kBAACrQ;AAAAA,gBAAAA,OAAY;AAAA,kBACpBgO,SAAS;AAAA,kBACTzO,OAAOS,MAAMT;AAAAA,gBAAAA;AAAAA,cACf;AAAA,YACF;AAAA,YAEFohC,QAAQ;AAAA,cACNjhC,QAAQ;AAAA,cACRV,SAASS,OAAAA,OAAO;AAAA,gBAACwf,YAAYA,CAAC;AAAA,kBAACjf;AAAAA,gBAAAA,MAAWA,MAAM4gC;AAAAA,cAAAA,CAAO;AAAA,YAAA;AAAA,UACzD;AAAA,UAEF/gC,MAAM,CAAC,MAAM;AAAA,QAAA;AAAA,QAEfN,OAAO;AAAA,UACLoD,MAAM;AAAA,UACN9C,MAAM,CAAC,OAAO;AAAA,QAAA;AAAA,QAEhBohC,SAAS;AAAA,UACPG,OAAO;AAAA,YACLtB,eAAe;AAAA,cACbW,OAAO;AAAA,cACPzhC,SAASS,OAAAA,OAAO;AAAA,gBAAC+jB,kBAAkB;AAAA,cAAA,CAAK;AAAA,cACxC9jB,QAAQ;AAAA,cACRshC,SAAS;AAAA,YAAA;AAAA,UACX;AAAA,QACF;AAAA,MACF;AAAA,MAEF3gC,SAAS;AAAA,IAAA;AAAA,EACX;AAAA,EAGFA,SAAS;AACX,CAAC;ACniBM,SAAAghC,sBAAA3D,kBAAAR,aAAA;AAAA,QAAAh/B,IAAAC,qBAAAA,EAAA,EAAA,GAILmjC,cAAoBC,OAAAA,eAAAA;AAAgB,MAAAljC;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KACXpC,KAAA;AAAA,IAAA2jB,YAAaC,aAAAA;AAAAA,EAAAA,GAAY/jB,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAlD,QAAAgkB,UAAeC,OAAAA,UAAU9jB,EAAyB,GAElDw+B,gBADoBxa,OAAAA,eAAAA,GACajjB,IAEjCq+B,iBADkB/d,OAAAA,sBACcC,iBAA2BF,YAApC,KACvB+hB,WAAejwB,iBAAAA;AAAW,MAAAjT;AAAAJ,IAAA,CAAA,MAAAsjC,SAAA3gC,MAAAgP,iBAECvR,KADA,IAAIo7B,gBAAgB8H,SAAM3gC,MAAMgP,aAAc,EAC5BxL,IAAK,SAAS,GAACnG,EAAA,CAAA,IAAAsjC,SAAA3gC,MAAAgP,eAAA3R,OAAAI,MAAAA,KAAAJ,EAAA,CAAA;AAA5D,QAAA0/B,qBAA2Bt/B,IAC3B;AAAA,IAAAujB,MAAAC;AAAAA,EAAAA,IAA0BC,GAAAA,YAC1B;AAAA,IAAA3T;AAAAA,EAAAA,IAAYC,OAAAA,eAAeC,aAAAA,2BAA2B;AAAC,MAAA1N;AAAA1C,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAIRG,KAAA;AAAA,IAAAq0B,gBAAiB9yB;AAAAA,EAAAA,GAAUjE,OAAA0C,MAAAA,KAAA1C,EAAA,CAAA;AAA1E,QAAAkgB,cAAoBuY,2BAA2B/1B,EAA2B;AAAC,MAAAG;AAAA,MAAA7C,EAAA,CAAA,MAAAg/B,eAAAh/B,EAAA,CAAA,MAAAgkB,WAAAhkB,SAAA2+B,iBAAA3+B,EAAA,CAAA,MAAAojC,eAAApjC,EAAA,CAAA,MAAAkgB,eAAAlgB,EAAA,CAAA,MAAAw/B,oBAAAx/B,EAAA,EAAA,MAAA4jB,aAAA5jB,EAAA,EAAA,MAAAu/B,kBAAAv/B,UAAAkQ,GAAA;AAAA,QAAAhN;AAAAlD,MAAA,EAAA,MAAA4jB,aAAA5jB,UAAAkQ,KAKlChN,MAAAA,MACjC0gB,UAAU;AAAA,MAAA1iB,IACJ;AAAA,MAAmC4jB,UAC7B;AAAA,MAAIC,QACN;AAAA,MAAO8K,UACLC;AAAAA,MAAQ7Y,OACX/G,EAAE,mCAAmC;AAAA,IAAA,CAC7C,GAAClQ,QAAA4jB,WAAA5jB,QAAAkQ,GAAAlQ,QAAAkD,OAAAA,MAAAlD,EAAA,EAAA;AAAA,QAAAqD;AAAArD,cAAAojC,eAyB+B//B,MAAAC,CAAAA,QAAA;AAAC,YAAA;AAAA,QAAA27B;AAAAA,MAAAA,IAAA37B;AAAO,aACzC8/B,YAAWG,wBAAyBtE,MAAKiD,qBAAsBjD,MAAKnoB,QAAS;AAAA,IAAC,GAAA9W,QAAAojC,aAAApjC,QAAAqD,OAAAA,MAAArD,EAAA,EAAA,GAnCpF6C,KAAA29B,kBAAiB9P,QAAS;AAAA,MAAA5vB,SACf;AAAA,QAAA,mCAC4BoC;AAAAA,MAAAA;AAAAA,MAQpCnC,QACO;AAAA,QAAA,yBACmB29B,+BAA+B;AAAA,UAAA1a,QAAAA;AAAAA,UAAA2a;AAAAA,QAAAA,CAAuB;AAAA,QAAC,8BAClDG,4BAA4B;AAAA,UAAA9a,QAAAA;AAAAA,QAAAA,CAAQ;AAAA,QAAC,0BACzC+a,gCAAgC;AAAA,UAAA/a,QAAAA;AAAAA,UAAAgb;AAAAA,QAAAA,CAGzD;AAAA,QAAC,uBACqBM,6BAA6B;AAAA,UAAAtb,QAAAA;AAAAA,UAAAub;AAAAA,UAAAC;AAAAA,UAAAtf;AAAAA,QAAAA,CAKnD;AAAA,QAAC,wBACsByf,8BAA8B;AAAA,UAAA3b,QAAAA;AAAAA,UAAAwb;AAAAA,QAAAA,CAGrD;AAAA,QAAC,4BAC0BM,iCAAiC;AAAA,UAAA9b,QAAAA;AAAAA,UAAAub;AAAAA,UAAAC;AAAAA,UAAAtf;AAAAA,QAAAA,CAK5D;AAAA,QAAC,oBACkBygB,OAAAA,eAAet9B,GAEnC;AAAA,MAAA;AAAA,IACF,CACD,GAACrD,OAAAg/B,aAAAh/B,OAAAgkB,SAAAhkB,OAAA2+B,eAAA3+B,OAAAojC,aAAApjC,OAAAkgB,aAAAlgB,OAAAw/B,kBAAAx/B,QAAA4jB,WAAA5jB,QAAAu/B,gBAAAv/B,QAAAkQ,GAAAlQ,QAAA6C;AAAAA,EAAA;AAAAA,SAAA7C,EAAA,EAAA;AAAA,MAAAkD;AAAAlD,YAAA0/B,sBACFx8B,KAAA;AAAA,IAAA+7B,OAAQ;AAAA,MAAAS;AAAAA,IAAAA;AAAAA,EAAmB,GAAE1/B,QAAA0/B,oBAAA1/B,QAAAkD,MAAAA,KAAAlD,EAAA,EAAA;AAxC/B,QAAAwjC,WAAiBhJ,MAAAA,YACf33B,IAuCAK,EACF;AAAC,MAAAG,IAAAC;AAAAtD,IAAA,EAAA,MAAAwjC,YAAAxjC,UAAA0/B,sBAKSr8B,KAAAA,MAAA;AACRmgC,aAAQxa,KAAM;AAAA,MAAAvkB,MAAO;AAAA,MAA0Bi7B;AAAAA,IAAAA,CAAqB;AAAA,EAAC,GACpEp8B,KAAA,CAACkgC,UAAU9D,kBAAkB,GAAC1/B,QAAAwjC,UAAAxjC,QAAA0/B,oBAAA1/B,QAAAqD,IAAArD,QAAAsD,OAAAD,KAAArD,EAAA,EAAA,GAAAsD,KAAAtD,EAAA,EAAA,IAFjCO,MAAAA,UAAU8C,IAEPC,EAA8B;AAEjC,QAAAjC,QAAcwc,MAAAA,YAAY2lB,UAAUljC,OAEpC;AAGA,MAAIe;AAAO,UAAMA;AAAK,SAEfmiC;AAAQ;AA7EV,SAAAljC,QAAAqC,OAAA;AAAA,SAuEHA,MAAKoiB,WAAY,UAAUpiB,MAAKtB,QAASsB,MAAK+pB,OAAQ,OAAoC,IAAzB/pB,MAAKxB,QAAQE,QAArC;AAAkD;ACjFxF,SAAAoiC,mCAAA9lB,eAAA;AAAA,QAAA3d,IAAAC,uBAAA,CAAA,GACL;AAAA,IAAAiQ;AAAAA,EAAAA,IAAYC,OAAAA,eAAeC,aAAAA,2BAA2B,GACtD;AAAA,IAAAuT,MAAAC;AAAAA,EAAAA,IAA0BC,GAAAA,SAAAA,GAC1Byf,WAAejwB,iBAAAA;AAAW,MAAAlT;AAAAH,IAAA,CAAA,MAAAsjC,SAAA3gC,MAAAgP,iBAECxR,KADA,IAAIq7B,gBAAgB8H,SAAM3gC,MAAMgP,aAAc,EAC5BxL,IAAK,SAAS,GAACnG,EAAA,CAAA,IAAAsjC,SAAA3gC,MAAAgP,eAAA3R,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAA5D,QAAA0/B,qBAA2Bv/B,IAE3B4d,eAAqBF,kBAAYF,eAAerd,OAAqC,GACrFojC,gBAAsB7lB,kBAAYF,eAAevX,QAA2C;AAAC,MAAAhG,IAAAsC;AAAA1C,IAAA,CAAA,MAAA+d,gBAAA/d,EAAA,CAAA,MAAA0jC,iBAAA1jC,EAAA,CAAA,MAAA0/B,sBAAA1/B,EAAA,CAAA,MAAA4jB,aAAA5jB,SAAAkQ,KACnF9P,KAAAA,MAAA;AACR,QAAI,CAACwG,MAAKC,QAASkX,YAAY,KAA3B,CAAiC2hB,sBAAjC,CAAwDgE;AAAa;AACzE,UAAAC,aAAmB,IAAIvjB,IAAIsf,oBAAoBgE,aAAa,EAAC1iB;AACxDjD,iBAAYjX,KAAMmb,CAAAA,YAAaA,QAAOC,KAAMyhB,UAAU,CAAC,KAC1D/f,UAAU;AAAA,MAAAkB,UACE;AAAA,MAAI5jB,IACV,uCAAuCyiC,UAAU;AAAA,MAAE5e,QAC/C;AAAA,MAAO8K,UACLC;AAAAA,MAAQ7Y,OACX/G,EAAE,gDAAgD;AAAA,MAACxO,aAExD6B,2BAAAA,IAAC0W,kBAAA,EACI/J,GACK,SAAA,wDACI,YAAA;AAAA,QAAAuG,MAAO;AAAA,MAAA,GACX,QAAA;AAAA,QAAAipB;AAAAA,QAAAkE,eAESD;AAAAA,MAAAA,EACjB,CAAC;AAAA,IAAA,CAGN;AAAA,EACF,GACAjhC,KAAA,CAACqb,cAAc2lB,eAAehE,oBAAoB9b,WAAW1T,CAAC,GAAClQ,OAAA+d,cAAA/d,OAAA0jC,eAAA1jC,OAAA0/B,oBAAA1/B,OAAA4jB,WAAA5jB,OAAAkQ,GAAAlQ,OAAAI,IAAAJ,OAAA0C,OAAAtC,KAAAJ,EAAA,CAAA,GAAA0C,KAAA1C,EAAA,CAAA,IAvBlEO,MAAAA,UAAUH,IAuBPsC,EAA+D;AAAC;AAhC9D,SAAA0D,SAAAimB,SAAA;AAAA,SAQuD1pB,QAAKxB,QAAQ4f,YAAmBC;AAAA;AARvF,SAAA1gB,QAAAqC,OAAA;AAAA,SAOsDA,MAAKxB,QAAQ4c;AAAa;ACRhF,SAAA8lB,wBAAA;AAAA,QAAA7jC,IAAAC,qBAAAA,EAAA,CAAA;AAAA,MAAAE;AAAAH,IAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAIoBpC,KAAA;AAAA,IAAA2jB,YAAaC,aAAAA;AAAAA,EAAAA,GAAY/jB,OAAAG,MAAAA,KAAAH,EAAA,CAAA;AAAlD,QAAAgkB,UAAeC,OAAAA,UAAU9jB,EAAyB,GAClD,CAAA2jC,kCAAAC,KAAA,IAAkDC,MAAAA,WAChD1jC,SACA,SACF,GACA,CAAA2jC,8BAAAC,+BAAA,IAAwEl5B,MAAAA,SACtE,IACF;AAAC,MAAA5K,IAAAsC;AAAA1C,WAAAgkB,WAES5jB,KAAAA,MAAA;AACR,UAAA+Y,cAAoBgrB,6BAAAA,kCAAkCngB,SAAQS,CAAAA,WAAA;AAC5Dyf,sCAAgCzf,MAAM,GACtCsf,MAAAA;AAAAA,IAAO,CACR;AAAC,WACK,MAAM5qB,YAAAA;AAAAA,EAAa,GACzBzW,KAAA,CAACshB,OAAM,GAAChkB,OAAAgkB,SAAAhkB,OAAAI,IAAAJ,OAAA0C,OAAAtC,KAAAJ,EAAA,CAAA,GAAA0C,KAAA1C,EAAA,CAAA,IANXO,gBAAUH,IAMPsC,EAAQ;AAAC,MAAAG;AAAA,SAAA7C,EAAA,CAAA,MAAA8jC,oCAAA9jC,SAAAikC,gCAELphC,KAAA,CAACohC,8BAA8BH,gCAAgC,GAAC9jC,OAAA8jC,kCAAA9jC,OAAAikC,8BAAAjkC,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA,GAAhE6C;AAAgE;AArBlE,SAAAvC,UAAA;AAAA,SAMG;AAAO;ACJjB,SAAe8jC,4BAAAjkC,IAAA;AAAA,QAAAH,IAAAC,uBAAA,CAAA,GAAqC;AAAA,IAAA85B;AAAAA,EAAAA,IAAA55B,IAKlDwd,gBAAsBwlB,sBAAsBpJ,KAAIvlB,SAAoBuM,YAAEgZ,KAAIvlB,SAAsBuJ,YAAA;AAChG0lB,qCAAmC9lB,aAAa;AAEhD,QAAAsjB,uCAA6CpjB,MAAAA,YAC3CF,eACArd,KACF,GACA6gC,uCAA6CtjB,kBAC3CF,eACAvX,MACF,GACA86B,qCAA2CrjB,MAAAA,YACzCF,eACArX,MACF,GACA86B,6BAAmCvjB,MAAAA,YACjCF,eACAtI,MACF,GACAjU,MAAYyc,MAAAA,YAAYF,eAAepI,MAAmC,GAE1E,CAAAuX,wBAAAgX,gCAAA,IAAmED,sBAAAA;AAEnE,MACE,CAACziC,OACD0iC,qCAAqC,aADrC,CAEC7C,wCACD,OAAOA,qCAAoCM,UAAa,OAHxD,CAICJ,wCACD,OAAOA,qCAAoCI,UAAa,OALxD,CAMCH,8BAND,CAOCF,sCACD,OAAOA,mCAAkCK,UAAa,OACtD,OAAOH,2BAA0BG,UAAa,KAAW;AAAA,QAAAnhC;AAAA,WAAAJ,EAAA,CAAA,MAAAsC,OAAAC,IAAA,2BAAA,KAElDnC,MAAAmD,+BAAC6U,aAAAA,qBAAA,CAAA,CAAmB,GAAGpY,OAAAI,OAAAA,MAAAJ,EAAA,CAAA,GAAvBI;AAAAA,EAAuB;AAS1B,QAAAA,KAAA6gC,sCAAoCM,YAAc,MAClDJ,sCAAoCI,YAAc,IAEzB7+B,KAAAw+B,oCAAkCK,YAAc;AAAI,MAAA1+B;AAAA,SAAA7C,SAAA2d,iBAAA3d,EAAA,CAAA,MAAAI,MAAAJ,EAAA,CAAA,MAAA0C,MAAA1C,EAAA,CAAA,MAAA+5B,QAAA/5B,SAAAoB,OAAApB,EAAA,CAAA,MAAA8sB,0BARjFjqB,KAAAU,2BAAAA,IAAC,kBAAA,EACOw2B,MACa34B,mBAAAA,KACK0rB,wBAEtB,6BAAA1sB,IAGyB,2BAAAsC,IACZib,cAAAA,CAAa,GAC5B3d,OAAA2d,eAAA3d,OAAAI,IAAAJ,OAAA0C,IAAA1C,OAAA+5B,MAAA/5B,OAAAoB,KAAApB,OAAA8sB,wBAAA9sB,OAAA6C,MAAAA,KAAA7C,EAAA,CAAA,GAVF6C;AAUE;AAtDS,SAAA0S,OAAAiX,SAAA;AAAA,SAwBqC7pB,QAAKxB,QAAQ4f;AAAW;AAxB7D,SAAA1L,OAAAkX,SAAA;AAAA,SAsBA5pB,QAAKxB,QAAQigC;AAA2B;AAtBxC,SAAA96B,OAAAgmB,SAAA;AAAA,SAkBA3pB,QAAKxB,QAAQ+/B;AAAmC;AAlBhD,SAAA96B,OAAAimB,SAAA;AAAA,SAcA1pB,QAAKxB,QAAQggC;AAAqC;AAdlD,SAAA7gC,MAAAqC,OAAA;AAAA,SAUAA,MAAKxB,QAAQ8/B;AAAqC;;"}