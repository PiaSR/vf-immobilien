---
import { Image } from "astro:assets";
import logo from "/public/logos/Viki-new-logo-only-green-1.svg";
import MobileNavToggle from "../Utils/MobileNavToggle";

const navItems = [
  { name: "Home", href: "/" },
  { name: "Ãœber uns", href: "/about" },
  { name: "Leistungen", href: "/services" },
  { name: "FAQs", href: "/faqs" },
  { name: "Immobiliensuche", href: "/properties/propertySearch" },
];

const pathname = new URL(Astro.request.url).pathname;
---

<header id="cs-navigation">
  <div class="cs-container site-container">
    <a href="/" class="cs-logo" aria-label="back to home">
      <Image
        src={logo}
        alt="logo"
        width="90"
        height="75"
        aria-hidden="true"
        decoding="async"
        loading="eager"
      />
    </a>
    <nav class="cs-nav" role="navigation">
      <MobileNavToggle client:idle />
      <div class="cs-ul-wrapper">
        <ul id="cs-expanded" class="cs-ul">
          {
            navItems.map((item) => (
              <li class="cs-li">
                <a
                  href={item.href}
                  class={
                    pathname === item.href
                      ? "cs-li-link cs-active"
                      : "cs-li-link"
                  }
                >
                  {item.name}
                </a>
              </li>
            ))
          }
          <li class="cs-li">
            <a class="button button-orange button-nav" href="/contact"
              >Kontakt</a
            >
          </li>
        </ul>
      </div>
    </nav>
  </div>

  <style>
    /* ------------------ MOBILE - 1023px  ------------------ */
    @media only screen and (max-width: 63.9375rem) {
      #cs-navigation {
        width: 100%;
        padding: var(--spacing-sm) var(--spacing-md);
        box-sizing: border-box;
        background-color: var(--color-neutral-lightest);
        box-shadow: rgba(var(--color-neutral-medium-grey), 0.2) 0px 8px 24px;
        position: fixed;
        z-index: 10000;
      }
      #cs-navigation.cs-active .cs-ul-wrapper {
        opacity: 1;
        transform: scaleY(1);
      }
      #cs-navigation.cs-active .cs-li {
        transform: translateY(0);
        opacity: 1;
      }
      #cs-navigation .cs-container {
        width: 100%;
        display: flex;
        justify-content: flex-end;
        align-items: center;
      }
      #cs-navigation .cs-logo {
        width: 40%;
        max-width: 9.125rem;
        height: 4.0625rem;
        margin: 0 auto 0 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10;
      }
      #cs-navigation .cs-logo Image {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      #cs-navigation .cs-ul-wrapper {
        width: 100%;
        height: 100vh;
        padding-bottom: 1.4em;
        opacity: 0;
        background-color: var(--color-neutral-lightest);
        box-shadow: inset rgba(var(--color-neutral-black), 0.2) 0px 8px 24px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        position: absolute;
        top: 100%;
        left: 0;
        z-index: -1;
        transform: scaleY(0);
        transform-origin: top;
        transition:
          transform 0.4s,
          opacity 0.3s;
      }

      #cs-navigation .cs-ul {
        margin: 0;
        padding: var(--spacing-xl) 0 0 0;
        width: 100%;
        height: 100%;
        max-height: 80vh;
        overflow: scroll;
        display: flex;
        justify-content: flex-start;
        flex-direction: column;
        flex-grow: 1;
        align-items: stretch;
        gap: var(--spacing-md);
      }
      #cs-navigation .cs-li {
        padding: 0 var(--spacing-2xl);
        list-style: none;
        margin-right: 0;
        transform: translateY(-4.375rem);
        opacity: 0;
        transition:
          transform 0.6s,
          opacity 0.9s;
      }
      #cs-navigation .cs-li:last-of-type {
        margin-top: auto;
        margin-bottom: var(--spacing-xl);
        transform: none;
        opacity: 1;
      }
      #cs-navigation .cs-li:nth-of-type(1) {
        transition-delay: 0.05s;
      }
      #cs-navigation .cs-li:nth-of-type(2) {
        transition-delay: 0.1s;
      }
      #cs-navigation .cs-li:nth-of-type(3) {
        transition-delay: 0.15s;
      }
      #cs-navigation .cs-li:nth-of-type(4) {
        transition-delay: 0.2s;
      }
      #cs-navigation .cs-li:nth-of-type(5) {
        transition-delay: 0.25s;
      }
      #cs-navigation .cs-li:nth-of-type(6) {
        transition-delay: 0.3s;
      }
      #cs-navigation .cs-li:nth-of-type(7) {
        transition-delay: 0.35s;
      }
      #cs-navigation .cs-li:nth-of-type(8) {
        transition-delay: 0.4s;
      }
      #cs-navigation .cs-li:nth-of-type(9) {
        transition-delay: 0.45s;
      }
      #cs-navigation .cs-li-link {
        font-size: clamp(1.25rem, 5vw, 1.75rem);
        line-height: 1.5em;
        text-decoration: none;
        margin: 0;
        color: var(--color-neutral-medium-grey);
        display: block;
        width: 100%;
        position: relative;
        padding: 1rem 0; /* Add padding for a larger tap target */
      }
      #cs-navigation .cs-li-link:before {
        display: none;
      }
      #cs-navigation .cs-li-link.cs-active {
        color: var(--color-brand-medium-green) !important;
        font-weight: var(--font-weight-bold) !important;
      }
      #cs-navigation .cs-li .button-nav {
        font-size: clamp(1.25rem, 5vw, 1.75rem);
        display: block;
        width: 100%;
        padding: var(--spacing-sm) var(--spacing-lg);
        border-radius: var(--border-radius);
      }
    }

    /*  ------------------------------- Small Desktop - 1024px  -------------------------------*/

    @media only screen and (min-width: 64rem) {
      #cs-navigation {
        width: 100%;
        padding: 0 var(--spacing-md);
        box-sizing: border-box;
        background-color: var(--color-neutral-lightest);
        box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.1);
        position: fixed;
        z-index: 10000;
      }
      #cs-navigation .cs-container {
        width: 100%;
        max-width: 80rem;
        margin: auto;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        gap: 1.5rem;
      }
      #cs-navigation .cs-toggle {
        display: none;
      }
      #cs-navigation .cs-logo {
        width: 18.4%;
        max-width: 21.875rem;
        height: 4.0625rem;
        margin: 0 auto 0 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 100;
      }
      #cs-navigation .cs-logo img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      #cs-navigation .cs-ul-wrapper {
        /* Set the display and layout for desktop */
        display: flex;
        justify-content: flex-start;
        align-items: center;
        /* Remove any mobile-specific hidden styles */
        opacity: 1;
        transform: scaleY(1);
        height: auto;
        width: auto;
        position: static;
        background-color: transparent;
        box-shadow: none;
        padding: 0;
        overflow: visible;
      }
      #cs-navigation .cs-ul {
        /* Ensure the list itself is a flexbox container on desktop */
        display: flex;
        justify-content: flex-start;
        align-items: center;
        gap: clamp(1.25rem, 2.6vw, 2.25rem);
        /* Remove mobile-specific properties */
        flex-direction: row;
        padding: 0;
        max-height: none;
        overflow: visible;
      }
      #cs-navigation .cs-li {
        list-style: none;
        padding: var(--spacing-md) 0;
        flex: none;
      }
      #cs-navigation .cs-li-link {
        font-size: clamp(0.875rem, 1vw, 1rem);
        line-height: var(--line-height-body);
        text-decoration: none;
        margin: 0;
        color: var(--color-neutral-medium-grey);
        display: block;
        position: relative;
      }
      #cs-navigation .cs-li-link:hover {
        color: var(--color-brand-medium-green);
        font-weight: var(--font-weight-bold);
        text-decoration: none !important;
      }
      #cs-navigation .cs-li-link.cs-active {
        color: var(--color-brand-medium-green) !important;
        font-weight: var(--font-weight-bold) !important;
        text-decoration: none !important;
      }
      #cs-navigation .cs-li-link.cs-active:before {
        display: none !important;
      }

      #cs-navigation .button-nav {
        font-size: clamp(0.875rem, 1vw, 1rem);
        padding: var(--spacing-sm) var(--spacing-lg);
      }

      .button {
        display: flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        gap: var(--spacing-md);
        border: solid 1px transparent;
        border-radius: var(--border-radius);
        font-family: var(--font-primary);
        font-weight: var(--font-weight-regular);
        line-height: var(--line-height-body);
        font-size: var(--font-size-body-base);
        padding: var(--spacing-md) var(--spacing-xl);
        cursor: pointer;
        transition:
          background-color 0.3s ease,
          color 0.3s ease;
      }
      .button:not([class]) {
        border: solid 1px var(--color-neutral-font-dark);
        background-color: var(--color-neutral-lightest);
        color: var(--color-neutral-font-dark);
      }
    }
  </style>
</header>
